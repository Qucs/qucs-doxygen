<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Qucs-core: bjt.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Qucs-core
   &#160;<span id="projectnumber">0.0.19</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">bjt.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="bjt_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * bjt.cpp - bipolar junction transistor class implementation</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Copyright (C) 2004, 2005, 2006, 2008 Stefan Jahn &lt;stefan@lkcc.org&gt;</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00008"></a>00008 <span class="comment"> * the Free Software Foundation; either version 2, or (at your option)</span>
<a name="l00009"></a>00009 <span class="comment"> * any later version.</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> * This software is distributed in the hope that it will be useful,</span>
<a name="l00012"></a>00012 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00013"></a>00013 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00014"></a>00014 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * along with this package; see the file COPYING.  If not, write to</span>
<a name="l00018"></a>00018 <span class="comment"> * the Free Software Foundation, Inc., 51 Franklin Street - Fifth Floor,</span>
<a name="l00019"></a>00019 <span class="comment"> * Boston, MA 02110-1301, USA.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * $Id$</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> */</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="preprocessor">#if HAVE_CONFIG_H</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="config_8h.html">config.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#endif</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="component_8h.html">component.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="device_8h.html">device.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="bjt_8h.html">bjt.h</a>&quot;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="bjt_8cpp.html#a861013cc9c919d12047340c822154d73">00033</a> <span class="preprocessor">#define NEWSGP 0</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00035"></a><a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">00035</a> <span class="preprocessor">#define NODE_B 0 </span><span class="comment">/* base node       */</span>
<a name="l00036"></a><a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">00036</a> <span class="preprocessor">#define NODE_C 1 </span><span class="comment">/* collector node  */</span>
<a name="l00037"></a><a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">00037</a> <span class="preprocessor">#define NODE_E 2 </span><span class="comment">/* emitter node    */</span>
<a name="l00038"></a><a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">00038</a> <span class="preprocessor">#define NODE_S 3 </span><span class="comment">/* substrate node  */</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="keyword">using namespace </span><a class="code" href="structqucs.html">qucs</a>;
<a name="l00041"></a>00041 <span class="keyword">using namespace </span>qucs::device;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 bjt::bjt () : circuit (4) {
<a name="l00044"></a>00044   cbcx = rb = re = rc = NULL;
<a name="l00045"></a>00045   <a class="code" href="parse__vcd_8y.html#ae0bd5e8ec17b2aad3338041991eb1056">type</a> = CIR_BJT;
<a name="l00046"></a>00046 }
<a name="l00047"></a>00047 
<a name="l00048"></a><a class="code" href="structbjt.html#a93baf7418b0c553fcb0d225fe556e60f">00048</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a93baf7418b0c553fcb0d225fe556e60f">bjt::calcSP</a> (<a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> frequency) {
<a name="l00049"></a>00049   <span class="comment">// build admittance matrix and convert it to S-parameter matrix</span>
<a name="l00050"></a>00050   <a class="code" href="classqucs_1_1circuit.html#a931f6686144d48716e2af3a9db2719e8">setMatrixS</a> (<a class="code" href="namespacequcs.html#abb46aa8bad5c12097d1336fd30e046a5" title="Admittance matrix to scattering parameters.">ytos</a> (<a class="code" href="structbjt.html#a13271751f3f7cd3f4df9a1055a0586ea">calcMatrixY</a> (frequency)));
<a name="l00051"></a>00051 }
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="structbjt.html#a13271751f3f7cd3f4df9a1055a0586ea">00053</a> matrix <a class="code" href="structbjt.html#a13271751f3f7cd3f4df9a1055a0586ea">bjt::calcMatrixY</a> (<a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> frequency) {
<a name="l00054"></a>00054 
<a name="l00055"></a>00055   <span class="comment">// fetch computed operating points</span>
<a name="l00056"></a>00056   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cbe  = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Cbe&quot;</span>);
<a name="l00057"></a>00057   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> gbe  = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;gpi&quot;</span>);
<a name="l00058"></a>00058   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cbci = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Cbci&quot;</span>);
<a name="l00059"></a>00059   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> gbc  = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;gmu&quot;</span>);
<a name="l00060"></a>00060   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ccs  = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Ccs&quot;</span>);
<a name="l00061"></a>00061 <span class="preprocessor">#if NEWSGP</span>
<a name="l00062"></a>00062 <span class="preprocessor"></span>  <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> gm   = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;gmf&quot;</span>);
<a name="l00063"></a>00063   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> gmr  = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;gmr&quot;</span>);
<a name="l00064"></a>00064 <span class="preprocessor">#else</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>  <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> gm   = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;gm&quot;</span>);
<a name="l00066"></a>00066   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> go   = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;go&quot;</span>);
<a name="l00067"></a>00067 <span class="preprocessor">#endif</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span>  <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ptf  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Ptf&quot;</span>);
<a name="l00069"></a>00069   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Tf   = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Tf&quot;</span>);
<a name="l00070"></a>00070 
<a name="l00071"></a>00071   <span class="comment">// compute admittance matrix entries</span>
<a name="l00072"></a>00072   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> Ybe = <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> (gbe, 2.0 * pi * frequency * Cbe);
<a name="l00073"></a>00073   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> Ybc = <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> (gbc, 2.0 * pi * frequency * Cbci);
<a name="l00074"></a>00074   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> Ycs = <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> (0.0, 2.0 * pi * frequency * Ccs);
<a name="l00075"></a>00075 
<a name="l00076"></a>00076   <span class="comment">// admittance matrix entries for &quot;transcapacitance&quot;</span>
<a name="l00077"></a>00077   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> Ybebc = <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> (0.0, 2.0 * pi * frequency * <a class="code" href="structbjt.html#ad01f9d8f393d184496db59bc7be1b0ba">dQbedUbc</a>);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   <span class="comment">// compute influence of excess phase</span>
<a name="l00080"></a>00080   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> phase = <a class="code" href="namespacequcs.html#aad60b983c1899f497c1564a1e5d03fd7" title="rad2deg Convert radian to degree">deg2rad</a> (Ptf) * Tf * 2 * pi * frequency;
<a name="l00081"></a>00081 <span class="preprocessor">#if NEWSGP</span>
<a name="l00082"></a>00082 <span class="preprocessor"></span>  <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> gmf = <a class="code" href="namespacequcs.html#a931156708192db109ce016277f217b60" title="Construct a complex number using polar notation.">qucs::polar</a> (gm, -phase);
<a name="l00083"></a>00083 <span class="preprocessor">#else</span>
<a name="l00084"></a>00084 <span class="preprocessor"></span>  <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> gmf = <a class="code" href="namespacequcs.html#a931156708192db109ce016277f217b60" title="Construct a complex number using polar notation.">qucs::polar</a> (gm + go, -phase) - go;
<a name="l00085"></a>00085 <span class="preprocessor">#endif</span>
<a name="l00086"></a>00086 <span class="preprocessor"></span>
<a name="l00087"></a>00087   <span class="comment">// build admittance matrix</span>
<a name="l00088"></a>00088   matrix <a class="code" href="parse__mdl_8y.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> (4);
<a name="l00089"></a>00089 <span class="preprocessor">#if NEWSGP</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>  <span class="comment">// for some reason this small signal equivalent can&#39;t be used</span>
<a name="l00091"></a>00091   y.set (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, Ybc + Ybe + Ybebc);
<a name="l00092"></a>00092   y.set (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, -Ybc - Ybebc);
<a name="l00093"></a>00093   y.set (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, -Ybe);
<a name="l00094"></a>00094   y.set (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00095"></a>00095   y.set (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, -Ybc + gmf + gmr);
<a name="l00096"></a>00096   y.set (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, Ybc - gmr + Ycs);
<a name="l00097"></a>00097   y.set (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, -gmf);
<a name="l00098"></a>00098   y.set (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, -Ycs);
<a name="l00099"></a>00099   y.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, -Ybe - gmf - gmr - Ybebc);
<a name="l00100"></a>00100   y.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, gmr + Ybebc);
<a name="l00101"></a>00101   y.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, Ybe + gmf);
<a name="l00102"></a>00102   y.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00103"></a>00103   y.set (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, 0);
<a name="l00104"></a>00104   y.set (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, -Ycs);
<a name="l00105"></a>00105   y.set (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, 0);
<a name="l00106"></a>00106   y.set (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, Ycs);
<a name="l00107"></a>00107 <span class="preprocessor">#else </span><span class="comment">/* !NEWSGP */</span>
<a name="l00108"></a>00108   y.set (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, Ybc + Ybe + Ybebc);
<a name="l00109"></a>00109   y.set (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, -Ybc - Ybebc);
<a name="l00110"></a>00110   y.set (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, -Ybe);
<a name="l00111"></a>00111   y.set (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00112"></a>00112   y.set (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, -Ybc + gmf);
<a name="l00113"></a>00113   y.set (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, Ybc + Ycs + go);
<a name="l00114"></a>00114   y.set (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, -gmf - go);
<a name="l00115"></a>00115   y.set (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, -Ycs);
<a name="l00116"></a>00116   y.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, -Ybe - gmf - Ybebc);
<a name="l00117"></a>00117   y.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, -go + Ybebc);
<a name="l00118"></a>00118   y.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, Ybe + gmf + go);
<a name="l00119"></a>00119   y.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00120"></a>00120   y.set (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, 0);
<a name="l00121"></a>00121   y.set (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, -Ycs);
<a name="l00122"></a>00122   y.set (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, 0);
<a name="l00123"></a>00123   y.set (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, Ycs);
<a name="l00124"></a>00124 <span class="preprocessor">#endif </span><span class="comment">/* !NEWSGP */</span>
<a name="l00125"></a>00125   <span class="keywordflow">return</span> <a class="code" href="parse__mdl_8y.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>;
<a name="l00126"></a>00126 }
<a name="l00127"></a>00127 
<a name="l00128"></a><a class="code" href="structbjt.html#acf66555db9c52a49618f87cd8578ead0">00128</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#acf66555db9c52a49618f87cd8578ead0">bjt::calcNoiseSP</a> (<a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> frequency) {
<a name="l00129"></a>00129   <a class="code" href="classqucs_1_1circuit.html#adf9d50ac28e53f1d2e75d16993354310">setMatrixN</a> (<a class="code" href="namespacequcs.html#ad37adcd761d5ad33d77fded0da99e09e" title="Admittance noise correlation matrix to S-parameter noise correlation matrix.">cytocs</a> (<a class="code" href="structbjt.html#aa1e7980fc227f36e74336d2dd94aa399">calcMatrixCy</a> (frequency) * <a class="code" href="classqucs_1_1circuit.html#ac8db854b6e88e3bcf0a959f327ccb831">z0</a>, <a class="code" href="classqucs_1_1circuit.html#a50cb15c93f5b15047f4e54f56cf9af89">getMatrixS</a> ()));
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00132"></a><a class="code" href="structbjt.html#aa1e7980fc227f36e74336d2dd94aa399">00132</a> matrix <a class="code" href="structbjt.html#aa1e7980fc227f36e74336d2dd94aa399">bjt::calcMatrixCy</a> (<a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> frequency) {
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <span class="comment">// fetch computed operating points</span>
<a name="l00135"></a>00135   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="structbjt.html#a9f819e33876d6de59e62ca75ac108692">Ibe</a> = fabs (<a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Ibe&quot;</span>));
<a name="l00136"></a>00136   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ice = fabs (<a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Ice&quot;</span>));
<a name="l00137"></a>00137 
<a name="l00138"></a>00138   <span class="comment">// get model properties</span>
<a name="l00139"></a>00139   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Kf  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Kf&quot;</span>);
<a name="l00140"></a>00140   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Af  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Af&quot;</span>);
<a name="l00141"></a>00141   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ffe = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Ffe&quot;</span>);
<a name="l00142"></a>00142   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Kb  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Kb&quot;</span>);
<a name="l00143"></a>00143   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ab  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Ab&quot;</span>);
<a name="l00144"></a>00144   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Fb  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Fb&quot;</span>);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> ib = 2 * Ibe * QoverkB / T0 +            <span class="comment">// shot noise</span>
<a name="l00147"></a>00147     (Kf * <a class="code" href="namespacequcs.html#a5c65d8443158735d370ba859da6fa43d" title="Compute power function with real exponent.">qucs::pow</a> (Ibe, Af) / <a class="code" href="namespacequcs.html#a5c65d8443158735d370ba859da6fa43d" title="Compute power function with real exponent.">qucs::pow</a> (frequency, Ffe) +       <span class="comment">// flicker noise</span>
<a name="l00148"></a>00148      Kb * <a class="code" href="namespacequcs.html#a5c65d8443158735d370ba859da6fa43d" title="Compute power function with real exponent.">qucs::pow</a> (Ibe, Ab) / (1 + <a class="code" href="namespacequcs.html#ae58b59f7f7e9fadd77ef9c7d30c2975f" title="Square of complex number.">sqr</a> (frequency / Fb)))  <span class="comment">// burst noise</span>
<a name="l00149"></a>00149     / kB / T0;
<a name="l00150"></a>00150   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> ic = 2 * Ice * QoverkB / T0;             <span class="comment">// shot noise</span>
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">/* build noise current correlation matrix and convert it to</span>
<a name="l00153"></a>00153 <span class="comment">     noise-wave correlation matrix */</span>
<a name="l00154"></a>00154   matrix cy = matrix (4);
<a name="l00155"></a>00155   cy.set (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, ib);
<a name="l00156"></a>00156   cy.set (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, -ib);
<a name="l00157"></a>00157   cy.set (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, ic);
<a name="l00158"></a>00158   cy.set (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, -ic);
<a name="l00159"></a>00159   cy.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, -ib);
<a name="l00160"></a>00160   cy.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, -ic);
<a name="l00161"></a>00161   cy.set (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, ic + ib);
<a name="l00162"></a>00162   <span class="keywordflow">return</span> cy;
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00165"></a><a class="code" href="structbjt.html#a27e1ce38d676dade15d7fb47b304dac7">00165</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a27e1ce38d676dade15d7fb47b304dac7">bjt::initModel</a> (<span class="keywordtype">void</span>) {
<a name="l00166"></a>00166   <span class="comment">// fetch necessary device properties</span>
<a name="l00167"></a>00167   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> T  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Temp&quot;</span>);
<a name="l00168"></a>00168   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Tn = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Tnom&quot;</span>);
<a name="l00169"></a>00169   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="eqndefined_8cpp.html#a70993d52766e31cb0157958a18aa499a">A</a>  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Area&quot;</span>);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171   <span class="comment">// compute Is temperature and area dependency</span>
<a name="l00172"></a>00172   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Is  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Is&quot;</span>);
<a name="l00173"></a>00173   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Xti = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Xti&quot;</span>);
<a name="l00174"></a>00174   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Eg  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Eg&quot;</span>);
<a name="l00175"></a>00175   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> T1, T2, IsT;
<a name="l00176"></a>00176   T2 = <a class="code" href="namespacequcs.html#a60eabd98195ced2fcfd8d15fd487642b" title="Convert Celsius to Kelvin.">celsius2kelvin</a> (T);
<a name="l00177"></a>00177   T1 = <a class="code" href="namespacequcs.html#a60eabd98195ced2fcfd8d15fd487642b" title="Convert Celsius to Kelvin.">celsius2kelvin</a> (Tn);
<a name="l00178"></a>00178   IsT = <a class="code" href="namespacequcs_1_1device.html#ad58df080f2bf826e6e35e76c76998bd3">pnCurrent_T</a> (T1, T2, Is, Eg, 1, Xti);
<a name="l00179"></a>00179   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Is&quot;</span>, IsT * A);
<a name="l00180"></a>00180 
<a name="l00181"></a>00181   <span class="comment">// compute Vje, Vjc and Vjs temperature dependencies</span>
<a name="l00182"></a>00182   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Vje = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Vje&quot;</span>);
<a name="l00183"></a>00183   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Vjc = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Vjc&quot;</span>);
<a name="l00184"></a>00184   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Vjs = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Vjs&quot;</span>);
<a name="l00185"></a>00185   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> VjeT, VjcT, VjsT;
<a name="l00186"></a>00186   VjeT = <a class="code" href="namespacequcs_1_1device.html#aabed0cbae198e1da8f8626c220b05488">pnPotential_T</a> (T1,T2, Vje);
<a name="l00187"></a>00187   VjcT = <a class="code" href="namespacequcs_1_1device.html#aabed0cbae198e1da8f8626c220b05488">pnPotential_T</a> (T1,T2, Vjc);
<a name="l00188"></a>00188   VjsT = <a class="code" href="namespacequcs_1_1device.html#aabed0cbae198e1da8f8626c220b05488">pnPotential_T</a> (T1,T2, Vjs);
<a name="l00189"></a>00189   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Vje&quot;</span>, VjeT);
<a name="l00190"></a>00190   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Vjc&quot;</span>, VjcT);
<a name="l00191"></a>00191   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Vjs&quot;</span>, VjsT);
<a name="l00192"></a>00192 
<a name="l00193"></a>00193   <span class="comment">// compute Bf and Br temperature dependencies</span>
<a name="l00194"></a>00194   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Bf  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Bf&quot;</span>);
<a name="l00195"></a>00195   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Br  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Br&quot;</span>);
<a name="l00196"></a>00196   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Xtb = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Xtb&quot;</span>);
<a name="l00197"></a>00197   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> F = <a class="code" href="namespacequcs.html#ab5bb59c9137b45fbab66bdbeac414b40" title="Compute complex exponential.">qucs::exp</a> (Xtb * <a class="code" href="namespacequcs.html#ad72d35f69fd807087269078dfeca1533" title="Compute principal value of natural logarithm of z.">qucs::log</a> (T2 / T1));
<a name="l00198"></a>00198   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Bf&quot;</span>, Bf * F);
<a name="l00199"></a>00199   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Br&quot;</span>, Br * F);
<a name="l00200"></a>00200 
<a name="l00201"></a>00201   <span class="comment">// compute Ise and Isc temperature and area dependencies</span>
<a name="l00202"></a>00202   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ise = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Ise&quot;</span>);
<a name="l00203"></a>00203   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Isc = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Isc&quot;</span>);
<a name="l00204"></a>00204   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ne  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Ne&quot;</span>);
<a name="l00205"></a>00205   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Nc  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Nc&quot;</span>);
<a name="l00206"></a>00206   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> G = <a class="code" href="namespacequcs.html#ad72d35f69fd807087269078dfeca1533" title="Compute principal value of natural logarithm of z.">qucs::log</a> (IsT / Is);
<a name="l00207"></a>00207   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> F1 = <a class="code" href="namespacequcs.html#ab5bb59c9137b45fbab66bdbeac414b40" title="Compute complex exponential.">qucs::exp</a> (G / Ne);
<a name="l00208"></a>00208   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> F2 = <a class="code" href="namespacequcs.html#ab5bb59c9137b45fbab66bdbeac414b40" title="Compute complex exponential.">qucs::exp</a> (G / Nc);
<a name="l00209"></a>00209   Ise = Ise / F * F1;
<a name="l00210"></a>00210   Isc = Isc / F * F2;
<a name="l00211"></a>00211   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Ise&quot;</span>, Ise * A);
<a name="l00212"></a>00212   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Isc&quot;</span>, Isc * A);
<a name="l00213"></a>00213 
<a name="l00214"></a>00214   <span class="comment">// check unphysical parameters</span>
<a name="l00215"></a>00215   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Nf = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Nf&quot;</span>);
<a name="l00216"></a>00216   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Nr = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Nr&quot;</span>);
<a name="l00217"></a>00217   <span class="keywordflow">if</span> (Nf &lt; 1.0) {
<a name="l00218"></a>00218     <a class="code" href="logging_8c.html#abe06a8732a47a291606edcfac5e5146e">logprint</a> (<a class="code" href="logging_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;WARNING: Unphysical model parameter Nf = %g in &quot;</span>
<a name="l00219"></a>00219               <span class="stringliteral">&quot;BJT `%s&#39;\n&quot;</span>, Nf, <a class="code" href="classqucs_1_1object.html#a3134f6d4b6abda0fb40ac2a9fb4344cc" title="Get the name of the object.">getName</a> ());
<a name="l00220"></a>00220   }
<a name="l00221"></a>00221   <span class="keywordflow">if</span> (Nr &lt; 1.0) {
<a name="l00222"></a>00222     <a class="code" href="logging_8c.html#abe06a8732a47a291606edcfac5e5146e">logprint</a> (<a class="code" href="logging_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;WARNING: Unphysical model parameter Nr = %g in &quot;</span>
<a name="l00223"></a>00223               <span class="stringliteral">&quot;BJT `%s&#39;\n&quot;</span>, Nr, <a class="code" href="classqucs_1_1object.html#a3134f6d4b6abda0fb40ac2a9fb4344cc" title="Get the name of the object.">getName</a> ());
<a name="l00224"></a>00224   }
<a name="l00225"></a>00225   <span class="keywordflow">if</span> (Ne &lt; 1.0) {
<a name="l00226"></a>00226     <a class="code" href="logging_8c.html#abe06a8732a47a291606edcfac5e5146e">logprint</a> (<a class="code" href="logging_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;WARNING: Unphysical model parameter Ne = %g in &quot;</span>
<a name="l00227"></a>00227               <span class="stringliteral">&quot;BJT `%s&#39;\n&quot;</span>, Ne, <a class="code" href="classqucs_1_1object.html#a3134f6d4b6abda0fb40ac2a9fb4344cc" title="Get the name of the object.">getName</a> ());
<a name="l00228"></a>00228   }
<a name="l00229"></a>00229   <span class="keywordflow">if</span> (Nc &lt; 1.0) {
<a name="l00230"></a>00230     <a class="code" href="logging_8c.html#abe06a8732a47a291606edcfac5e5146e">logprint</a> (<a class="code" href="logging_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;WARNING: Unphysical model parameter Nc = %g in &quot;</span>
<a name="l00231"></a>00231               <span class="stringliteral">&quot;BJT `%s&#39;\n&quot;</span>, Nc, <a class="code" href="classqucs_1_1object.html#a3134f6d4b6abda0fb40ac2a9fb4344cc" title="Get the name of the object.">getName</a> ());
<a name="l00232"></a>00232   }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   <span class="comment">/* Originally Vtf was expected to be PROP_POS_RANGE, but there are models</span>
<a name="l00235"></a>00235 <span class="comment">   * which use negative values. Instead of failing, warn the user.</span>
<a name="l00236"></a>00236 <span class="comment">   * \todo Provide a way to silece such warnings</span>
<a name="l00237"></a>00237 <span class="comment">   */</span>
<a name="l00238"></a>00238   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Vtf = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Vtf&quot;</span>);
<a name="l00239"></a>00239   <span class="keywordflow">if</span> (Vtf &lt; 0.0) {
<a name="l00240"></a>00240     <a class="code" href="logging_8c.html#abe06a8732a47a291606edcfac5e5146e">logprint</a> (<a class="code" href="logging_8h.html#aced66975c154ea0e2a8ec3bc818b4e08">LOG_ERROR</a>, <span class="stringliteral">&quot;WARNING: Unphysical model parameter Vtf = %g in &quot;</span>
<a name="l00241"></a>00241               <span class="stringliteral">&quot;BJT `%s&#39;\n&quot;</span>, Vtf, <a class="code" href="classqucs_1_1object.html#a3134f6d4b6abda0fb40ac2a9fb4344cc" title="Get the name of the object.">getName</a> ());
<a name="l00242"></a>00242   }
<a name="l00243"></a>00243 
<a name="l00244"></a>00244   <span class="comment">// compute Cje, Cjc and Cjs temperature and area dependencies</span>
<a name="l00245"></a>00245   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cje = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Cje&quot;</span>);
<a name="l00246"></a>00246   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cjc = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Cjc&quot;</span>);
<a name="l00247"></a>00247   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cjs = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Cjs&quot;</span>);
<a name="l00248"></a>00248   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Mje = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Mje&quot;</span>);
<a name="l00249"></a>00249   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Mjc = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Mjc&quot;</span>);
<a name="l00250"></a>00250   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Mjs = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Mjs&quot;</span>);
<a name="l00251"></a>00251   Cje = <a class="code" href="namespacequcs_1_1device.html#ae7934129c56249dcf14740ade43d6c74">pnCapacitance_T</a> (T1, T2, Mje, VjeT / Vje, Cje);
<a name="l00252"></a>00252   Cjc = <a class="code" href="namespacequcs_1_1device.html#ae7934129c56249dcf14740ade43d6c74">pnCapacitance_T</a> (T1, T2, Mjc, VjcT / Vjc, Cjc);
<a name="l00253"></a>00253   Cjs = <a class="code" href="namespacequcs_1_1device.html#ae7934129c56249dcf14740ade43d6c74">pnCapacitance_T</a> (T1, T2, Mjs, VjsT / Vjs, Cjs);
<a name="l00254"></a>00254   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Cje&quot;</span>, Cje * A);
<a name="l00255"></a>00255   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Cjc&quot;</span>, Cjc * A);
<a name="l00256"></a>00256   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Cjs&quot;</span>, Cjs * A);
<a name="l00257"></a>00257 
<a name="l00258"></a>00258   <span class="comment">// compute Rb, Rc, Re and Rbm area dependencies</span>
<a name="l00259"></a>00259   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Rb  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Rb&quot;</span>);
<a name="l00260"></a>00260   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Re  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Re&quot;</span>);
<a name="l00261"></a>00261   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Rc  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Rc&quot;</span>);
<a name="l00262"></a>00262   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Rbm = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Rbm&quot;</span>);
<a name="l00263"></a>00263   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Rb&quot;</span>, Rb / A);
<a name="l00264"></a>00264   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Re&quot;</span>, Re / A);
<a name="l00265"></a>00265   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Rc&quot;</span>, Rc / A);
<a name="l00266"></a>00266   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Rbm&quot;</span>, Rbm / A);
<a name="l00267"></a>00267 
<a name="l00268"></a>00268   <span class="comment">// compute Ikf, Ikr, Irb and Itf area dependencies</span>
<a name="l00269"></a>00269   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ikf = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Ikf&quot;</span>);
<a name="l00270"></a>00270   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ikr = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Ikr&quot;</span>);
<a name="l00271"></a>00271   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Irb = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Irb&quot;</span>);
<a name="l00272"></a>00272   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Itf = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Itf&quot;</span>);
<a name="l00273"></a>00273   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Ikf&quot;</span>, Ikf * A);
<a name="l00274"></a>00274   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Ikr&quot;</span>, Ikr * A);
<a name="l00275"></a>00275   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Irb&quot;</span>, Irb * A);
<a name="l00276"></a>00276   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Itf&quot;</span>, Itf * A);
<a name="l00277"></a>00277 }
<a name="l00278"></a>00278 
<a name="l00279"></a><a class="code" href="structbjt.html#ac14a95a034d6fd35c290b6aa3cfe9d7d">00279</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#ac14a95a034d6fd35c290b6aa3cfe9d7d">bjt::initDC</a> (<span class="keywordtype">void</span>) {
<a name="l00280"></a>00280 
<a name="l00281"></a>00281   <span class="comment">// no transient analysis</span>
<a name="l00282"></a>00282   <a class="code" href="structbjt.html#a83a0842c3b7e8b67945042b4c99ee74f">doTR</a> = <span class="keyword">false</span>;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284   <span class="comment">// allocate MNA matrices</span>
<a name="l00285"></a>00285   <a class="code" href="classqucs_1_1circuit.html#a263c5ec9a8a53d2f1ba1352b67579ead">allocMatrixMNA</a> ();
<a name="l00286"></a>00286 
<a name="l00287"></a>00287   <span class="comment">// initialize scalability</span>
<a name="l00288"></a>00288   <a class="code" href="structbjt.html#a27e1ce38d676dade15d7fb47b304dac7">initModel</a> ();
<a name="l00289"></a>00289 
<a name="l00290"></a>00290   <span class="comment">// apply polarity of BJT</span>
<a name="l00291"></a>00291   <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code" href="classqucs_1_1circuit.html#a64033618124298f79d53ebd2b364c6e6">type</a> = <a class="code" href="classqucs_1_1object.html#a36314693916e9ee95c839b05b973d95b">getPropertyString</a> (<span class="stringliteral">&quot;Type&quot;</span>);
<a name="l00292"></a>00292   <a class="code" href="classqucs_1_1circuit.html#a37ad2718f9a2b8c35dd8fa04c7c15afb">pol</a> = !strcmp (type, <span class="stringliteral">&quot;pnp&quot;</span>) ? -1 : 1;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294   <span class="comment">// get simulation temperature</span>
<a name="l00295"></a>00295   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> T = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Temp&quot;</span>);
<a name="l00296"></a>00296 
<a name="l00297"></a>00297   <span class="comment">// initialize starting values</span>
<a name="l00298"></a>00298   <a class="code" href="structbjt.html#a0c8ab2489c68c7f14aa5fa1ba1540b18">restartDC</a> ();
<a name="l00299"></a>00299 
<a name="l00300"></a>00300   <span class="comment">// disable additional base-collector capacitance</span>
<a name="l00301"></a>00301   <span class="keywordflow">if</span> (<a class="code" href="namespacequcs_1_1device.html#a2946029a0c7c8849da482ed119164e42">deviceEnabled</a> (<a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>)) {
<a name="l00302"></a>00302     <a class="code" href="namespacequcs_1_1device.html#aa3e179be9537242cc539c790459c365b">disableCapacitor</a> (<span class="keyword">this</span>, <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>);
<a name="l00303"></a>00303   }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305   <span class="comment">// possibly insert series resistance at emitter</span>
<a name="l00306"></a>00306   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Re = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Re&quot;</span>);
<a name="l00307"></a>00307   <span class="keywordflow">if</span> (Re != 0.0) {
<a name="l00308"></a>00308     <span class="comment">// create additional circuit if necessary and reassign nodes</span>
<a name="l00309"></a>00309     <a class="code" href="structbjt.html#a03304a48c500137ede666c57e871a5b8">re</a> = <a class="code" href="namespacequcs_1_1device.html#ab2249f9c036f7cee4c487bbbe74eea49">splitResistor</a> (<span class="keyword">this</span>, <a class="code" href="structbjt.html#a03304a48c500137ede666c57e871a5b8">re</a>, <span class="stringliteral">&quot;Re&quot;</span>, <span class="stringliteral">&quot;emitter&quot;</span>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>);
<a name="l00310"></a>00310     <a class="code" href="structbjt.html#a03304a48c500137ede666c57e871a5b8">re</a>-&gt;setProperty (<span class="stringliteral">&quot;R&quot;</span>, Re);
<a name="l00311"></a>00311     <a class="code" href="structbjt.html#a03304a48c500137ede666c57e871a5b8">re</a>-&gt;setProperty (<span class="stringliteral">&quot;Temp&quot;</span>, T);
<a name="l00312"></a>00312     <a class="code" href="structbjt.html#a03304a48c500137ede666c57e871a5b8">re</a>-&gt;setProperty (<span class="stringliteral">&quot;Controlled&quot;</span>, <a class="code" href="classqucs_1_1object.html#a3134f6d4b6abda0fb40ac2a9fb4344cc" title="Get the name of the object.">getName</a> ());
<a name="l00313"></a>00313     <a class="code" href="structbjt.html#a03304a48c500137ede666c57e871a5b8">re</a>-&gt;initDC ();
<a name="l00314"></a>00314   }
<a name="l00315"></a>00315   <span class="comment">// no series resistance at emitter</span>
<a name="l00316"></a>00316   <span class="keywordflow">else</span> {
<a name="l00317"></a>00317     <a class="code" href="namespacequcs_1_1device.html#a58868c03fbf4808e0cbec8c617105a92">disableResistor</a> (<span class="keyword">this</span>, <a class="code" href="structbjt.html#a03304a48c500137ede666c57e871a5b8">re</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>);
<a name="l00318"></a>00318   }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320   <span class="comment">// possibly insert series resistance at collector</span>
<a name="l00321"></a>00321   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Rc = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Rc&quot;</span>);
<a name="l00322"></a>00322   <span class="keywordflow">if</span> (Rc != 0.0) {
<a name="l00323"></a>00323     <span class="comment">// create additional circuit if necessary and reassign nodes</span>
<a name="l00324"></a>00324     <a class="code" href="structbjt.html#a5ef5f952b97d9ff4b584f0ad6b8d5a26">rc</a> = <a class="code" href="namespacequcs_1_1device.html#ab2249f9c036f7cee4c487bbbe74eea49">splitResistor</a> (<span class="keyword">this</span>, <a class="code" href="structbjt.html#a5ef5f952b97d9ff4b584f0ad6b8d5a26">rc</a>, <span class="stringliteral">&quot;Rc&quot;</span>, <span class="stringliteral">&quot;collector&quot;</span>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>);
<a name="l00325"></a>00325     <a class="code" href="structbjt.html#a5ef5f952b97d9ff4b584f0ad6b8d5a26">rc</a>-&gt;setProperty (<span class="stringliteral">&quot;R&quot;</span>, Rc);
<a name="l00326"></a>00326     <a class="code" href="structbjt.html#a5ef5f952b97d9ff4b584f0ad6b8d5a26">rc</a>-&gt;setProperty (<span class="stringliteral">&quot;Temp&quot;</span>, T);
<a name="l00327"></a>00327     <a class="code" href="structbjt.html#a5ef5f952b97d9ff4b584f0ad6b8d5a26">rc</a>-&gt;setProperty (<span class="stringliteral">&quot;Controlled&quot;</span>, <a class="code" href="classqucs_1_1object.html#a3134f6d4b6abda0fb40ac2a9fb4344cc" title="Get the name of the object.">getName</a> ());
<a name="l00328"></a>00328     <a class="code" href="structbjt.html#a5ef5f952b97d9ff4b584f0ad6b8d5a26">rc</a>-&gt;initDC ();
<a name="l00329"></a>00329   }
<a name="l00330"></a>00330   <span class="comment">// no series resistance at collector</span>
<a name="l00331"></a>00331   <span class="keywordflow">else</span> {
<a name="l00332"></a>00332     <a class="code" href="namespacequcs_1_1device.html#a58868c03fbf4808e0cbec8c617105a92">disableResistor</a> (<span class="keyword">this</span>, <a class="code" href="structbjt.html#a5ef5f952b97d9ff4b584f0ad6b8d5a26">rc</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>);
<a name="l00333"></a>00333   }
<a name="l00334"></a>00334 
<a name="l00335"></a>00335   <span class="comment">// possibly insert base series resistance</span>
<a name="l00336"></a>00336   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Rb  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Rb&quot;</span>);
<a name="l00337"></a>00337   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Rbm = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Rbm&quot;</span>);
<a name="l00338"></a>00338   <span class="keywordflow">if</span> (Rbm &lt;= 0.0) Rbm = Rb; <span class="comment">// Rbm defaults to Rb if zero</span>
<a name="l00339"></a>00339   <span class="keywordflow">if</span> (Rb &lt; Rbm)   Rbm = Rb; <span class="comment">// Rbm must be less or equal Rb</span>
<a name="l00340"></a>00340   <a class="code" href="classqucs_1_1object.html#a5606a92ab53d854491432d196e3550a6">setScaledProperty</a> (<span class="stringliteral">&quot;Rbm&quot;</span>, Rbm);
<a name="l00341"></a>00341   <span class="keywordflow">if</span> (Rbm != 0.0) {
<a name="l00342"></a>00342     <span class="comment">// create additional circuit and reassign nodes</span>
<a name="l00343"></a>00343     <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a> = <a class="code" href="namespacequcs_1_1device.html#ab2249f9c036f7cee4c487bbbe74eea49">splitResistor</a> (<span class="keyword">this</span>, <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>, <span class="stringliteral">&quot;Rbb&quot;</span>, <span class="stringliteral">&quot;base&quot;</span>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>);
<a name="l00344"></a>00344     <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>-&gt;setProperty (<span class="stringliteral">&quot;R&quot;</span>, Rb);
<a name="l00345"></a>00345     <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>-&gt;setProperty (<span class="stringliteral">&quot;Temp&quot;</span>, T);
<a name="l00346"></a>00346     <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>-&gt;setProperty (<span class="stringliteral">&quot;Controlled&quot;</span>, <a class="code" href="classqucs_1_1object.html#a3134f6d4b6abda0fb40ac2a9fb4344cc" title="Get the name of the object.">getName</a> ());
<a name="l00347"></a>00347     <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>-&gt;initDC ();
<a name="l00348"></a>00348   }
<a name="l00349"></a>00349   <span class="comment">// no series resistance at base</span>
<a name="l00350"></a>00350   <span class="keywordflow">else</span> {
<a name="l00351"></a>00351     <a class="code" href="namespacequcs_1_1device.html#a58868c03fbf4808e0cbec8c617105a92">disableResistor</a> (<span class="keyword">this</span>, <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>);
<a name="l00352"></a>00352     <a class="code" href="structbjt.html#a134cef3d7f328d1621789b12da0950da">Rbb</a> = 0.0;                 <span class="comment">// set this operating point</span>
<a name="l00353"></a>00353     <a class="code" href="classqucs_1_1object.html#a72f4a6123b446549239e5ff21eacd673">setProperty</a> (<span class="stringliteral">&quot;Xcjc&quot;</span>, 1.0); <span class="comment">// other than 1 is senseless here</span>
<a name="l00354"></a>00354   }
<a name="l00355"></a>00355 }
<a name="l00356"></a>00356 
<a name="l00357"></a><a class="code" href="structbjt.html#a0c8ab2489c68c7f14aa5fa1ba1540b18">00357</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a0c8ab2489c68c7f14aa5fa1ba1540b18">bjt::restartDC</a> (<span class="keywordtype">void</span>) {
<a name="l00358"></a>00358   <span class="comment">// apply starting values to previous iteration values</span>
<a name="l00359"></a>00359   <a class="code" href="structbjt.html#ac530f7c4521dff8045153ee58a801da3">UbePrev</a> = <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (<a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>) - <a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>)) * <a class="code" href="classqucs_1_1circuit.html#a37ad2718f9a2b8c35dd8fa04c7c15afb">pol</a>;
<a name="l00360"></a>00360   <a class="code" href="structbjt.html#ac501f4912224992de0d0856cf182d381">UbcPrev</a> = <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (<a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>) - <a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>)) * <a class="code" href="classqucs_1_1circuit.html#a37ad2718f9a2b8c35dd8fa04c7c15afb">pol</a>;
<a name="l00361"></a>00361 }
<a name="l00362"></a>00362 
<a name="l00363"></a><a class="code" href="bjt_8cpp.html#a6babe3ca71322db71241201d11984573">00363</a> <span class="preprocessor">#define cexState 6 // extra excess phase state</span>
<a name="l00364"></a>00364 <span class="preprocessor"></span>
<a name="l00365"></a><a class="code" href="structbjt.html#a2afa2e8351cf89db627c448ef859a56c">00365</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a2afa2e8351cf89db627c448ef859a56c">bjt::calcDC</a> (<span class="keywordtype">void</span>) {
<a name="l00366"></a>00366 
<a name="l00367"></a>00367   <span class="comment">// fetch device model parameters</span>
<a name="l00368"></a>00368   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Is   = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Is&quot;</span>);
<a name="l00369"></a>00369   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Nf   = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Nf&quot;</span>);
<a name="l00370"></a>00370   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Nr   = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Nr&quot;</span>);
<a name="l00371"></a>00371   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Vaf  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Vaf&quot;</span>);
<a name="l00372"></a>00372   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Var  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Var&quot;</span>);
<a name="l00373"></a>00373   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ikf  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Ikf&quot;</span>);
<a name="l00374"></a>00374   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ikr  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Ikr&quot;</span>);
<a name="l00375"></a>00375   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Bf   = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Bf&quot;</span>);
<a name="l00376"></a>00376   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Br   = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Br&quot;</span>);
<a name="l00377"></a>00377   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ise  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Ise&quot;</span>);
<a name="l00378"></a>00378   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Isc  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Isc&quot;</span>);
<a name="l00379"></a>00379   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ne   = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Ne&quot;</span>);
<a name="l00380"></a>00380   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Nc   = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Nc&quot;</span>);
<a name="l00381"></a>00381   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Rb   = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Rb&quot;</span>);
<a name="l00382"></a>00382   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Rbm  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Rbm&quot;</span>);
<a name="l00383"></a>00383   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Irb  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Irb&quot;</span>);
<a name="l00384"></a>00384   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> T    = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Temp&quot;</span>);
<a name="l00385"></a>00385 
<a name="l00386"></a>00386   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ut, Q1, Q2;
<a name="l00387"></a>00387   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Iben, Ibcn, Ibei, Ibci, Ibc, gbe, gbc, gtiny;
<a name="l00388"></a>00388   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> IeqB, IeqC, IeqE, IeqS, UbeCrit, UbcCrit;
<a name="l00389"></a>00389   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> gm, go;
<a name="l00390"></a>00390 
<a name="l00391"></a>00391   <span class="comment">// interpret zero as infinity for these model parameters</span>
<a name="l00392"></a>00392   Ikf = Ikf &gt; 0 ? 1.0 / Ikf : 0;
<a name="l00393"></a>00393   Ikr = Ikr &gt; 0 ? 1.0 / Ikr : 0;
<a name="l00394"></a>00394   Vaf = Vaf &gt; 0 ? 1.0 / Vaf : 0;
<a name="l00395"></a>00395   Var = Var &gt; 0 ? 1.0 / Var : 0;
<a name="l00396"></a>00396 
<a name="l00397"></a>00397   T = <a class="code" href="namespacequcs.html#a60eabd98195ced2fcfd8d15fd487642b" title="Convert Celsius to Kelvin.">celsius2kelvin</a> (T);
<a name="l00398"></a>00398   Ut = T * kBoverQ;
<a name="l00399"></a>00399   <a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a> = <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (<a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>) - <a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>)) * <a class="code" href="classqucs_1_1circuit.html#a37ad2718f9a2b8c35dd8fa04c7c15afb">pol</a>;
<a name="l00400"></a>00400   <a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a> = <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (<a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>) - <a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>)) * <a class="code" href="classqucs_1_1circuit.html#a37ad2718f9a2b8c35dd8fa04c7c15afb">pol</a>;
<a name="l00401"></a>00401 
<a name="l00402"></a>00402   <span class="comment">// critical voltage necessary for bad start values</span>
<a name="l00403"></a>00403   UbeCrit = <a class="code" href="namespacequcs_1_1device.html#a13a6f36c7d1abdb805fcdbd97b6814e2">pnCriticalVoltage</a> (Is, Nf * Ut);
<a name="l00404"></a>00404   UbcCrit = <a class="code" href="namespacequcs_1_1device.html#a13a6f36c7d1abdb805fcdbd97b6814e2">pnCriticalVoltage</a> (Is, Nr * Ut);
<a name="l00405"></a>00405   <a class="code" href="structbjt.html#ac530f7c4521dff8045153ee58a801da3">UbePrev</a> = <a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a> = <a class="code" href="namespacequcs_1_1device.html#aa5d321b7f9572af38dab453ef9103ff2">pnVoltage</a> (<a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a>, <a class="code" href="structbjt.html#ac530f7c4521dff8045153ee58a801da3">UbePrev</a>, Ut * Nf, UbeCrit);
<a name="l00406"></a>00406   <a class="code" href="structbjt.html#ac501f4912224992de0d0856cf182d381">UbcPrev</a> = <a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a> = <a class="code" href="namespacequcs_1_1device.html#aa5d321b7f9572af38dab453ef9103ff2">pnVoltage</a> (<a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a>, <a class="code" href="structbjt.html#ac501f4912224992de0d0856cf182d381">UbcPrev</a>, Ut * Nr, UbcCrit);
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   <a class="code" href="structbjt.html#a4c817bf2bd71855bb2f1bdda2b8b150b">Uce</a> = <a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a> - <a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a>;
<a name="l00409"></a>00409 
<a name="l00410"></a>00410   <span class="comment">// base-emitter diodes</span>
<a name="l00411"></a>00411   gtiny = <a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a> &lt; - 10 * Ut * Nf ? (Is + Ise) : 0;
<a name="l00412"></a>00412 <span class="preprocessor">#if 0</span>
<a name="l00413"></a>00413 <span class="preprocessor"></span>  <a class="code" href="structbjt.html#a9b6ea869376005c260581f41d715f49e">If</a> = <a class="code" href="namespacequcs_1_1device.html#a0f21311fd4019d409bf3edd81ff47245">pnCurrent</a> (<a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a>, Is, Ut * Nf);
<a name="l00414"></a>00414   Ibei = If / Bf;
<a name="l00415"></a>00415   <a class="code" href="structbjt.html#acf97f40164bf00d78d94f47a57d7cb73">gif</a> = <a class="code" href="namespacequcs_1_1device.html#adbc837aa3341b4780d9b6e8909ee9709">pnConductance</a> (<a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a>, Is, Ut * Nf);
<a name="l00416"></a>00416   <a class="code" href="structbjt.html#ae9d0c44c7dcae0382700c33dde03bb1f">gbei</a> = <a class="code" href="structbjt.html#acf97f40164bf00d78d94f47a57d7cb73">gif</a> / Bf;
<a name="l00417"></a>00417   Iben = <a class="code" href="namespacequcs_1_1device.html#a0f21311fd4019d409bf3edd81ff47245">pnCurrent</a> (<a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a>, Ise, Ut * Ne);
<a name="l00418"></a>00418   <a class="code" href="structbjt.html#a276633891d6b51e5970fd9507fab9077">gben</a> = <a class="code" href="namespacequcs_1_1device.html#adbc837aa3341b4780d9b6e8909ee9709">pnConductance</a> (<a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a>, Ise, Ut * Ne);
<a name="l00419"></a>00419   <a class="code" href="structbjt.html#a9f819e33876d6de59e62ca75ac108692">Ibe</a> = Ibei + Iben + gtiny * <a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a>;
<a name="l00420"></a>00420   gbe = <a class="code" href="structbjt.html#ae9d0c44c7dcae0382700c33dde03bb1f">gbei</a> + <a class="code" href="structbjt.html#a276633891d6b51e5970fd9507fab9077">gben</a> + gtiny;
<a name="l00421"></a>00421 <span class="preprocessor">#else</span>
<a name="l00422"></a>00422 <span class="preprocessor"></span>  <a class="code" href="namespacequcs_1_1device.html#a93a1442f99146488a2569d5e1a46ab35">pnJunctionBIP</a> (Ube, Is, Ut * Nf, If, <a class="code" href="structbjt.html#acf97f40164bf00d78d94f47a57d7cb73">gif</a>);
<a name="l00423"></a>00423   Ibei = If / Bf;
<a name="l00424"></a>00424   <a class="code" href="structbjt.html#ae9d0c44c7dcae0382700c33dde03bb1f">gbei</a> = <a class="code" href="structbjt.html#acf97f40164bf00d78d94f47a57d7cb73">gif</a> / Bf;
<a name="l00425"></a>00425   <a class="code" href="namespacequcs_1_1device.html#a93a1442f99146488a2569d5e1a46ab35">pnJunctionBIP</a> (Ube, Ise, Ut * Ne, Iben, <a class="code" href="structbjt.html#a276633891d6b51e5970fd9507fab9077">gben</a>);
<a name="l00426"></a>00426   Iben += gtiny * <a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a>;
<a name="l00427"></a>00427   <a class="code" href="structbjt.html#a276633891d6b51e5970fd9507fab9077">gben</a> += gtiny;
<a name="l00428"></a>00428   <a class="code" href="structbjt.html#a9f819e33876d6de59e62ca75ac108692">Ibe</a> = Ibei + Iben;
<a name="l00429"></a>00429   gbe = <a class="code" href="structbjt.html#ae9d0c44c7dcae0382700c33dde03bb1f">gbei</a> + <a class="code" href="structbjt.html#a276633891d6b51e5970fd9507fab9077">gben</a>;
<a name="l00430"></a>00430 <span class="preprocessor">#endif</span>
<a name="l00431"></a>00431 <span class="preprocessor"></span>
<a name="l00432"></a>00432   <span class="comment">// base-collector diodes</span>
<a name="l00433"></a>00433   gtiny = Ubc &lt; - 10 * Ut * Nr ? (Is + Isc) : 0;
<a name="l00434"></a>00434 <span class="preprocessor">#if 0</span>
<a name="l00435"></a>00435 <span class="preprocessor"></span>  <a class="code" href="structbjt.html#a83521491da2d85131ac75030de3e1fb7">Ir</a> = <a class="code" href="namespacequcs_1_1device.html#a0f21311fd4019d409bf3edd81ff47245">pnCurrent</a> (Ubc, Is, Ut * Nr);
<a name="l00436"></a>00436   Ibci = Ir / Br;
<a name="l00437"></a>00437   <a class="code" href="structbjt.html#a33208bad59aff570acc47e2496fb0e61">gir</a> = <a class="code" href="namespacequcs_1_1device.html#adbc837aa3341b4780d9b6e8909ee9709">pnConductance</a> (Ubc, Is, Ut * Nr);
<a name="l00438"></a>00438   <a class="code" href="structbjt.html#a5ce84f52c25d9f23c175a4e5959259b2">gbci</a> = <a class="code" href="structbjt.html#a33208bad59aff570acc47e2496fb0e61">gir</a> / Br;
<a name="l00439"></a>00439   Ibcn = <a class="code" href="namespacequcs_1_1device.html#a0f21311fd4019d409bf3edd81ff47245">pnCurrent</a> (Ubc, Isc, Ut * Nc);
<a name="l00440"></a>00440   <a class="code" href="structbjt.html#a348ae1374d9fe85ff429850377d2cef9">gbcn</a> = <a class="code" href="namespacequcs_1_1device.html#adbc837aa3341b4780d9b6e8909ee9709">pnConductance</a> (Ubc, Isc, Ut * Nc);
<a name="l00441"></a>00441   Ibc = Ibci + Ibcn + gtiny * <a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a>;
<a name="l00442"></a>00442   gbc = <a class="code" href="structbjt.html#a5ce84f52c25d9f23c175a4e5959259b2">gbci</a> + <a class="code" href="structbjt.html#a348ae1374d9fe85ff429850377d2cef9">gbcn</a> + gtiny;
<a name="l00443"></a>00443 <span class="preprocessor">#else</span>
<a name="l00444"></a>00444 <span class="preprocessor"></span>  <a class="code" href="namespacequcs_1_1device.html#a93a1442f99146488a2569d5e1a46ab35">pnJunctionBIP</a> (Ubc, Is, Ut * Nr, Ir, <a class="code" href="structbjt.html#a33208bad59aff570acc47e2496fb0e61">gir</a>);
<a name="l00445"></a>00445   Ibci = Ir / Br;
<a name="l00446"></a>00446   <a class="code" href="structbjt.html#a5ce84f52c25d9f23c175a4e5959259b2">gbci</a> = <a class="code" href="structbjt.html#a33208bad59aff570acc47e2496fb0e61">gir</a> / Br;
<a name="l00447"></a>00447   <a class="code" href="namespacequcs_1_1device.html#a93a1442f99146488a2569d5e1a46ab35">pnJunctionBIP</a> (Ubc, Isc, Ut * Nc, Ibcn, <a class="code" href="structbjt.html#a348ae1374d9fe85ff429850377d2cef9">gbcn</a>);
<a name="l00448"></a>00448   Ibcn += gtiny * <a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a>;
<a name="l00449"></a>00449   <a class="code" href="structbjt.html#a348ae1374d9fe85ff429850377d2cef9">gbcn</a> += gtiny;
<a name="l00450"></a>00450   Ibc = Ibci + Ibcn;
<a name="l00451"></a>00451   gbc = <a class="code" href="structbjt.html#a5ce84f52c25d9f23c175a4e5959259b2">gbci</a> + <a class="code" href="structbjt.html#a348ae1374d9fe85ff429850377d2cef9">gbcn</a>;
<a name="l00452"></a>00452 <span class="preprocessor">#endif</span>
<a name="l00453"></a>00453 <span class="preprocessor"></span>
<a name="l00454"></a>00454   <span class="comment">// compute base charge quantities</span>
<a name="l00455"></a>00455   Q1 = 1 / (1 - Ubc * Vaf - Ube * Var);
<a name="l00456"></a>00456   Q2 = If * Ikf + Ir * Ikr;
<a name="l00457"></a>00457   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> SArg = 1.0 + 4.0 * Q2;
<a name="l00458"></a>00458   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Sqrt = SArg &gt; 0 ? <a class="code" href="namespacequcs.html#adeb767aff95d4dcd7a53f06b39dc1084" title="Compute principal value of square root.">qucs::sqrt</a> (SArg) : 1;
<a name="l00459"></a>00459   <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a> = Q1 * (1 + Sqrt) / 2;
<a name="l00460"></a>00460   <a class="code" href="structbjt.html#ad42f227a1e5376474f6781473c816ef8">dQbdUbe</a> = Q1 * (<a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a> * Var + <a class="code" href="structbjt.html#acf97f40164bf00d78d94f47a57d7cb73">gif</a> * Ikf / Sqrt);
<a name="l00461"></a>00461   <a class="code" href="structbjt.html#a46ea8e8bcb61ab7d8e9819152a762217">dQbdUbc</a> = Q1 * (<a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a> * Vaf + <a class="code" href="structbjt.html#a33208bad59aff570acc47e2496fb0e61">gir</a> * Ikr / Sqrt);
<a name="l00462"></a>00462 
<a name="l00463"></a>00463   <span class="comment">// during transient analysis only</span>
<a name="l00464"></a>00464   <span class="keywordflow">if</span> (<a class="code" href="structbjt.html#a83a0842c3b7e8b67945042b4c99ee74f">doTR</a>) {
<a name="l00465"></a>00465     <span class="comment">// calculate excess phase influence</span>
<a name="l00466"></a>00466     If /= <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a>;
<a name="l00467"></a>00467     <a class="code" href="structbjt.html#a5363bdeb4e39eef86f36feda87e415f0">excessPhase</a> (<a class="code" href="bjt_8cpp.html#a6babe3ca71322db71241201d11984573">cexState</a>, If, <a class="code" href="structbjt.html#acf97f40164bf00d78d94f47a57d7cb73">gif</a>);
<a name="l00468"></a>00468     If *= <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a>;
<a name="l00469"></a>00469   }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471   <span class="comment">// compute transfer current</span>
<a name="l00472"></a>00472   <a class="code" href="structbjt.html#a6f86833cbb905b5842aaa30bdb2a2299">It</a> = (If - <a class="code" href="structbjt.html#a83521491da2d85131ac75030de3e1fb7">Ir</a>) / <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a>;
<a name="l00473"></a>00473 
<a name="l00474"></a>00474   <span class="comment">// compute forward and backward transconductance</span>
<a name="l00475"></a>00475   <a class="code" href="structbjt.html#a2daa7ead3fa1a97a46d3cfc8b813ee8b">gitf</a> = (+<a class="code" href="structbjt.html#acf97f40164bf00d78d94f47a57d7cb73">gif</a> - <a class="code" href="structbjt.html#a6f86833cbb905b5842aaa30bdb2a2299">It</a> * <a class="code" href="structbjt.html#ad42f227a1e5376474f6781473c816ef8">dQbdUbe</a>) / <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a>;
<a name="l00476"></a>00476   <a class="code" href="structbjt.html#aebd211ce3e346442129e6b0875ba2796">gitr</a> = (-<a class="code" href="structbjt.html#a33208bad59aff570acc47e2496fb0e61">gir</a> - <a class="code" href="structbjt.html#a6f86833cbb905b5842aaa30bdb2a2299">It</a> * <a class="code" href="structbjt.html#a46ea8e8bcb61ab7d8e9819152a762217">dQbdUbc</a>) / <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a>;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478   <span class="comment">// compute old SPICE values</span>
<a name="l00479"></a>00479   go = -<a class="code" href="structbjt.html#aebd211ce3e346442129e6b0875ba2796">gitr</a>;
<a name="l00480"></a>00480   gm = +<a class="code" href="structbjt.html#a2daa7ead3fa1a97a46d3cfc8b813ee8b">gitf</a> - go;
<a name="l00481"></a>00481   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;gm&quot;</span>, gm);
<a name="l00482"></a>00482   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;go&quot;</span>, go);
<a name="l00483"></a>00483 
<a name="l00484"></a>00484   <span class="comment">// calculate current-dependent base resistance</span>
<a name="l00485"></a>00485   <span class="keywordflow">if</span> (Rbm != 0.0) {
<a name="l00486"></a>00486     <span class="keywordflow">if</span> (Irb != 0.0) {
<a name="l00487"></a>00487       <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> a, b, z;
<a name="l00488"></a>00488       a = (Ibci + Ibcn + Ibei + Iben) / Irb;
<a name="l00489"></a>00489       a = std::max (a, NR_TINY); <span class="comment">// enforce positive values</span>
<a name="l00490"></a>00490       z = (<a class="code" href="namespacequcs.html#adeb767aff95d4dcd7a53f06b39dc1084" title="Compute principal value of square root.">qucs::sqrt</a> (1 + 144 / <a class="code" href="namespacequcs.html#ae58b59f7f7e9fadd77ef9c7d30c2975f" title="Square of complex number.">sqr</a> (pi) * a) - 1) / 24 * <a class="code" href="namespacequcs.html#ae58b59f7f7e9fadd77ef9c7d30c2975f" title="Square of complex number.">sqr</a> (pi) / <a class="code" href="namespacequcs.html#adeb767aff95d4dcd7a53f06b39dc1084" title="Compute principal value of square root.">qucs::sqrt</a> (a);
<a name="l00491"></a>00491       b = <a class="code" href="namespacequcs.html#aebf40c5c6b2c41bc0635ffa3c5cfc260" title="Compute complex tangent.">qucs::tan</a> (z);
<a name="l00492"></a>00492       <a class="code" href="structbjt.html#a134cef3d7f328d1621789b12da0950da">Rbb</a> = Rbm + 3 * (Rb - Rbm) * (b - z) / z / <a class="code" href="namespacequcs.html#ae58b59f7f7e9fadd77ef9c7d30c2975f" title="Square of complex number.">sqr</a> (b);
<a name="l00493"></a>00493     }
<a name="l00494"></a>00494     <span class="keywordflow">else</span> {
<a name="l00495"></a>00495       <a class="code" href="structbjt.html#a134cef3d7f328d1621789b12da0950da">Rbb</a> = Rbm + (Rb - Rbm) / <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a>;
<a name="l00496"></a>00496     }
<a name="l00497"></a>00497     <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>-&gt;setScaledProperty (<span class="stringliteral">&quot;R&quot;</span>, <a class="code" href="structbjt.html#a134cef3d7f328d1621789b12da0950da">Rbb</a>);
<a name="l00498"></a>00498     <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>-&gt;calcDC ();
<a name="l00499"></a>00499   }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501   <span class="comment">// compute autonomic current sources</span>
<a name="l00502"></a>00502   IeqB = <a class="code" href="structbjt.html#a9f819e33876d6de59e62ca75ac108692">Ibe</a> - Ube * gbe;
<a name="l00503"></a>00503   IeqC = Ibc - Ubc * gbc;
<a name="l00504"></a>00504 <span class="preprocessor">#if NEWSGP</span>
<a name="l00505"></a>00505 <span class="preprocessor"></span>  IeqE = <a class="code" href="structbjt.html#a6f86833cbb905b5842aaa30bdb2a2299">It</a> - Ube * <a class="code" href="structbjt.html#a2daa7ead3fa1a97a46d3cfc8b813ee8b">gitf</a> - Ubc * <a class="code" href="structbjt.html#aebd211ce3e346442129e6b0875ba2796">gitr</a>;
<a name="l00506"></a>00506 <span class="preprocessor">#else</span>
<a name="l00507"></a>00507 <span class="preprocessor"></span>  IeqE = <a class="code" href="structbjt.html#a6f86833cbb905b5842aaa30bdb2a2299">It</a> - Ube * gm - <a class="code" href="structbjt.html#a4c817bf2bd71855bb2f1bdda2b8b150b">Uce</a> * go;
<a name="l00508"></a>00508 <span class="preprocessor">#endif</span>
<a name="l00509"></a>00509 <span class="preprocessor"></span>  IeqS = 0;
<a name="l00510"></a>00510   <a class="code" href="classqucs_1_1circuit.html#a266313246b5d4710c18fd972d8c0a229">setI</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, (-IeqB - IeqC) * <a class="code" href="classqucs_1_1circuit.html#a37ad2718f9a2b8c35dd8fa04c7c15afb">pol</a>);
<a name="l00511"></a>00511   <a class="code" href="classqucs_1_1circuit.html#a266313246b5d4710c18fd972d8c0a229">setI</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, (+IeqC - IeqE - IeqS) * pol);
<a name="l00512"></a>00512   <a class="code" href="classqucs_1_1circuit.html#a266313246b5d4710c18fd972d8c0a229">setI</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, (+IeqB + IeqE) * pol);
<a name="l00513"></a>00513   <a class="code" href="classqucs_1_1circuit.html#a266313246b5d4710c18fd972d8c0a229">setI</a> (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, (+IeqS) * pol);
<a name="l00514"></a>00514 
<a name="l00515"></a>00515   <span class="comment">// apply admittance matrix elements</span>
<a name="l00516"></a>00516 <span class="preprocessor">#if NEWSGP</span>
<a name="l00517"></a>00517 <span class="preprocessor"></span>  <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, gbc + gbe);
<a name="l00518"></a>00518   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, -gbc);
<a name="l00519"></a>00519   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, -gbe);
<a name="l00520"></a>00520   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00521"></a>00521   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, -gbc + <a class="code" href="structbjt.html#a2daa7ead3fa1a97a46d3cfc8b813ee8b">gitf</a> + gitr);
<a name="l00522"></a>00522   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, gbc - gitr);
<a name="l00523"></a>00523   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, -<a class="code" href="structbjt.html#a2daa7ead3fa1a97a46d3cfc8b813ee8b">gitf</a>);
<a name="l00524"></a>00524   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00525"></a>00525   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, -gbe - <a class="code" href="structbjt.html#a2daa7ead3fa1a97a46d3cfc8b813ee8b">gitf</a> - gitr);
<a name="l00526"></a>00526   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, gitr);
<a name="l00527"></a>00527   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, gbe + <a class="code" href="structbjt.html#a2daa7ead3fa1a97a46d3cfc8b813ee8b">gitf</a>);
<a name="l00528"></a>00528   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00529"></a>00529   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, 0);
<a name="l00530"></a>00530   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, 0);
<a name="l00531"></a>00531   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, 0);
<a name="l00532"></a>00532   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00533"></a>00533 <span class="preprocessor">#else</span>
<a name="l00534"></a>00534 <span class="preprocessor"></span>  <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, gbc + gbe);
<a name="l00535"></a>00535   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, -gbc);
<a name="l00536"></a>00536   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, -gbe);
<a name="l00537"></a>00537   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00538"></a>00538   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, -gbc + gm);
<a name="l00539"></a>00539   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, go + gbc);
<a name="l00540"></a>00540   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, -go - gm);
<a name="l00541"></a>00541   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00542"></a>00542   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, -gbe - gm);
<a name="l00543"></a>00543   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, -go);
<a name="l00544"></a>00544   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, gbe + go + gm);
<a name="l00545"></a>00545   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00546"></a>00546   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, 0);
<a name="l00547"></a>00547   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, 0);
<a name="l00548"></a>00548   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, 0);
<a name="l00549"></a>00549   <a class="code" href="classqucs_1_1circuit.html#a62c815762664de33be98ddd9e61209c4">setY</a> (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, 0);
<a name="l00550"></a>00550 <span class="preprocessor">#endif</span>
<a name="l00551"></a>00551 <span class="preprocessor"></span>}
<a name="l00552"></a>00552 
<a name="l00553"></a><a class="code" href="structbjt.html#a060b96161665d4042f2e65d3129203bc">00553</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a060b96161665d4042f2e65d3129203bc">bjt::saveOperatingPoints</a> (<span class="keywordtype">void</span>) {
<a name="l00554"></a>00554   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Vbe, Vbc;
<a name="l00555"></a>00555   Vbe = <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (<a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>) - <a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>)) * <a class="code" href="classqucs_1_1circuit.html#a37ad2718f9a2b8c35dd8fa04c7c15afb">pol</a>;
<a name="l00556"></a>00556   Vbc = <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (<a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>) - <a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>)) * <a class="code" href="classqucs_1_1circuit.html#a37ad2718f9a2b8c35dd8fa04c7c15afb">pol</a>;
<a name="l00557"></a>00557   <a class="code" href="structbjt.html#aefa32fafd898ff12ed4022a92d461ca2">Ucs</a> = <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (<a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>) - <a class="code" href="classqucs_1_1circuit.html#abc775b0f5cf152a578b71f8b1564b7aa">getV</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>)) * <a class="code" href="classqucs_1_1circuit.html#a37ad2718f9a2b8c35dd8fa04c7c15afb">pol</a>;
<a name="l00558"></a>00558   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Vbe&quot;</span>, Vbe);
<a name="l00559"></a>00559   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Vbc&quot;</span>, Vbc);
<a name="l00560"></a>00560   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Vce&quot;</span>, Vbe - Vbc);
<a name="l00561"></a>00561   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Vcs&quot;</span>, <a class="code" href="structbjt.html#aefa32fafd898ff12ed4022a92d461ca2">Ucs</a>);
<a name="l00562"></a>00562   <span class="keywordflow">if</span> (<a class="code" href="namespacequcs_1_1device.html#a2946029a0c7c8849da482ed119164e42">deviceEnabled</a> (<a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>)) {
<a name="l00563"></a>00563     <a class="code" href="structbjt.html#a16c2068e97720215c01d3d0ed192f494">Ubx</a> = <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (<a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;getV (<a class="code" href="circuit_8h.html#a4f0d36c5244b59c0f92e7704ac05647f">NODE_1</a>) - <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;getV (<a class="code" href="circuit_8h.html#a6685ff6eaa6d17e48acf55cc8434eaed">NODE_2</a>)) * <a class="code" href="classqucs_1_1circuit.html#a37ad2718f9a2b8c35dd8fa04c7c15afb">pol</a>;
<a name="l00564"></a>00564     <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Vbx&quot;</span>, <a class="code" href="structbjt.html#a16c2068e97720215c01d3d0ed192f494">Ubx</a>);
<a name="l00565"></a>00565   }
<a name="l00566"></a>00566 }
<a name="l00567"></a>00567 
<a name="l00568"></a><a class="code" href="structbjt.html#ae5b3226f91b46113f54769aef6958502">00568</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#ae5b3226f91b46113f54769aef6958502">bjt::loadOperatingPoints</a> (<span class="keywordtype">void</span>) {
<a name="l00569"></a>00569   <a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a> = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Vbe&quot;</span>);
<a name="l00570"></a>00570   <a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a> = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Vbc&quot;</span>);
<a name="l00571"></a>00571   <a class="code" href="structbjt.html#a4c817bf2bd71855bb2f1bdda2b8b150b">Uce</a> = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Vce&quot;</span>);
<a name="l00572"></a>00572   <a class="code" href="structbjt.html#aefa32fafd898ff12ed4022a92d461ca2">Ucs</a> = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Vcs&quot;</span>);
<a name="l00573"></a>00573 }
<a name="l00574"></a>00574 
<a name="l00575"></a><a class="code" href="structbjt.html#a1f1a94ef92ab32f5b3a4dc79dcce6d29">00575</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a1f1a94ef92ab32f5b3a4dc79dcce6d29">bjt::calcOperatingPoints</a> (<span class="keywordtype">void</span>) {
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   <span class="comment">// fetch device model parameters</span>
<a name="l00578"></a>00578   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cje0 = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Cje&quot;</span>);
<a name="l00579"></a>00579   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Vje  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Vje&quot;</span>);
<a name="l00580"></a>00580   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Mje  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Mje&quot;</span>);
<a name="l00581"></a>00581   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cjc0 = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Cjc&quot;</span>);
<a name="l00582"></a>00582   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Vjc  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Vjc&quot;</span>);
<a name="l00583"></a>00583   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Mjc  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Mjc&quot;</span>);
<a name="l00584"></a>00584   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Xcjc = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Xcjc&quot;</span>);
<a name="l00585"></a>00585   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cjs0 = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Cjs&quot;</span>);
<a name="l00586"></a>00586   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Vjs  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Vjs&quot;</span>);
<a name="l00587"></a>00587   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Mjs  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Mjs&quot;</span>);
<a name="l00588"></a>00588   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Fc   = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Fc&quot;</span>);
<a name="l00589"></a>00589   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Vtf  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Vtf&quot;</span>);
<a name="l00590"></a>00590   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Tf   = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Tf&quot;</span>);
<a name="l00591"></a>00591   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Xtf  = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Xtf&quot;</span>);
<a name="l00592"></a>00592   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Itf  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Itf&quot;</span>);
<a name="l00593"></a>00593   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Tr   = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Tr&quot;</span>);
<a name="l00594"></a>00594 
<a name="l00595"></a>00595   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cbe, Cbci, Cbcx, Ccs;
<a name="l00596"></a>00596 
<a name="l00597"></a>00597   <span class="comment">// interpret zero as infinity for that model parameter</span>
<a name="l00598"></a>00598   Vtf = Vtf &gt; 0 ? 1.0 / Vtf : 0;
<a name="l00599"></a>00599 
<a name="l00600"></a>00600   <span class="comment">// depletion capacitance of base-emitter diode</span>
<a name="l00601"></a>00601   Cbe = <a class="code" href="namespacequcs_1_1device.html#adfa3debe05d959439c8c1a6afbf5c111">pnCapacitance</a> (<a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a>, Cje0, Vje, Mje, Fc);
<a name="l00602"></a>00602   <a class="code" href="structbjt.html#ab6468b4561625732acbb5b34b4f4ae5b">Qbe</a> = <a class="code" href="namespacequcs_1_1device.html#ab73ac3b10fcea755c5701ca570c3888a">pnCharge</a> (<a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a>, Cje0, Vje, Mje, Fc);
<a name="l00603"></a>00603 
<a name="l00604"></a>00604   <span class="comment">// diffusion capacitance of base-emitter diode</span>
<a name="l00605"></a>00605   <span class="keywordflow">if</span> (<a class="code" href="structbjt.html#a9b6ea869376005c260581f41d715f49e">If</a> != 0.0) {
<a name="l00606"></a>00606     <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> e, Tff, dTffdUbe, dTffdUbc, a;
<a name="l00607"></a>00607     a = 1 / (1 + Itf / <a class="code" href="structbjt.html#a9b6ea869376005c260581f41d715f49e">If</a>);
<a name="l00608"></a>00608     e = 2 * <a class="code" href="namespacequcs.html#ab5bb59c9137b45fbab66bdbeac414b40" title="Compute complex exponential.">qucs::exp</a> (std::min (<a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a> * Vtf, 709.0));
<a name="l00609"></a>00609     Tff = Tf * (1 + Xtf * <a class="code" href="namespacequcs.html#ae58b59f7f7e9fadd77ef9c7d30c2975f" title="Square of complex number.">sqr</a> (a) * e);
<a name="l00610"></a>00610     dTffdUbe = Tf * Xtf * 2 * <a class="code" href="structbjt.html#acf97f40164bf00d78d94f47a57d7cb73">gif</a> * Itf * <a class="code" href="namespacequcs.html#ac9d2d6081f9378e7504c0b009cb92ad4" title="Compute the third power of input.">cubic</a> (a) / <a class="code" href="namespacequcs.html#ae58b59f7f7e9fadd77ef9c7d30c2975f" title="Square of complex number.">sqr</a> (<a class="code" href="structbjt.html#a9b6ea869376005c260581f41d715f49e">If</a>) * e;
<a name="l00611"></a>00611     Cbe += (<a class="code" href="structbjt.html#a9b6ea869376005c260581f41d715f49e">If</a> * dTffdUbe + Tff * (<a class="code" href="structbjt.html#acf97f40164bf00d78d94f47a57d7cb73">gif</a> - <a class="code" href="structbjt.html#a9b6ea869376005c260581f41d715f49e">If</a> / <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a> * <a class="code" href="structbjt.html#ad42f227a1e5376474f6781473c816ef8">dQbdUbe</a>)) / <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a>;
<a name="l00612"></a>00612     <a class="code" href="structbjt.html#ab6468b4561625732acbb5b34b4f4ae5b">Qbe</a> += <a class="code" href="structbjt.html#a9b6ea869376005c260581f41d715f49e">If</a> * Tff / <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a>;
<a name="l00613"></a>00613     dTffdUbc = Tf * Xtf * Vtf * <a class="code" href="namespacequcs.html#ae58b59f7f7e9fadd77ef9c7d30c2975f" title="Square of complex number.">sqr</a> (a) * e;
<a name="l00614"></a>00614     <a class="code" href="structbjt.html#ad01f9d8f393d184496db59bc7be1b0ba">dQbedUbc</a> = <a class="code" href="structbjt.html#a9b6ea869376005c260581f41d715f49e">If</a> / <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a> * (dTffdUbc - Tff / <a class="code" href="structbjt.html#a8c59458e93ddbbc119b66bfbfdb14418">Qb</a> * <a class="code" href="structbjt.html#a46ea8e8bcb61ab7d8e9819152a762217">dQbdUbc</a>);
<a name="l00615"></a>00615   }
<a name="l00616"></a>00616 
<a name="l00617"></a>00617   <span class="comment">// depletion and diffusion capacitance of base-collector diode</span>
<a name="l00618"></a>00618   Cbci = <a class="code" href="namespacequcs_1_1device.html#adfa3debe05d959439c8c1a6afbf5c111">pnCapacitance</a> (<a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a>, Cjc0 * Xcjc, Vjc, Mjc, Fc) + Tr * <a class="code" href="structbjt.html#a33208bad59aff570acc47e2496fb0e61">gir</a>;
<a name="l00619"></a>00619   <a class="code" href="structbjt.html#a93366cdffa2443148eed6ccc68d40a63">Qbci</a> = <a class="code" href="namespacequcs_1_1device.html#ab73ac3b10fcea755c5701ca570c3888a">pnCharge</a> (<a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a>, Cjc0 * Xcjc, Vjc, Mjc, Fc) + Tr * <a class="code" href="structbjt.html#a83521491da2d85131ac75030de3e1fb7">Ir</a>;
<a name="l00620"></a>00620 
<a name="l00621"></a>00621   <span class="comment">// depletion and diffusion capacitance of external base-collector capacitor</span>
<a name="l00622"></a>00622   Cbcx = <a class="code" href="namespacequcs_1_1device.html#adfa3debe05d959439c8c1a6afbf5c111">pnCapacitance</a> (<a class="code" href="structbjt.html#a16c2068e97720215c01d3d0ed192f494">Ubx</a>, Cjc0 * (1 - Xcjc), Vjc, Mjc, Fc);
<a name="l00623"></a>00623   <a class="code" href="structbjt.html#afaf11334db23096d653a6fb7f7f5d342">Qbcx</a> = <a class="code" href="namespacequcs_1_1device.html#ab73ac3b10fcea755c5701ca570c3888a">pnCharge</a> (<a class="code" href="structbjt.html#a16c2068e97720215c01d3d0ed192f494">Ubx</a>, Cjc0 * (1 - Xcjc), Vjc, Mjc, Fc);
<a name="l00624"></a>00624 
<a name="l00625"></a>00625   <span class="comment">// depletion capacitance of collector-substrate diode</span>
<a name="l00626"></a>00626   Ccs = <a class="code" href="namespacequcs_1_1device.html#adfa3debe05d959439c8c1a6afbf5c111">pnCapacitance</a> (<a class="code" href="structbjt.html#aefa32fafd898ff12ed4022a92d461ca2">Ucs</a>, Cjs0, Vjs, Mjs);
<a name="l00627"></a>00627   <a class="code" href="structbjt.html#a319e5024d260552ac4a8325dab96fd87">Qcs</a> = <a class="code" href="namespacequcs_1_1device.html#ab73ac3b10fcea755c5701ca570c3888a">pnCharge</a> (<a class="code" href="structbjt.html#aefa32fafd898ff12ed4022a92d461ca2">Ucs</a>, Cjs0, Vjs, Mjs);
<a name="l00628"></a>00628 
<a name="l00629"></a>00629   <span class="comment">// finally save the operating points</span>
<a name="l00630"></a>00630   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Cbe&quot;</span>, Cbe);
<a name="l00631"></a>00631   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Cbci&quot;</span>, Cbci);
<a name="l00632"></a>00632   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Cbcx&quot;</span>, Cbcx);
<a name="l00633"></a>00633   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Ccs&quot;</span>, Ccs);
<a name="l00634"></a>00634   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;gmf&quot;</span>, <a class="code" href="structbjt.html#a2daa7ead3fa1a97a46d3cfc8b813ee8b">gitf</a>);
<a name="l00635"></a>00635   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;gmr&quot;</span>, <a class="code" href="structbjt.html#aebd211ce3e346442129e6b0875ba2796">gitr</a>);
<a name="l00636"></a>00636   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;gmu&quot;</span>, <a class="code" href="structbjt.html#a5ce84f52c25d9f23c175a4e5959259b2">gbci</a> + <a class="code" href="structbjt.html#a348ae1374d9fe85ff429850377d2cef9">gbcn</a>);
<a name="l00637"></a>00637   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;gpi&quot;</span>, <a class="code" href="structbjt.html#ae9d0c44c7dcae0382700c33dde03bb1f">gbei</a> + <a class="code" href="structbjt.html#a276633891d6b51e5970fd9507fab9077">gben</a>);
<a name="l00638"></a>00638   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Rbb&quot;</span>, <a class="code" href="structbjt.html#a134cef3d7f328d1621789b12da0950da">Rbb</a>);
<a name="l00639"></a>00639   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Ibe&quot;</span>, <a class="code" href="structbjt.html#a9f819e33876d6de59e62ca75ac108692">Ibe</a>);
<a name="l00640"></a>00640   <a class="code" href="classqucs_1_1circuit.html#a5eb707e702721e6ec671294d8bdd416c">setOperatingPoint</a> (<span class="stringliteral">&quot;Ice&quot;</span>, <a class="code" href="structbjt.html#a6f86833cbb905b5842aaa30bdb2a2299">It</a>);
<a name="l00641"></a>00641 }
<a name="l00642"></a>00642 
<a name="l00643"></a><a class="code" href="structbjt.html#a8cbc30af2798d98497935ed4e46fc668">00643</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a8cbc30af2798d98497935ed4e46fc668" title="placehoder for S-Parameter initialisation function">bjt::initSP</a> (<span class="keywordtype">void</span>) {
<a name="l00644"></a>00644   <a class="code" href="classqucs_1_1circuit.html#aab7b63f2afb2711ea06dc914b95b0f6a">allocMatrixS</a> ();
<a name="l00645"></a>00645   <a class="code" href="structbjt.html#a42a00dc7303873fbdf7d15b492e10e97">processCbcx</a> ();
<a name="l00646"></a>00646   <span class="keywordflow">if</span> (<a class="code" href="namespacequcs_1_1device.html#a2946029a0c7c8849da482ed119164e42">deviceEnabled</a> (<a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>)) {
<a name="l00647"></a>00647     <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;initSP ();
<a name="l00648"></a>00648     <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;initNoiseSP ();
<a name="l00649"></a>00649   }
<a name="l00650"></a>00650 }
<a name="l00651"></a>00651 
<a name="l00652"></a><a class="code" href="structbjt.html#a42a00dc7303873fbdf7d15b492e10e97">00652</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a42a00dc7303873fbdf7d15b492e10e97">bjt::processCbcx</a> (<span class="keywordtype">void</span>) {
<a name="l00653"></a>00653   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Xcjc = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Xcjc&quot;</span>);
<a name="l00654"></a>00654   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Rbm  = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Rbm&quot;</span>);
<a name="l00655"></a>00655   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cjc0 = <a class="code" href="classqucs_1_1object.html#a467add31fa0263a85a12d0c42255c427">getScaledProperty</a> (<span class="stringliteral">&quot;Cjc&quot;</span>);
<a name="l00656"></a>00656 
<a name="l00657"></a>00657   <span class="comment">/* if necessary then insert external capacitance between internal</span>
<a name="l00658"></a>00658 <span class="comment">     collector node and external base node */</span>
<a name="l00659"></a>00659   <span class="keywordflow">if</span> (Rbm != 0.0 &amp;&amp; Cjc0 != 0.0 &amp;&amp; Xcjc != 1.0) {
<a name="l00660"></a>00660     <span class="keywordflow">if</span> (!<a class="code" href="namespacequcs_1_1device.html#a2946029a0c7c8849da482ed119164e42">deviceEnabled</a> (<a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>)) {
<a name="l00661"></a>00661       <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a> = <a class="code" href="namespacequcs_1_1device.html#ac8d2d7a2e8b43d7e419e4e4be6eaf1df">splitCapacitor</a> (<span class="keyword">this</span>, <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>, <span class="stringliteral">&quot;Cbcx&quot;</span>, <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>-&gt;getNode (<a class="code" href="circuit_8h.html#a4f0d36c5244b59c0f92e7704ac05647f">NODE_1</a>),
<a name="l00662"></a>00662                              <a class="code" href="classqucs_1_1circuit.html#a43a149197fa55e7ad1bd8e6b89f7e9d7">getNode</a> (<a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>));
<a name="l00663"></a>00663     }
<a name="l00664"></a>00664     <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;setProperty (<span class="stringliteral">&quot;C&quot;</span>, <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Cbcx&quot;</span>));
<a name="l00665"></a>00665   }
<a name="l00666"></a>00666   <span class="keywordflow">else</span> {
<a name="l00667"></a>00667     <a class="code" href="namespacequcs_1_1device.html#aa3e179be9537242cc539c790459c365b">disableCapacitor</a> (<span class="keyword">this</span>, <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>);
<a name="l00668"></a>00668   }
<a name="l00669"></a>00669 }
<a name="l00670"></a>00670 
<a name="l00671"></a><a class="code" href="structbjt.html#ac78bd928e6b13ee310270e7caedda528">00671</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#ac78bd928e6b13ee310270e7caedda528">bjt::initAC</a> (<span class="keywordtype">void</span>) {
<a name="l00672"></a>00672   <a class="code" href="classqucs_1_1circuit.html#a263c5ec9a8a53d2f1ba1352b67579ead">allocMatrixMNA</a> ();
<a name="l00673"></a>00673   <a class="code" href="structbjt.html#a42a00dc7303873fbdf7d15b492e10e97">processCbcx</a> ();
<a name="l00674"></a>00674   <span class="keywordflow">if</span> (<a class="code" href="namespacequcs_1_1device.html#a2946029a0c7c8849da482ed119164e42">deviceEnabled</a> (<a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>)) {
<a name="l00675"></a>00675     <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;initAC ();
<a name="l00676"></a>00676     <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;initNoiseAC ();
<a name="l00677"></a>00677   }
<a name="l00678"></a>00678 }
<a name="l00679"></a>00679 
<a name="l00680"></a><a class="code" href="structbjt.html#a5fa13fefb61a9c1b131e99bc4aaebd49">00680</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a5fa13fefb61a9c1b131e99bc4aaebd49">bjt::calcAC</a> (<a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> frequency) {
<a name="l00681"></a>00681   <a class="code" href="classqucs_1_1circuit.html#a51d9bb2a3cb7019bd5c20a3e37ff21b5">setMatrixY</a> (<a class="code" href="structbjt.html#a13271751f3f7cd3f4df9a1055a0586ea">calcMatrixY</a> (frequency));
<a name="l00682"></a>00682 }
<a name="l00683"></a>00683 
<a name="l00684"></a><a class="code" href="structbjt.html#a572c646957b2e02ed8dc850445862dfc">00684</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a572c646957b2e02ed8dc850445862dfc">bjt::calcNoiseAC</a> (<a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> frequency) {
<a name="l00685"></a>00685   <a class="code" href="classqucs_1_1circuit.html#adf9d50ac28e53f1d2e75d16993354310">setMatrixN</a> (<a class="code" href="structbjt.html#aa1e7980fc227f36e74336d2dd94aa399">calcMatrixCy</a> (frequency));
<a name="l00686"></a>00686 }
<a name="l00687"></a>00687 
<a name="l00688"></a><a class="code" href="bjt_8cpp.html#abff8e79071a1f40288776b4f75de25a5">00688</a> <span class="preprocessor">#define qbeState 0 // base-emitter charge state</span>
<a name="l00689"></a><a class="code" href="bjt_8cpp.html#a3314b537c21fc5ba9451e5e0cdcb95e0">00689</a> <span class="preprocessor"></span><span class="preprocessor">#define cbeState 1 // base-emitter current state</span>
<a name="l00690"></a><a class="code" href="bjt_8cpp.html#a3796068f13b137734cf38988f366060d">00690</a> <span class="preprocessor"></span><span class="preprocessor">#define qbcState 2 // base-collector charge state</span>
<a name="l00691"></a><a class="code" href="bjt_8cpp.html#a672ff9957c4ea611c646b2a457c3d853">00691</a> <span class="preprocessor"></span><span class="preprocessor">#define cbcState 3 // base-collector current state</span>
<a name="l00692"></a><a class="code" href="bjt_8cpp.html#a479c932987689332fa6a98b9872b0760">00692</a> <span class="preprocessor"></span><span class="preprocessor">#define qcsState 4 // collector-substrate charge state</span>
<a name="l00693"></a><a class="code" href="bjt_8cpp.html#ae6ba327005db6758ea4289453edf6909">00693</a> <span class="preprocessor"></span><span class="preprocessor">#define ccsState 5 // collector-substrate current state</span>
<a name="l00694"></a>00694 <span class="preprocessor"></span>
<a name="l00695"></a><a class="code" href="bjt_8cpp.html#a38be1b8122f6ec74a6303fc20a0bfdf8">00695</a> <span class="preprocessor">#define qbxState 0 // external base-collector charge state</span>
<a name="l00696"></a><a class="code" href="bjt_8cpp.html#a8172c8464b997948b3e1cdda6511ffcd">00696</a> <span class="preprocessor"></span><span class="preprocessor">#define cbxState 1 // external base-collector current state</span>
<a name="l00697"></a>00697 <span class="preprocessor"></span>
<a name="l00698"></a><a class="code" href="structbjt.html#af53ffebf1f109b8c9366e936a3c5056d">00698</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#af53ffebf1f109b8c9366e936a3c5056d">bjt::initTR</a> (<span class="keywordtype">void</span>) {
<a name="l00699"></a>00699   <a class="code" href="classqucs_1_1states.html#a75a77c3fb7dfabcce64c1dfa2f39db44">setStates</a> (7);
<a name="l00700"></a>00700   <a class="code" href="structbjt.html#ac14a95a034d6fd35c290b6aa3cfe9d7d">initDC</a> ();
<a name="l00701"></a>00701   <a class="code" href="structbjt.html#a83a0842c3b7e8b67945042b4c99ee74f">doTR</a> = <span class="keyword">true</span>;
<a name="l00702"></a>00702 
<a name="l00703"></a>00703   <span class="comment">// handle external base-collector capacitance appropriately</span>
<a name="l00704"></a>00704   <a class="code" href="structbjt.html#a42a00dc7303873fbdf7d15b492e10e97">processCbcx</a> ();
<a name="l00705"></a>00705   <span class="keywordflow">if</span> (<a class="code" href="namespacequcs_1_1device.html#a2946029a0c7c8849da482ed119164e42">deviceEnabled</a> (<a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>)) {
<a name="l00706"></a>00706     <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;initTR ();
<a name="l00707"></a>00707     <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;setProperty (<span class="stringliteral">&quot;Controlled&quot;</span>, <a class="code" href="classqucs_1_1object.html#a3134f6d4b6abda0fb40ac2a9fb4344cc" title="Get the name of the object.">getName</a> ());
<a name="l00708"></a>00708   }
<a name="l00709"></a>00709 }
<a name="l00710"></a>00710 
<a name="l00711"></a><a class="code" href="structbjt.html#aa6b270bf9869a20e3ffe6529d64340b0">00711</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#aa6b270bf9869a20e3ffe6529d64340b0">bjt::calcTR</a> (<a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="parse__vcd_8y.html#aaccc9105df5383111407fd5b41255e23">t</a>) {
<a name="l00712"></a>00712   <a class="code" href="structbjt.html#a2afa2e8351cf89db627c448ef859a56c">calcDC</a> ();
<a name="l00713"></a>00713   <a class="code" href="structbjt.html#a060b96161665d4042f2e65d3129203bc">saveOperatingPoints</a> ();
<a name="l00714"></a>00714   <a class="code" href="structbjt.html#ae5b3226f91b46113f54769aef6958502">loadOperatingPoints</a> ();
<a name="l00715"></a>00715   <a class="code" href="structbjt.html#a1f1a94ef92ab32f5b3a4dc79dcce6d29">calcOperatingPoints</a> ();
<a name="l00716"></a>00716 
<a name="l00717"></a>00717   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cbe  = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Cbe&quot;</span>);
<a name="l00718"></a>00718   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ccs  = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Ccs&quot;</span>);
<a name="l00719"></a>00719   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cbci = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Cbci&quot;</span>);
<a name="l00720"></a>00720   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Cbcx = <a class="code" href="classqucs_1_1circuit.html#a68aebd7c218ed485e809537f191399e1">getOperatingPoint</a> (<span class="stringliteral">&quot;Cbcx&quot;</span>);
<a name="l00721"></a>00721 
<a name="l00722"></a>00722   <span class="comment">// handle Rbb and Cbcx appropriately</span>
<a name="l00723"></a>00723   <span class="keywordflow">if</span> (<a class="code" href="structbjt.html#a134cef3d7f328d1621789b12da0950da">Rbb</a> != 0.0) {
<a name="l00724"></a>00724     <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>-&gt;setScaledProperty (<span class="stringliteral">&quot;R&quot;</span>, <a class="code" href="structbjt.html#a134cef3d7f328d1621789b12da0950da">Rbb</a>);
<a name="l00725"></a>00725     <a class="code" href="structbjt.html#adad29066bffbaefa427b9b1eefc22f8f">rb</a>-&gt;calcTR (t);
<a name="l00726"></a>00726     <span class="keywordflow">if</span> (<a class="code" href="namespacequcs_1_1device.html#a2946029a0c7c8849da482ed119164e42">deviceEnabled</a> (<a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>)) {
<a name="l00727"></a>00727       <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;clearI ();
<a name="l00728"></a>00728       <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;clearY ();
<a name="l00729"></a>00729       <a class="code" href="structbjt.html#ad699120ad9d0037d8c1964844c684f47">cbcx</a>-&gt;transientCapacitance (<a class="code" href="bjt_8cpp.html#a38be1b8122f6ec74a6303fc20a0bfdf8">qbxState</a>, <a class="code" href="circuit_8h.html#a4f0d36c5244b59c0f92e7704ac05647f">NODE_1</a>, <a class="code" href="circuit_8h.html#a6685ff6eaa6d17e48acf55cc8434eaed">NODE_2</a>, Cbcx, <a class="code" href="structbjt.html#a16c2068e97720215c01d3d0ed192f494">Ubx</a>, <a class="code" href="structbjt.html#afaf11334db23096d653a6fb7f7f5d342">Qbcx</a>);
<a name="l00730"></a>00730     }
<a name="l00731"></a>00731   }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733   <span class="comment">// usual capacitances</span>
<a name="l00734"></a>00734   <a class="code" href="classqucs_1_1circuit.html#a9cd37d2df1a0bed58db514c2e8410149">transientCapacitance</a> (<a class="code" href="bjt_8cpp.html#abff8e79071a1f40288776b4f75de25a5">qbeState</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, Cbe, <a class="code" href="structbjt.html#a7e158e8c9a9fc7b4d3b73227c21fcaa3">Ube</a>, <a class="code" href="structbjt.html#ab6468b4561625732acbb5b34b4f4ae5b">Qbe</a>);
<a name="l00735"></a>00735   <a class="code" href="classqucs_1_1circuit.html#a9cd37d2df1a0bed58db514c2e8410149">transientCapacitance</a> (<a class="code" href="bjt_8cpp.html#a3796068f13b137734cf38988f366060d">qbcState</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, Cbci, <a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a>, <a class="code" href="structbjt.html#a93366cdffa2443148eed6ccc68d40a63">Qbci</a>);
<a name="l00736"></a>00736   <a class="code" href="classqucs_1_1circuit.html#a9cd37d2df1a0bed58db514c2e8410149">transientCapacitance</a> (<a class="code" href="bjt_8cpp.html#a479c932987689332fa6a98b9872b0760">qcsState</a>, <a class="code" href="bjt_8cpp.html#a84d8b4043ab07535ee727b6fae6e6043">NODE_S</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, Ccs, <a class="code" href="structbjt.html#aefa32fafd898ff12ed4022a92d461ca2">Ucs</a>, <a class="code" href="structbjt.html#a319e5024d260552ac4a8325dab96fd87">Qcs</a>);
<a name="l00737"></a>00737 
<a name="l00738"></a>00738   <span class="comment">// trans-capacitances</span>
<a name="l00739"></a>00739   <a class="code" href="classqucs_1_1circuit.html#a6ba99dcf00dae455dcab3bb166ba4b15">transientCapacitanceC</a> (<a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#a7455455764f8391a927627f8343a0878">NODE_E</a>, <a class="code" href="bjt_8cpp.html#ae6f491a4026d755c6262663f63de2fee">NODE_B</a>, <a class="code" href="bjt_8cpp.html#ac86a033403996a1c45631225c90d6d65">NODE_C</a>, <a class="code" href="structbjt.html#ad01f9d8f393d184496db59bc7be1b0ba">dQbedUbc</a>, <a class="code" href="structbjt.html#a52afb745f6029a30d686656624d67677">Ubc</a>);
<a name="l00740"></a>00740 }
<a name="l00741"></a>00741 
<a name="l00742"></a><a class="code" href="structbjt.html#a5363bdeb4e39eef86f36feda87e415f0">00742</a> <span class="keywordtype">void</span> <a class="code" href="structbjt.html#a5363bdeb4e39eef86f36feda87e415f0">bjt::excessPhase</a> (<span class="keywordtype">int</span> istate, <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a>&amp; <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>, <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a>&amp; g) {
<a name="l00743"></a>00743 
<a name="l00744"></a>00744   <span class="comment">// fetch device properties</span>
<a name="l00745"></a>00745   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Ptf = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Ptf&quot;</span>);
<a name="l00746"></a>00746   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> Tf = <a class="code" href="classqucs_1_1object.html#ab6ad948774f6d9641a877d6ec03f019d">getPropertyDouble</a> (<span class="stringliteral">&quot;Tf&quot;</span>);
<a name="l00747"></a>00747   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> td = <a class="code" href="namespacequcs.html#aad60b983c1899f497c1564a1e5d03fd7" title="rad2deg Convert radian to degree">deg2rad</a> (Ptf) * Tf;
<a name="l00748"></a>00748 
<a name="l00749"></a>00749   <span class="comment">// return if nothing todo</span>
<a name="l00750"></a>00750   <span class="keywordflow">if</span> (td == 0.0) <span class="keywordflow">return</span>;
<a name="l00751"></a>00751 
<a name="l00752"></a>00752   <span class="comment">// fill-in current history during initialization</span>
<a name="l00753"></a>00753   <span class="keywordflow">if</span> (<a class="code" href="classqucs_1_1integrator.html#a7247f644c015ec0a73938cc65ceda0f1">getMode</a> () &amp; <a class="code" href="integrator_8h.html#a2c053dea44a70ca5cbc019cb7ba7086a">MODE_INIT</a>) <a class="code" href="classqucs_1_1states.html#adafa25ef9fe913970898387c8e6fd81f">fillState</a> (istate, i);
<a name="l00754"></a>00754 
<a name="l00755"></a>00755   <span class="comment">// calculate current coefficients C1, C2 and C3</span>
<a name="l00756"></a>00756   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> * delta = <a class="code" href="classqucs_1_1circuit.html#a7dd6fdee5e6f04ff142efbaa3641a00f">getDelta</a> ();
<a name="l00757"></a>00757   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> c3, <a class="code" href="parse__netlist_8y.html#a2fc157b70ef47e6fa15e1b8e0fed870a">c2</a>, <a class="code" href="parse__netlist_8y.html#a18025c3f3373ede9398dc62da3273017">c1</a>, dn, ra;
<a name="l00758"></a>00758   c1 = delta[0] / td;
<a name="l00759"></a>00759   c2 = 3 * <a class="code" href="parse__netlist_8y.html#a18025c3f3373ede9398dc62da3273017">c1</a>;
<a name="l00760"></a>00760   c1 = c2 * <a class="code" href="parse__netlist_8y.html#a18025c3f3373ede9398dc62da3273017">c1</a>;
<a name="l00761"></a>00761   dn = 1 + c1 + <a class="code" href="parse__netlist_8y.html#a2fc157b70ef47e6fa15e1b8e0fed870a">c2</a>;
<a name="l00762"></a>00762   c1 = c1 / dn;
<a name="l00763"></a>00763   ra = delta[0] / delta[1];
<a name="l00764"></a>00764   c2 = (1 + ra + <a class="code" href="parse__netlist_8y.html#a2fc157b70ef47e6fa15e1b8e0fed870a">c2</a>) / dn;
<a name="l00765"></a>00765   c3 = ra / dn;
<a name="l00766"></a>00766 
<a name="l00767"></a>00767   <span class="comment">// update and save current, update transconductance</span>
<a name="l00768"></a>00768   i = i * c1 + <a class="code" href="classqucs_1_1states.html#a2a808e9699400ab03265ccf5f39e7a1e">getState</a> (istate, 1) * c2 - <a class="code" href="classqucs_1_1states.html#a2a808e9699400ab03265ccf5f39e7a1e">getState</a> (istate, 2) * c3;
<a name="l00769"></a>00769   <a class="code" href="classqucs_1_1states.html#adbff05bd2515cf95bb5303edc01b0615">setState</a> (istate, i);
<a name="l00770"></a>00770   g = g * <a class="code" href="parse__netlist_8y.html#a18025c3f3373ede9398dc62da3273017">c1</a>;
<a name="l00771"></a>00771 }
<a name="l00772"></a>00772 
<a name="l00773"></a>00773 <span class="comment">// properties</span>
<a name="l00774"></a><a class="code" href="bjt_8cpp.html#a81b4394386247bd0004693ae261471f2">00774</a> <a class="code" href="netdefs_8h.html#a251a1121d56cb06ee4a90e5664ebde60">PROP_REQ</a> [] = {
<a name="l00775"></a>00775   { <span class="stringliteral">&quot;Is&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1e-16, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00776"></a>00776   { <span class="stringliteral">&quot;Nf&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#aa6ae43a3d5db7a8e127e51641f27de7c">PROP_RNGII</a> (0.1, 100) },
<a name="l00777"></a>00777   { <span class="stringliteral">&quot;Nr&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#aa6ae43a3d5db7a8e127e51641f27de7c">PROP_RNGII</a> (0.1, 100) },
<a name="l00778"></a>00778   { <span class="stringliteral">&quot;Ikf&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00779"></a>00779   { <span class="stringliteral">&quot;Ikr&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00780"></a>00780   { <span class="stringliteral">&quot;Vaf&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00781"></a>00781   { <span class="stringliteral">&quot;Var&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00782"></a>00782   { <span class="stringliteral">&quot;Ise&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00783"></a>00783   { <span class="stringliteral">&quot;Ne&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1.5, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#aa6ae43a3d5db7a8e127e51641f27de7c">PROP_RNGII</a> (0.1, 100) },
<a name="l00784"></a>00784   { <span class="stringliteral">&quot;Isc&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00785"></a>00785   { <span class="stringliteral">&quot;Nc&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 2, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#aa6ae43a3d5db7a8e127e51641f27de7c">PROP_RNGII</a> (0.1, 100) },
<a name="l00786"></a>00786   { <span class="stringliteral">&quot;Bf&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 100, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4129c2429762ec32998c31828cb36a57">PROP_POS_RANGEX</a> },
<a name="l00787"></a>00787   { <span class="stringliteral">&quot;Br&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4129c2429762ec32998c31828cb36a57">PROP_POS_RANGEX</a> },
<a name="l00788"></a>00788   { <span class="stringliteral">&quot;Rbm&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00789"></a>00789   { <span class="stringliteral">&quot;Irb&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00790"></a>00790   { <span class="stringliteral">&quot;Cje&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00791"></a>00791   { <span class="stringliteral">&quot;Vje&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0.75, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#adda4ad7a6503668317bf4d2beda4dda9">PROP_RNGXI</a> (0, 10) },
<a name="l00792"></a>00792   { <span class="stringliteral">&quot;Mje&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0.33, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#aa6ae43a3d5db7a8e127e51641f27de7c">PROP_RNGII</a> (0, 1) },
<a name="l00793"></a>00793   { <span class="stringliteral">&quot;Cjc&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00794"></a>00794   { <span class="stringliteral">&quot;Vjc&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0.75, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#adda4ad7a6503668317bf4d2beda4dda9">PROP_RNGXI</a> (0, 10) },
<a name="l00795"></a>00795   { <span class="stringliteral">&quot;Mjc&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0.33, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#aa6ae43a3d5db7a8e127e51641f27de7c">PROP_RNGII</a> (0, 1) },
<a name="l00796"></a>00796   { <span class="stringliteral">&quot;Xcjc&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#aa6ae43a3d5db7a8e127e51641f27de7c">PROP_RNGII</a> (0, 1) },
<a name="l00797"></a>00797   { <span class="stringliteral">&quot;Cjs&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00798"></a>00798   { <span class="stringliteral">&quot;Vjs&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0.75, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#adda4ad7a6503668317bf4d2beda4dda9">PROP_RNGXI</a> (0, 10) },
<a name="l00799"></a>00799   { <span class="stringliteral">&quot;Mjs&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#aa6ae43a3d5db7a8e127e51641f27de7c">PROP_RNGII</a> (0, 1) },
<a name="l00800"></a>00800   { <span class="stringliteral">&quot;Fc&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0.5, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#aa6ae43a3d5db7a8e127e51641f27de7c">PROP_RNGII</a> (0, 1) },
<a name="l00801"></a>00801   { <span class="stringliteral">&quot;Vtf&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a351f21d17a7058439d3578ae9502bef5">PROP_NO_RANGE</a> },
<a name="l00802"></a>00802   { <span class="stringliteral">&quot;Tf&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00803"></a>00803   { <span class="stringliteral">&quot;Xtf&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00804"></a>00804   { <span class="stringliteral">&quot;Itf&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00805"></a>00805   { <span class="stringliteral">&quot;Tr&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00806"></a>00806   <a class="code" href="netdefs_8h.html#abe2affa5f22fc12b66df2bb2c385af8b">PROP_NO_PROP</a> };
<a name="l00807"></a><a class="code" href="bjt_8cpp.html#ab1c2dc4d8b366c942ae95e1fdbe15670">00807</a> <a class="code" href="netdefs_8h.html#a9495a713159378efb0b25aa0f3dea836">PROP_OPT</a> [] = {
<a name="l00808"></a>00808   { <span class="stringliteral">&quot;Rc&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00809"></a>00809   { <span class="stringliteral">&quot;Re&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00810"></a>00810   { <span class="stringliteral">&quot;Rb&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00811"></a>00811   { <span class="stringliteral">&quot;Kf&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00812"></a>00812   { <span class="stringliteral">&quot;Af&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00813"></a>00813   { <span class="stringliteral">&quot;Ffe&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00814"></a>00814   { <span class="stringliteral">&quot;Kb&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00815"></a>00815   { <span class="stringliteral">&quot;Ab&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00816"></a>00816   { <span class="stringliteral">&quot;Fb&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00817"></a>00817   { <span class="stringliteral">&quot;Temp&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 26.85, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a87f670224851c2a44bfa1be44eddbb13">PROP_MIN_VAL</a> (K) },
<a name="l00818"></a>00818   { <span class="stringliteral">&quot;Type&quot;</span>, <a class="code" href="netdefs_8h.html#a552766d94553aab12e7876b233745eba">PROP_STR</a>, { <a class="code" href="netdefs_8h.html#afb940e1f3110901a9a494273b104f586">PROP_NO_VAL</a>, <span class="stringliteral">&quot;npn&quot;</span> }, <a class="code" href="netdefs_8h.html#a89a06fe8d10799150b2cb273808171b1">PROP_RNG_BJT</a> },
<a name="l00819"></a>00819   { <span class="stringliteral">&quot;Ptf&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#aa6ae43a3d5db7a8e127e51641f27de7c">PROP_RNGII</a> (-180, +180) },
<a name="l00820"></a>00820   { <span class="stringliteral">&quot;Xtb&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 0, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a351f21d17a7058439d3578ae9502bef5">PROP_NO_RANGE</a> },
<a name="l00821"></a>00821   { <span class="stringliteral">&quot;Xti&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 3, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00822"></a>00822   { <span class="stringliteral">&quot;Eg&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { EgSi, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4980d9d0ee76163dc5bfffbad6fa6213">PROP_POS_RANGE</a> },
<a name="l00823"></a>00823   { <span class="stringliteral">&quot;Tnom&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 26.85, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a87f670224851c2a44bfa1be44eddbb13">PROP_MIN_VAL</a> (K) },
<a name="l00824"></a>00824   { <span class="stringliteral">&quot;Area&quot;</span>, <a class="code" href="netdefs_8h.html#affd5c5788fc34f8a0ab1b07b77604103">PROP_REAL</a>, { 1, <a class="code" href="netdefs_8h.html#a4d0941b8422de2007248d250c7c5c9ed">PROP_NO_STR</a> }, <a class="code" href="netdefs_8h.html#a4129c2429762ec32998c31828cb36a57">PROP_POS_RANGEX</a> },
<a name="l00825"></a>00825   <a class="code" href="netdefs_8h.html#abe2affa5f22fc12b66df2bb2c385af8b">PROP_NO_PROP</a> };
<a name="l00826"></a><a class="code" href="structbjt.html">00826</a> <span class="keyword">struct </span><a class="code" href="structdefine__t.html">define_t</a> <a class="code" href="structbjt.html">bjt</a>::cirdef =
<a name="l00827"></a><a class="code" href="structbjt.html#a374df6e33f3a067568b7b12224723dc5">00827</a>   { <span class="stringliteral">&quot;BJT&quot;</span>, 4, <a class="code" href="netdefs_8h.html#a702804b0460e38665dab9ae3a6c3cbf6">PROP_COMPONENT</a>, <a class="code" href="netdefs_8h.html#a1bccc85ea1eada75219823bb543d134f">PROP_NO_SUBSTRATE</a>, <a class="code" href="structbjt.html#a374df6e33f3a067568b7b12224723dc5">PROP_NONLINEAR</a>, <a class="code" href="netdefs_8h.html#acd1661cbcb5d1e27c3cf1b93f5ef8153">PROP_DEF</a> };
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Sun Jul 5 2015 11:58:32 for Qucs-core by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
