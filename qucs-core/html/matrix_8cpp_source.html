<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Qucs-core: matrix.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Qucs-core
   &#160;<span id="projectnumber">0.0.19</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">matrix.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="matrix_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * matrix.cpp - matrix class implementation</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Copyright (C) 2003-2009 Stefan Jahn &lt;stefan@lkcc.org&gt;</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * This is free software; you can redistribute it and/or modify</span>
<a name="l00007"></a>00007 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00008"></a>00008 <span class="comment"> * the Free Software Foundation; either version 2, or (at your option)</span>
<a name="l00009"></a>00009 <span class="comment"> * any later version.</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> * This software is distributed in the hope that it will be useful,</span>
<a name="l00012"></a>00012 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00013"></a>00013 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00014"></a>00014 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00017"></a>00017 <span class="comment"> * along with this package; see the file COPYING.  If not, write to</span>
<a name="l00018"></a>00018 <span class="comment"> * the Free Software Foundation, Inc., 51 Franklin Street - Fifth Floor,</span>
<a name="l00019"></a>00019 <span class="comment"> * Boston, MA 02110-1301, USA.</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * $Id$</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> */</span>
<a name="l00082"></a>00082 <span class="preprocessor">#if HAVE_CONFIG_H</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span><span class="preprocessor"># include &lt;<a class="code" href="config_8h.html">config.h</a>&gt;</span>
<a name="l00084"></a>00084 <span class="preprocessor">#endif</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a>00086 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00087"></a>00087 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00088"></a>00088 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
<a name="l00089"></a>00089 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00090"></a>00090 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 <span class="preprocessor">#include &quot;<a class="code" href="logging_8h.html">logging.h</a>&quot;</span>
<a name="l00093"></a>00093 <span class="preprocessor">#include &quot;<a class="code" href="object_8h.html">object.h</a>&quot;</span>
<a name="l00094"></a>00094 <span class="preprocessor">#include &quot;<a class="code" href="complex_8h.html">complex.h</a>&quot;</span>
<a name="l00095"></a>00095 <span class="preprocessor">#include &quot;<a class="code" href="vector_8h.html">vector.h</a>&quot;</span>
<a name="l00096"></a>00096 <span class="preprocessor">#include &quot;<a class="code" href="matrix_8h.html" title="Dense matrix class header file.">matrix.h</a>&quot;</span>
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="keyword">namespace </span><a class="code" href="structqucs.html">qucs</a> {
<a name="l00099"></a>00099 
<a name="l00104"></a><a class="code" href="classqucs_1_1matrix.html#a7fdfdcd188ef95c51b09ba8fb167dc2d">00104</a> matrix::matrix () {
<a name="l00105"></a>00105   rows = 0;
<a name="l00106"></a>00106   cols = 0;
<a name="l00107"></a>00107   <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = NULL;
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 
<a name="l00117"></a><a class="code" href="classqucs_1_1matrix.html#af4f57429bc94b596e42f2a1a3c56eb99">00117</a> matrix::matrix (<span class="keywordtype">int</span> s)  {
<a name="l00118"></a>00118   rows = cols = s;
<a name="l00119"></a>00119   <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = (s &gt; 0) ? <span class="keyword">new</span> <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a>[s * s] : NULL;
<a name="l00120"></a>00120 }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="comment">/* \brief Creates a matrix</span>
<a name="l00123"></a>00123 <span class="comment"></span>
<a name="l00124"></a>00124 <span class="comment">   Constructor creates an unnamed instance of the matrix class with a</span>
<a name="l00125"></a>00125 <span class="comment">   certain number of rows and columns.</span>
<a name="l00126"></a>00126 <span class="comment">   \param[in] r number of rows</span>
<a name="l00127"></a>00127 <span class="comment">   \param[in] c number of column</span>
<a name="l00128"></a>00128 <span class="comment">   \todo Why not r and c constant</span>
<a name="l00129"></a>00129 <span class="comment">   \todo Assert r &gt;= 0 and c &gt;= 0</span>
<a name="l00130"></a>00130 <span class="comment">*/</span>
<a name="l00131"></a><a class="code" href="classqucs_1_1matrix.html#ad68d5c92c3d4e90dde22de0cdf1f8eb0">00131</a> matrix::matrix (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)  {
<a name="l00132"></a>00132   rows = <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>;
<a name="l00133"></a>00133   cols = <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>;
<a name="l00134"></a>00134   <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = (r &gt; 0 &amp;&amp; c &gt; 0) ? <span class="keyword">new</span> <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a>[r * c] : NULL;
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="comment">/* \brief copy constructor</span>
<a name="l00138"></a>00138 <span class="comment"></span>
<a name="l00139"></a>00139 <span class="comment">   The copy constructor creates a new instance based on the given</span>
<a name="l00140"></a>00140 <span class="comment">   matrix object.</span>
<a name="l00141"></a>00141 <span class="comment">   \todo Add assert tests</span>
<a name="l00142"></a>00142 <span class="comment">*/</span>
<a name="l00143"></a><a class="code" href="classqucs_1_1matrix.html#a465fbcd47511170b274e1813ea9003f7">00143</a> matrix::matrix (<span class="keyword">const</span> <a class="code" href="classqucs_1_1matrix.html" title="Dense complex matrix class This class defines a matrix object with its methods, operators and operati...">matrix</a> &amp; m) {
<a name="l00144"></a>00144   rows = m.<a class="code" href="classqucs_1_1matrix.html#aa3d0389ac4f88de498076d624e020630">rows</a>;
<a name="l00145"></a>00145   cols = m.<a class="code" href="classqucs_1_1matrix.html#a1fe78cd58c65b8aa03e73c4ab75eb1b9">cols</a>;
<a name="l00146"></a>00146   <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = NULL;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148   <span class="comment">// copy matrix elements</span>
<a name="l00149"></a>00149   <span class="keywordflow">if</span> (rows &gt; 0 &amp;&amp; cols &gt; 0) {
<a name="l00150"></a>00150     <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = <span class="keyword">new</span> <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a>[rows * cols];
<a name="l00151"></a>00151     memcpy (<a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>, m.<a class="code" href="classqucs_1_1matrix.html#a8380e1bbc3a45616f4fbb13297a8dc53">data</a>, <a class="code" href="parse__vcd_8y.html#ac02ae308cf0674e16a910b7facc5bd1c">sizeof</a> (<a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a>) * rows * cols);
<a name="l00152"></a>00152   }
<a name="l00153"></a>00153 }
<a name="l00154"></a>00154 
<a name="l00164"></a><a class="code" href="classqucs_1_1matrix.html#a61e5f85e3a38e6f85dfc6a9e0664f714">00164</a> <span class="keyword">const</span> <a class="code" href="classqucs_1_1matrix.html" title="Dense complex matrix class This class defines a matrix object with its methods, operators and operati...">matrix</a>&amp; matrix::operator=(<span class="keyword">const</span> <a class="code" href="classqucs_1_1matrix.html" title="Dense complex matrix class This class defines a matrix object with its methods, operators and operati...">matrix</a> &amp; m) {
<a name="l00165"></a>00165   <span class="keywordflow">if</span> (&amp;m != <span class="keyword">this</span>) {
<a name="l00166"></a>00166     rows = m.<a class="code" href="classqucs_1_1matrix.html#aa3d0389ac4f88de498076d624e020630">rows</a>;
<a name="l00167"></a>00167     cols = m.<a class="code" href="classqucs_1_1matrix.html#a1fe78cd58c65b8aa03e73c4ab75eb1b9">cols</a>;
<a name="l00168"></a>00168     <span class="keywordflow">if</span> (<a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>) {
<a name="l00169"></a>00169       <span class="keyword">delete</span>[] <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>;
<a name="l00170"></a>00170       <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = NULL;
<a name="l00171"></a>00171     }
<a name="l00172"></a>00172     <span class="keywordflow">if</span> (rows &gt; 0 &amp;&amp; cols &gt; 0) {
<a name="l00173"></a>00173       <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a> = <span class="keyword">new</span> <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a>[rows * cols];
<a name="l00174"></a>00174       memcpy (<a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>, m.<a class="code" href="classqucs_1_1matrix.html#a8380e1bbc3a45616f4fbb13297a8dc53">data</a>, <a class="code" href="parse__vcd_8y.html#ac02ae308cf0674e16a910b7facc5bd1c">sizeof</a> (<a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a>) * rows * cols);
<a name="l00175"></a>00175     }
<a name="l00176"></a>00176   }
<a name="l00177"></a>00177   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00178"></a>00178 }
<a name="l00179"></a>00179 
<a name="l00184"></a><a class="code" href="classqucs_1_1matrix.html#a76f3f328bb9c2ddd617e3321478f3af8">00184</a> matrix::~matrix () {
<a name="l00185"></a>00185   <span class="keywordflow">if</span> (<a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>) <span class="keyword">delete</span>[] <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>;
<a name="l00186"></a>00186 }
<a name="l00187"></a>00187 
<a name="l00194"></a><a class="code" href="classqucs_1_1matrix.html#a96d66b8d254f718c17d791530210c524">00194</a> <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> matrix::get (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>) {
<a name="l00195"></a>00195   <span class="keywordflow">return</span> <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[r * cols + <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>];
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00205"></a><a class="code" href="classqucs_1_1matrix.html#a9c506969485fccff560c3fa432c7abec">00205</a> <span class="keywordtype">void</span> matrix::set (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z) {
<a name="l00206"></a>00206   <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[r * cols + <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>] = z;
<a name="l00207"></a>00207 }
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 <span class="preprocessor">#ifdef DEBUG</span>
<a name="l00210"></a>00210 <span class="preprocessor"></span>
<a name="l00211"></a>00211 <span class="keywordtype">void</span> matrix::print (<span class="keywordtype">void</span>) {
<a name="l00212"></a>00212   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; rows; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++) {
<a name="l00213"></a>00213     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; cols; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++) {
<a name="l00214"></a>00214       fprintf (stderr, <span class="stringliteral">&quot;%+.2e,%+.2e &quot;</span>, (<span class="keywordtype">double</span>) <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (<span class="keyword">get</span> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)),
<a name="l00215"></a>00215                (<span class="keywordtype">double</span>) <a class="code" href="namespacequcs.html#a16a24319c5ba4be87da57c1d40d6a8a1" title="Imaginary part matrix.">imag</a> (<span class="keyword">get</span> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)));
<a name="l00216"></a>00216     }
<a name="l00217"></a>00217     fprintf (stderr, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00218"></a>00218   }
<a name="l00219"></a>00219 }
<a name="l00220"></a>00220 <span class="preprocessor">#endif </span><span class="comment">/* DEBUG */</span>
<a name="l00221"></a>00221 
<a name="l00228"></a><a class="code" href="namespacequcs.html#ac89db2ea27a47ba726a9e0e2b30ffd1b">00228</a> matrix <a class="code" href="namespacequcs.html#ac89db2ea27a47ba726a9e0e2b30ffd1b" title="Matrix addition.">operator + </a>(matrix a, matrix b) {
<a name="l00229"></a>00229   assert (a.getRows () == b.getRows () &amp;&amp; a.getCols () == b.getCols ());
<a name="l00230"></a>00230 
<a name="l00231"></a>00231   matrix res (a.getRows (), a.getCols ());
<a name="l00232"></a>00232   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00233"></a>00233     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00234"></a>00234       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, a.<a class="code" href="classqucs_1_1eqn_1_1node.html#ad600e283dba83116bdb019db9f78201d">get</a> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>) + b.<a class="code" href="classqucs_1_1eqn_1_1node.html#ad600e283dba83116bdb019db9f78201d">get</a> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>));
<a name="l00235"></a>00235   <span class="keywordflow">return</span> res;
<a name="l00236"></a>00236 }
<a name="l00237"></a>00237 
<a name="l00243"></a><a class="code" href="classqucs_1_1matrix.html#a2166dd10ca38eef05e5ba80d1a75cb03">00243</a> <a class="code" href="classqucs_1_1matrix.html" title="Dense complex matrix class This class defines a matrix object with its methods, operators and operati...">matrix</a> matrix::operator += (<a class="code" href="classqucs_1_1matrix.html" title="Dense complex matrix class This class defines a matrix object with its methods, operators and operati...">matrix</a> a) {
<a name="l00244"></a>00244   assert (a.<a class="code" href="classqucs_1_1matrix.html#adac8ff5fbc5bd0c263d69841f027a863">getRows</a> () == rows &amp;&amp; a.<a class="code" href="classqucs_1_1matrix.html#a8df5d95daaec0e1e0e0d86635d122b3f">getCols</a> () == cols);
<a name="l00245"></a>00245 
<a name="l00246"></a>00246   <span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>;
<a name="l00247"></a>00247   <span class="keywordflow">for</span> (i = 0, r = 0; r &lt; a.<a class="code" href="classqucs_1_1matrix.html#adac8ff5fbc5bd0c263d69841f027a863">getRows</a> (); r++)
<a name="l00248"></a>00248     <span class="keywordflow">for</span> (c = 0; c &lt; a.<a class="code" href="classqucs_1_1matrix.html#a8df5d95daaec0e1e0e0d86635d122b3f">getCols</a> (); c++, i++)
<a name="l00249"></a>00249       <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[i] += a.<a class="code" href="classqucs_1_1matrix.html#a96d66b8d254f718c17d791530210c524" title="Returns the matrix element at the given row and column.">get</a> (r, c);
<a name="l00250"></a>00250   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00259"></a><a class="code" href="namespacequcs.html#a51d687e2b1321f55d1541e3eeb62af50">00259</a> matrix <a class="code" href="namespacequcs.html#a51d687e2b1321f55d1541e3eeb62af50" title="Matrix subtraction.">operator - </a>(matrix a, matrix b) {
<a name="l00260"></a>00260   assert (a.getRows () == b.getRows () &amp;&amp; a.getCols () == b.getCols ());
<a name="l00261"></a>00261 
<a name="l00262"></a>00262   matrix res (a.getRows (), a.getCols ());
<a name="l00263"></a>00263   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00264"></a>00264     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00265"></a>00265       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, a.<a class="code" href="classqucs_1_1eqn_1_1node.html#ad600e283dba83116bdb019db9f78201d">get</a> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>) - b.<a class="code" href="classqucs_1_1eqn_1_1node.html#ad600e283dba83116bdb019db9f78201d">get</a> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>));
<a name="l00266"></a>00266   <span class="keywordflow">return</span> res;
<a name="l00267"></a>00267 }
<a name="l00268"></a>00268 
<a name="l00270"></a><a class="code" href="classqucs_1_1matrix.html#ab1e4389f64c5dc92974945ce01656783">00270</a> <a class="code" href="classqucs_1_1matrix.html" title="Dense complex matrix class This class defines a matrix object with its methods, operators and operati...">matrix</a> <a class="code" href="namespacequcs.html#a51d687e2b1321f55d1541e3eeb62af50" title="Matrix subtraction.">matrix::operator - </a>() {
<a name="l00271"></a>00271   <a class="code" href="classqucs_1_1matrix.html" title="Dense complex matrix class This class defines a matrix object with its methods, operators and operati...">matrix</a> res (getRows (), getCols ());
<a name="l00272"></a>00272   <span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>;
<a name="l00273"></a>00273   <span class="keywordflow">for</span> (i = 0, r = 0; r &lt; getRows (); r++)
<a name="l00274"></a>00274     <span class="keywordflow">for</span> (c = 0; c &lt; getCols (); c++, i++)
<a name="l00275"></a>00275       res.<a class="code" href="classqucs_1_1matrix.html#a9c506969485fccff560c3fa432c7abec" title="Sets the matrix element at the given row and column.">set</a> (r, c, -<a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[i]);
<a name="l00276"></a>00276   <span class="keywordflow">return</span> res;
<a name="l00277"></a>00277 }
<a name="l00278"></a>00278 
<a name="l00283"></a><a class="code" href="classqucs_1_1matrix.html#a3b8f2b6da5b44fa04df9ba5fb7acbd2b">00283</a> <a class="code" href="classqucs_1_1matrix.html" title="Dense complex matrix class This class defines a matrix object with its methods, operators and operati...">matrix</a> matrix::operator -= (<a class="code" href="classqucs_1_1matrix.html" title="Dense complex matrix class This class defines a matrix object with its methods, operators and operati...">matrix</a> a) {
<a name="l00284"></a>00284   assert (a.<a class="code" href="classqucs_1_1matrix.html#adac8ff5fbc5bd0c263d69841f027a863">getRows</a> () == rows &amp;&amp; a.<a class="code" href="classqucs_1_1matrix.html#a8df5d95daaec0e1e0e0d86635d122b3f">getCols</a> () == cols);
<a name="l00285"></a>00285   <span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>;
<a name="l00286"></a>00286   <span class="keywordflow">for</span> (i = 0, r = 0; r &lt; a.<a class="code" href="classqucs_1_1matrix.html#adac8ff5fbc5bd0c263d69841f027a863">getRows</a> (); r++)
<a name="l00287"></a>00287     <span class="keywordflow">for</span> (c = 0; c &lt; a.<a class="code" href="classqucs_1_1matrix.html#a8df5d95daaec0e1e0e0d86635d122b3f">getCols</a> (); c++, i++)
<a name="l00288"></a>00288       <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[i] -= a.<a class="code" href="classqucs_1_1matrix.html#a96d66b8d254f718c17d791530210c524" title="Returns the matrix element at the given row and column.">get</a> (r, c);
<a name="l00289"></a>00289   <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00290"></a>00290 }
<a name="l00291"></a>00291 
<a name="l00298"></a><a class="code" href="namespacequcs.html#acf7bbe9c6be5b4b1bc5afd374f3421a5">00298</a> matrix <a class="code" href="namespacequcs.html#acf7bbe9c6be5b4b1bc5afd374f3421a5" title="Matrix scaling complex version.">operator * </a>(matrix a, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z) {
<a name="l00299"></a>00299   matrix res (a.getRows (), a.getCols ());
<a name="l00300"></a>00300   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00301"></a>00301     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00302"></a>00302       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, a.<a class="code" href="classqucs_1_1eqn_1_1node.html#ad600e283dba83116bdb019db9f78201d">get</a> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>) * z);
<a name="l00303"></a>00303   <span class="keywordflow">return</span> res;
<a name="l00304"></a>00304 }
<a name="l00305"></a>00305 
<a name="l00313"></a><a class="code" href="namespacequcs.html#ac59df47bad91c8285b4a7b96d0c40abc">00313</a> matrix <a class="code" href="namespacequcs.html#acf7bbe9c6be5b4b1bc5afd374f3421a5" title="Matrix scaling complex version.">operator * </a>(<a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z, matrix a) {
<a name="l00314"></a>00314   <span class="keywordflow">return</span> a * z;
<a name="l00315"></a>00315 }
<a name="l00316"></a>00316 
<a name="l00323"></a><a class="code" href="namespacequcs.html#a122efb0df54f922713cb3c2242ab0575">00323</a> matrix <a class="code" href="namespacequcs.html#acf7bbe9c6be5b4b1bc5afd374f3421a5" title="Matrix scaling complex version.">operator * </a>(matrix a, <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>) {
<a name="l00324"></a>00324   matrix res (a.getRows (), a.getCols ());
<a name="l00325"></a>00325   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00326"></a>00326     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00327"></a>00327       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, a.<a class="code" href="classqucs_1_1eqn_1_1node.html#ad600e283dba83116bdb019db9f78201d">get</a> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>) * <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>);
<a name="l00328"></a>00328   <span class="keywordflow">return</span> res;
<a name="l00329"></a>00329 }
<a name="l00330"></a>00330 
<a name="l00338"></a><a class="code" href="namespacequcs.html#a1dbb2d5d58b7061677334fd74cfb9931">00338</a> matrix <a class="code" href="namespacequcs.html#acf7bbe9c6be5b4b1bc5afd374f3421a5" title="Matrix scaling complex version.">operator * </a>(<a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>, matrix a) {
<a name="l00339"></a>00339   <span class="keywordflow">return</span> a * <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>;
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 
<a name="l00348"></a><a class="code" href="namespacequcs.html#a82ab25fbe81a657630c9c5084fd0e5e2">00348</a> matrix <a class="code" href="namespacequcs.html#a82ab25fbe81a657630c9c5084fd0e5e2" title="Matrix scaling division by complex version.">operator / </a>(matrix a, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z) {
<a name="l00349"></a>00349   matrix res (a.getRows (), a.getCols ());
<a name="l00350"></a>00350   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00351"></a>00351     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00352"></a>00352       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, a.<a class="code" href="classqucs_1_1eqn_1_1node.html#ad600e283dba83116bdb019db9f78201d">get</a> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>) / z);
<a name="l00353"></a>00353   <span class="keywordflow">return</span> res;
<a name="l00354"></a>00354 }
<a name="l00355"></a>00355 
<a name="l00362"></a><a class="code" href="namespacequcs.html#a4a2ebd0134a5ee10fe9ba9f3939ccaff">00362</a> matrix <a class="code" href="namespacequcs.html#a82ab25fbe81a657630c9c5084fd0e5e2" title="Matrix scaling division by complex version.">operator / </a>(matrix a, <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>) {
<a name="l00363"></a>00363   matrix res (a.getRows (), a.getCols ());
<a name="l00364"></a>00364   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00365"></a>00365     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00366"></a>00366       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, a.<a class="code" href="classqucs_1_1eqn_1_1node.html#ad600e283dba83116bdb019db9f78201d">get</a> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>) / <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>);
<a name="l00367"></a>00367   <span class="keywordflow">return</span> res;
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 
<a name="l00378"></a><a class="code" href="namespacequcs.html#a7e882d6fe86415d8a44f599d8da8aa2f">00378</a> matrix <a class="code" href="namespacequcs.html#acf7bbe9c6be5b4b1bc5afd374f3421a5" title="Matrix scaling complex version.">operator * </a>(matrix a, matrix b) {
<a name="l00379"></a>00379   assert (a.getCols () == b.getRows ());
<a name="l00380"></a>00380 
<a name="l00381"></a>00381   <span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>, <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a> = a.getCols ();
<a name="l00382"></a>00382   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z;
<a name="l00383"></a>00383   matrix res (a.getRows (), b.getCols ());
<a name="l00384"></a>00384   <span class="keywordflow">for</span> (r = 0; r &lt; a.getRows (); r++) {
<a name="l00385"></a>00385     <span class="keywordflow">for</span> (c = 0; c &lt; b.getCols (); c++) {
<a name="l00386"></a>00386       <span class="keywordflow">for</span> (i = 0, z = 0; i &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; i++) z += a.get (r, i) * b.get (i, c);
<a name="l00387"></a>00387       res.set (r, c, z);
<a name="l00388"></a>00388     }
<a name="l00389"></a>00389   }
<a name="l00390"></a>00390   <span class="keywordflow">return</span> res;
<a name="l00391"></a>00391 }
<a name="l00392"></a>00392 
<a name="l00399"></a><a class="code" href="namespacequcs.html#abf88005760cb19fd1f2cce535d1c0383">00399</a> matrix <a class="code" href="namespacequcs.html#ac89db2ea27a47ba726a9e0e2b30ffd1b" title="Matrix addition.">operator + </a>(matrix a, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z) {
<a name="l00400"></a>00400   matrix res (a.getRows (), a.getCols ());
<a name="l00401"></a>00401   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00402"></a>00402     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00403"></a>00403       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, a.<a class="code" href="classqucs_1_1eqn_1_1node.html#ad600e283dba83116bdb019db9f78201d">get</a> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>) + z);
<a name="l00404"></a>00404   <span class="keywordflow">return</span> res;
<a name="l00405"></a>00405 }
<a name="l00406"></a>00406 
<a name="l00414"></a><a class="code" href="namespacequcs.html#a104baa24a9dd91e4ef912bf4b61ef6a7">00414</a> matrix <a class="code" href="namespacequcs.html#ac89db2ea27a47ba726a9e0e2b30ffd1b" title="Matrix addition.">operator + </a>(<a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z, matrix a) {
<a name="l00415"></a>00415   <span class="keywordflow">return</span> a + z;
<a name="l00416"></a>00416 }
<a name="l00417"></a>00417 
<a name="l00424"></a><a class="code" href="namespacequcs.html#a53bb882d280f20af3068ef4d3a2b2dc1">00424</a> matrix <a class="code" href="namespacequcs.html#ac89db2ea27a47ba726a9e0e2b30ffd1b" title="Matrix addition.">operator + </a>(matrix a, <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>) {
<a name="l00425"></a>00425   matrix res (a.getRows (), a.getCols ());
<a name="l00426"></a>00426   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00427"></a>00427     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00428"></a>00428       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, a.<a class="code" href="classqucs_1_1eqn_1_1node.html#ad600e283dba83116bdb019db9f78201d">get</a> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>) + <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>);
<a name="l00429"></a>00429   <span class="keywordflow">return</span> res;
<a name="l00430"></a>00430 }
<a name="l00431"></a>00431 
<a name="l00439"></a><a class="code" href="namespacequcs.html#af396e1ff186dd55552b4d528de16a3d4">00439</a> matrix <a class="code" href="namespacequcs.html#ac89db2ea27a47ba726a9e0e2b30ffd1b" title="Matrix addition.">operator + </a>(<a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>, matrix a) {
<a name="l00440"></a>00440   <span class="keywordflow">return</span> a + <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>;
<a name="l00441"></a>00441 }
<a name="l00442"></a>00442 
<a name="l00450"></a><a class="code" href="namespacequcs.html#a688f073063c414b392723367733d4334">00450</a> matrix <a class="code" href="namespacequcs.html#a51d687e2b1321f55d1541e3eeb62af50" title="Matrix subtraction.">operator - </a>(matrix a, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z) {
<a name="l00451"></a>00451   <span class="keywordflow">return</span> -z + a;
<a name="l00452"></a>00452 }
<a name="l00453"></a>00453 
<a name="l00461"></a><a class="code" href="namespacequcs.html#a1d9e24eb879c7188978b1c46a2cd284a">00461</a> matrix <a class="code" href="namespacequcs.html#a51d687e2b1321f55d1541e3eeb62af50" title="Matrix subtraction.">operator - </a>(<a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z, matrix a) {
<a name="l00462"></a>00462   <span class="keywordflow">return</span> -a + z;
<a name="l00463"></a>00463 }
<a name="l00464"></a>00464 
<a name="l00472"></a><a class="code" href="namespacequcs.html#ae12747c70bbf5ff8fd9908baca0ac439">00472</a> matrix <a class="code" href="namespacequcs.html#a51d687e2b1321f55d1541e3eeb62af50" title="Matrix subtraction.">operator - </a>(matrix a, <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>) {
<a name="l00473"></a>00473   <span class="keywordflow">return</span> -d + a;
<a name="l00474"></a>00474 }
<a name="l00475"></a>00475 
<a name="l00483"></a><a class="code" href="namespacequcs.html#acd44642775850b8e18a1f082c95749a0">00483</a> matrix <a class="code" href="namespacequcs.html#a51d687e2b1321f55d1541e3eeb62af50" title="Matrix subtraction.">operator - </a>(<a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>, matrix a) {
<a name="l00484"></a>00484   <span class="keywordflow">return</span> -a + <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>;
<a name="l00485"></a>00485 }
<a name="l00486"></a>00486 
<a name="l00492"></a><a class="code" href="namespacequcs.html#aa2406fc8e3e9146337c35da97caafb06">00492</a> matrix <a class="code" href="namespacequcs.html#aa2406fc8e3e9146337c35da97caafb06" title="Matrix transposition.">transpose</a> (matrix a) {
<a name="l00493"></a>00493   matrix res (a.getCols (), a.getRows ());
<a name="l00494"></a>00494   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00495"></a>00495     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00496"></a>00496       res.set (<a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, a.get (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>));
<a name="l00497"></a>00497   <span class="keywordflow">return</span> res;
<a name="l00498"></a>00498 }
<a name="l00499"></a>00499 
<a name="l00505"></a><a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b">00505</a> matrix <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (matrix a) {
<a name="l00506"></a>00506   matrix res (a.getRows (), a.getCols ());
<a name="l00507"></a>00507   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00508"></a>00508     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00509"></a>00509       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (a.get (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)));
<a name="l00510"></a>00510   <span class="keywordflow">return</span> res;
<a name="l00511"></a>00511 }
<a name="l00512"></a>00512 
<a name="l00522"></a><a class="code" href="namespacequcs.html#a1739249597320aa5ebcef8ad13273ef1">00522</a> matrix <a class="code" href="namespacequcs.html#a1739249597320aa5ebcef8ad13273ef1" title="adjoint matrix">adjoint</a> (matrix a) {
<a name="l00523"></a>00523   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#aa2406fc8e3e9146337c35da97caafb06" title="Matrix transposition.">transpose</a> (<a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (a));
<a name="l00524"></a>00524 }
<a name="l00525"></a>00525 
<a name="l00531"></a><a class="code" href="namespacequcs.html#ae19977dcd124dcf020fd21b46cf92e2f">00531</a> matrix <a class="code" href="namespacequcs.html#ae19977dcd124dcf020fd21b46cf92e2f" title="Computes magnitude of each matrix element.">abs</a> (matrix a) {
<a name="l00532"></a>00532   matrix res (a.getRows (), a.getCols ());
<a name="l00533"></a>00533   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00534"></a>00534     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00535"></a>00535       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="namespacequcs.html#ae19977dcd124dcf020fd21b46cf92e2f" title="Computes magnitude of each matrix element.">abs</a> (a.get (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)));
<a name="l00536"></a>00536   <span class="keywordflow">return</span> res;
<a name="l00537"></a>00537 }
<a name="l00538"></a>00538 
<a name="l00542"></a><a class="code" href="namespacequcs.html#ac46edd05c30fa6250377731d3c186673">00542</a> matrix <a class="code" href="namespacequcs.html#a6aacb08fcd4c522325d9d3b2e8fcfecb" title="Magnitude in dB Compute .">dB</a> (matrix a) {
<a name="l00543"></a>00543   matrix res (a.getRows (), a.getCols ());
<a name="l00544"></a>00544   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00545"></a>00545     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00546"></a>00546       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="namespacequcs.html#a6aacb08fcd4c522325d9d3b2e8fcfecb" title="Magnitude in dB Compute .">dB</a> (a.get (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)));
<a name="l00547"></a>00547   <span class="keywordflow">return</span> res;
<a name="l00548"></a>00548 }
<a name="l00549"></a>00549 
<a name="l00555"></a><a class="code" href="namespacequcs.html#a354b365797a7cbe61d1a86d44f17ac89">00555</a> matrix <a class="code" href="namespacequcs.html#a354b365797a7cbe61d1a86d44f17ac89" title="Computes the argument of each matrix element.">arg</a> (matrix a) {
<a name="l00556"></a>00556   matrix res (a.getRows (), a.getCols ());
<a name="l00557"></a>00557   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00558"></a>00558     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00559"></a>00559       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="namespacequcs.html#a354b365797a7cbe61d1a86d44f17ac89" title="Computes the argument of each matrix element.">arg</a> (a.get (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)));
<a name="l00560"></a>00560   <span class="keywordflow">return</span> res;
<a name="l00561"></a>00561 }
<a name="l00562"></a>00562 
<a name="l00568"></a><a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6">00568</a> matrix <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (matrix a) {
<a name="l00569"></a>00569   matrix res (a.getRows (), a.getCols ());
<a name="l00570"></a>00570   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00571"></a>00571     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00572"></a>00572       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (a.get (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)));
<a name="l00573"></a>00573   <span class="keywordflow">return</span> res;
<a name="l00574"></a>00574 }
<a name="l00575"></a>00575 
<a name="l00581"></a><a class="code" href="namespacequcs.html#a16a24319c5ba4be87da57c1d40d6a8a1">00581</a> matrix <a class="code" href="namespacequcs.html#a16a24319c5ba4be87da57c1d40d6a8a1" title="Imaginary part matrix.">imag</a> (matrix a) {
<a name="l00582"></a>00582   matrix res (a.getRows (), a.getCols ());
<a name="l00583"></a>00583   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00584"></a>00584     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00585"></a>00585       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="namespacequcs.html#a16a24319c5ba4be87da57c1d40d6a8a1" title="Imaginary part matrix.">imag</a> (a.get (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)));
<a name="l00586"></a>00586   <span class="keywordflow">return</span> res;
<a name="l00587"></a>00587 }
<a name="l00588"></a>00588 
<a name="l00592"></a><a class="code" href="namespacequcs.html#ad321e554f94608cf1a6e51c4a8cabcf0">00592</a> matrix <a class="code" href="namespacequcs.html#ae58b59f7f7e9fadd77ef9c7d30c2975f" title="Square of complex number.">sqr</a> (matrix a) {
<a name="l00593"></a>00593   <span class="keywordflow">return</span> a * a;
<a name="l00594"></a>00594 }
<a name="l00595"></a>00595 
<a name="l00603"></a><a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c">00603</a> matrix <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (<span class="keywordtype">int</span> rs, <span class="keywordtype">int</span> cs) {
<a name="l00604"></a>00604   matrix res (rs, cs);
<a name="l00605"></a>00605   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; res.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00606"></a>00606     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; res.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00607"></a>00607       <span class="keywordflow">if</span> (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> == <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>) res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, 1);
<a name="l00608"></a>00608   <span class="keywordflow">return</span> res;
<a name="l00609"></a>00609 }
<a name="l00610"></a>00610 
<a name="l00616"></a><a class="code" href="namespacequcs.html#a7bf93fc600d296b89a29e27e47beb4fc">00616</a> matrix <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (<span class="keywordtype">int</span> s) {
<a name="l00617"></a>00617   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (s, s);
<a name="l00618"></a>00618 }
<a name="l00619"></a>00619 
<a name="l00624"></a><a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c">00624</a> matrix <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> (qucs::vector diag) {
<a name="l00625"></a>00625   <span class="keywordtype">int</span> <a class="code" href="parse__vcd_8y.html#aa3d6656320f1a7278c0c2c7fdf07617c">size</a> = diag.getSize ();
<a name="l00626"></a>00626   matrix res (size);
<a name="l00627"></a>00627   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; <a class="code" href="parse__vcd_8y.html#aa3d6656320f1a7278c0c2c7fdf07617c">size</a>; <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>++) res (<a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>, <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) = diag (<a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>);
<a name="l00628"></a>00628   <span class="keywordflow">return</span> res;
<a name="l00629"></a>00629 }
<a name="l00630"></a>00630 
<a name="l00631"></a>00631 <span class="comment">// Compute n-th power of the given matrix.</span>
<a name="l00632"></a><a class="code" href="namespacequcs.html#a24cdb0883861f638d4dea28ecfe5b665">00632</a> matrix <a class="code" href="namespacequcs.html#a5c65d8443158735d370ba859da6fa43d" title="Compute power function with real exponent.">pow</a> (matrix a, <span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>) {
<a name="l00633"></a>00633   matrix res;
<a name="l00634"></a>00634   <span class="keywordflow">if</span> (n == 0) {
<a name="l00635"></a>00635     res = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (a.getRows (), a.getCols ());
<a name="l00636"></a>00636   }
<a name="l00637"></a>00637   <span class="keywordflow">else</span> {
<a name="l00638"></a>00638     res = a = n &lt; 0 ? <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (a) : a;
<a name="l00639"></a>00639     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 1; <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; <a class="code" href="namespacequcs.html#ae19977dcd124dcf020fd21b46cf92e2f" title="Computes magnitude of each matrix element.">std::abs</a> (n); <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>++)
<a name="l00640"></a>00640       res = res * a;
<a name="l00641"></a>00641   }
<a name="l00642"></a>00642   <span class="keywordflow">return</span> res;
<a name="l00643"></a>00643 }
<a name="l00644"></a>00644 
<a name="l00657"></a><a class="code" href="namespacequcs.html#a63027b83a39713aadb3537ed9c1710d7">00657</a> <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="namespacequcs.html#a63027b83a39713aadb3537ed9c1710d7" title="Computes the complex cofactor of the given determinant.">cofactor</a> (matrix a, <span class="keywordtype">int</span> u, <span class="keywordtype">int</span> <a class="code" href="parse__zvr_8y.html#ac4055e3a20b6b3af3d10590ea446ef6c">v</a>) {
<a name="l00658"></a>00658   matrix res (a.getRows () - 1, a.getCols () - 1);
<a name="l00659"></a>00659   <span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, ra, ca;
<a name="l00660"></a>00660   <span class="keywordflow">for</span> (ra = r = 0; r &lt; res.getRows (); r++, ra++) {
<a name="l00661"></a>00661     <span class="keywordflow">if</span> (ra == u) ra++;
<a name="l00662"></a>00662     <span class="keywordflow">for</span> (ca = c = 0; c &lt; res.getCols (); c++, ca++) {
<a name="l00663"></a>00663       <span class="keywordflow">if</span> (ca == v) ca++;
<a name="l00664"></a>00664       res.set (r, c, a.get (ra, ca));
<a name="l00665"></a>00665     }
<a name="l00666"></a>00666   }
<a name="l00667"></a>00667   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z = <a class="code" href="namespacequcs.html#a2c7e36490dbcbc023816199cb694b1dc" title="Compute determinant of the given matrix using Laplace expansion.">detLaplace</a> (res);
<a name="l00668"></a>00668   <span class="keywordflow">return</span> ((u + v) &amp; 1) ? -z : z;
<a name="l00669"></a>00669 }
<a name="l00670"></a>00670 
<a name="l00686"></a><a class="code" href="namespacequcs.html#a2c7e36490dbcbc023816199cb694b1dc">00686</a> <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="namespacequcs.html#a2c7e36490dbcbc023816199cb694b1dc" title="Compute determinant of the given matrix using Laplace expansion.">detLaplace</a> (matrix a) {
<a name="l00687"></a>00687   assert (a.getRows () == a.getCols ());
<a name="l00688"></a>00688   <span class="keywordtype">int</span> s = a.getRows ();
<a name="l00689"></a>00689   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> res = 0;
<a name="l00690"></a>00690   <span class="keywordflow">if</span> (s &gt; 1) {
<a name="l00691"></a>00691     <span class="comment">/* always use the first row for sub-determinant, but you should</span>
<a name="l00692"></a>00692 <span class="comment">       use the row or column with most zeros in it */</span>
<a name="l00693"></a>00693     <span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0;
<a name="l00694"></a>00694     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> = 0; <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a> &lt; s; <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>++) {
<a name="l00695"></a>00695       res += a.get (r, <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>) * <a class="code" href="namespacequcs.html#a63027b83a39713aadb3537ed9c1710d7" title="Computes the complex cofactor of the given determinant.">cofactor</a> (a, r, <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>);
<a name="l00696"></a>00696     }
<a name="l00697"></a>00697     <span class="keywordflow">return</span> res;
<a name="l00698"></a>00698   }
<a name="l00699"></a>00699   <span class="comment">/* 1 by 1 matrix */</span>
<a name="l00700"></a>00700   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (s == 1) {
<a name="l00701"></a>00701     <span class="keywordflow">return</span> a (0, 0);
<a name="l00702"></a>00702   }
<a name="l00703"></a>00703   <span class="comment">/* 0 by 0 matrix */</span>
<a name="l00704"></a>00704   <span class="keywordflow">return</span> 1;
<a name="l00705"></a>00705 }
<a name="l00706"></a>00706 
<a name="l00717"></a><a class="code" href="namespacequcs.html#a40a8d82b32a27d09e480144828410f39">00717</a> <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="namespacequcs.html#a40a8d82b32a27d09e480144828410f39" title="Compute determinant Gaussian algorithm.">detGauss</a> (matrix a) {
<a name="l00718"></a>00718   assert (a.getRows () == a.getCols ());
<a name="l00719"></a>00719   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> MaxPivot;
<a name="l00720"></a>00720   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> f, res;
<a name="l00721"></a>00721   matrix b;
<a name="l00722"></a>00722   <span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, pivot, <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a> = a.getCols ();
<a name="l00723"></a>00723 
<a name="l00724"></a>00724   <span class="comment">// return special matrix cases</span>
<a name="l00725"></a>00725   <span class="keywordflow">if</span> (n == 0) <span class="keywordflow">return</span> 1;
<a name="l00726"></a>00726   <span class="keywordflow">if</span> (n == 1) <span class="keywordflow">return</span> a (0, 0);
<a name="l00727"></a>00727 
<a name="l00728"></a>00728   <span class="comment">// make copy of original matrix</span>
<a name="l00729"></a>00729   b = matrix (a);
<a name="l00730"></a>00730 
<a name="l00731"></a>00731   <span class="comment">// triangulate the matrix</span>
<a name="l00732"></a>00732   <span class="keywordflow">for</span> (res = 1, i = 0; i &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; i++) {
<a name="l00733"></a>00733     <span class="comment">// find maximum column value for pivoting</span>
<a name="l00734"></a>00734     <span class="keywordflow">for</span> (MaxPivot = 0, pivot = r = i; r &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; r++) {
<a name="l00735"></a>00735       <span class="keywordflow">if</span> (<a class="code" href="namespacequcs.html#ae19977dcd124dcf020fd21b46cf92e2f" title="Computes magnitude of each matrix element.">abs</a> (b.get (r, i)) &gt; MaxPivot) {
<a name="l00736"></a>00736         MaxPivot = <a class="code" href="namespacequcs.html#ae19977dcd124dcf020fd21b46cf92e2f" title="Computes magnitude of each matrix element.">abs</a> (b.get (r, i));
<a name="l00737"></a>00737         pivot = <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>;
<a name="l00738"></a>00738       }
<a name="l00739"></a>00739     }
<a name="l00740"></a>00740     <span class="comment">// exchange rows if necessary</span>
<a name="l00741"></a>00741     assert (MaxPivot != 0);
<a name="l00742"></a>00742     <span class="keywordflow">if</span> (i != pivot) { b.exchangeRows (i, pivot); res = -res; }
<a name="l00743"></a>00743     <span class="comment">// compute new rows and columns</span>
<a name="l00744"></a>00744     <span class="keywordflow">for</span> (r = i + 1; r &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; r++) {
<a name="l00745"></a>00745       f = b.get (r, i) / b.get (i, i);
<a name="l00746"></a>00746       <span class="keywordflow">for</span> (c = i + 1; c &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; c++) {
<a name="l00747"></a>00747         b.set (r, c, b.get (r, c) - f * b.get (i, c));
<a name="l00748"></a>00748       }
<a name="l00749"></a>00749     }
<a name="l00750"></a>00750   }
<a name="l00751"></a>00751 
<a name="l00752"></a>00752   <span class="comment">// now compute determinant by multiplying diagonal</span>
<a name="l00753"></a>00753   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; i++) res *= b.get (i, i);
<a name="l00754"></a>00754   <span class="keywordflow">return</span> res;
<a name="l00755"></a>00755 }
<a name="l00756"></a>00756 
<a name="l00762"></a><a class="code" href="namespacequcs.html#ac836531bef461a7a57242303ef9a9ab5">00762</a> <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="namespacequcs.html#ac836531bef461a7a57242303ef9a9ab5" title="Compute determinant of the given matrix.">det</a> (matrix a) {
<a name="l00763"></a>00763 <span class="preprocessor">#if 0</span>
<a name="l00764"></a>00764 <span class="preprocessor"></span>  <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a2c7e36490dbcbc023816199cb694b1dc" title="Compute determinant of the given matrix using Laplace expansion.">detLaplace</a> (a);
<a name="l00765"></a>00765 <span class="preprocessor">#else</span>
<a name="l00766"></a>00766 <span class="preprocessor"></span>  <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a40a8d82b32a27d09e480144828410f39" title="Compute determinant Gaussian algorithm.">detGauss</a> (a);
<a name="l00767"></a>00767 <span class="preprocessor">#endif</span>
<a name="l00768"></a>00768 <span class="preprocessor"></span>}
<a name="l00769"></a>00769 
<a name="l00779"></a><a class="code" href="namespacequcs.html#a036418951b2356021ac36557e875a45d">00779</a> matrix <a class="code" href="namespacequcs.html#a036418951b2356021ac36557e875a45d" title="Compute inverse matrix using Laplace expansion.">inverseLaplace</a> (matrix a) {
<a name="l00780"></a>00780   matrix res (a.getRows (), a.getCols ());
<a name="l00781"></a>00781   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = <a class="code" href="namespacequcs.html#a2c7e36490dbcbc023816199cb694b1dc" title="Compute determinant of the given matrix using Laplace expansion.">detLaplace</a> (a);
<a name="l00782"></a>00782   assert (<a class="code" href="namespacequcs.html#ae19977dcd124dcf020fd21b46cf92e2f" title="Computes magnitude of each matrix element.">abs</a> (d) != 0); <span class="comment">// singular matrix</span>
<a name="l00783"></a>00783   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l00784"></a>00784     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l00785"></a>00785       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="namespacequcs.html#a63027b83a39713aadb3537ed9c1710d7" title="Computes the complex cofactor of the given determinant.">cofactor</a> (a, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>) / d);
<a name="l00786"></a>00786   <span class="keywordflow">return</span> res;
<a name="l00787"></a>00787 }
<a name="l00788"></a>00788 
<a name="l00798"></a><a class="code" href="namespacequcs.html#a16327c92a64f8755ae1671bb0c64e29f">00798</a> matrix <a class="code" href="namespacequcs.html#a16327c92a64f8755ae1671bb0c64e29f" title="Compute inverse matrix using Gauss-Jordan elimination.">inverseGaussJordan</a> (matrix a) {
<a name="l00799"></a>00799   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> MaxPivot;
<a name="l00800"></a>00800   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> f;
<a name="l00801"></a>00801   matrix b, <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a>;
<a name="l00802"></a>00802   <span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a7e98b8a17c0aad30ba64d47b74e2a6c1">i</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, pivot, <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a> = a.getCols ();
<a name="l00803"></a>00803 
<a name="l00804"></a>00804   <span class="comment">// create temporary matrix and the result matrix</span>
<a name="l00805"></a>00805   b = matrix (a);
<a name="l00806"></a>00806   e = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (n);
<a name="l00807"></a>00807 
<a name="l00808"></a>00808   <span class="comment">// create the eye matrix in &#39;b&#39; and the result in &#39;e&#39;</span>
<a name="l00809"></a>00809   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; i++) {
<a name="l00810"></a>00810     <span class="comment">// find maximum column value for pivoting</span>
<a name="l00811"></a>00811     <span class="keywordflow">for</span> (MaxPivot = 0, pivot = r = i; r &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; r++) {
<a name="l00812"></a>00812       <span class="keywordflow">if</span> (<a class="code" href="namespacequcs.html#ae19977dcd124dcf020fd21b46cf92e2f" title="Computes magnitude of each matrix element.">abs</a> (b (r, i)) &gt; MaxPivot) {
<a name="l00813"></a>00813         MaxPivot = <a class="code" href="namespacequcs.html#ae19977dcd124dcf020fd21b46cf92e2f" title="Computes magnitude of each matrix element.">abs</a> (b (r, i));
<a name="l00814"></a>00814         pivot = <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>;
<a name="l00815"></a>00815       }
<a name="l00816"></a>00816     }
<a name="l00817"></a>00817     <span class="comment">// exchange rows if necessary</span>
<a name="l00818"></a>00818     assert (MaxPivot != 0); <span class="comment">// singular matrix</span>
<a name="l00819"></a>00819     <span class="keywordflow">if</span> (i != pivot) {
<a name="l00820"></a>00820       b.exchangeRows (i, pivot);
<a name="l00821"></a>00821       e.exchangeRows (i, pivot);
<a name="l00822"></a>00822     }
<a name="l00823"></a>00823 
<a name="l00824"></a>00824     <span class="comment">// compute current row</span>
<a name="l00825"></a>00825     <span class="keywordflow">for</span> (f = b (i, i), c = 0; c &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; c++) {
<a name="l00826"></a>00826       b (i, c) /= f;
<a name="l00827"></a>00827       <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a> (i, c) /= f;
<a name="l00828"></a>00828     }
<a name="l00829"></a>00829 
<a name="l00830"></a>00830     <span class="comment">// compute new rows and columns</span>
<a name="l00831"></a>00831     <span class="keywordflow">for</span> (r = 0; r &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; r++) {
<a name="l00832"></a>00832       <span class="keywordflow">if</span> (r != i) {
<a name="l00833"></a>00833         <span class="keywordflow">for</span> (f = b (r, i), c = 0; c &lt; <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a>; c++) {
<a name="l00834"></a>00834           b (r, c) -= f * b (i, c);
<a name="l00835"></a>00835           <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a> (r, c) -= f * <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a> (i, c);
<a name="l00836"></a>00836         }
<a name="l00837"></a>00837       }
<a name="l00838"></a>00838     }
<a name="l00839"></a>00839   }
<a name="l00840"></a>00840   <span class="keywordflow">return</span> <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a>;
<a name="l00841"></a>00841 }
<a name="l00842"></a>00842 
<a name="l00847"></a><a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004">00847</a> matrix <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (matrix a) {
<a name="l00848"></a>00848 <span class="preprocessor">#if 0</span>
<a name="l00849"></a>00849 <span class="preprocessor"></span>  <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a036418951b2356021ac36557e875a45d" title="Compute inverse matrix using Laplace expansion.">inverseLaplace</a> (a);
<a name="l00850"></a>00850 <span class="preprocessor">#else</span>
<a name="l00851"></a>00851 <span class="preprocessor"></span>  <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a16327c92a64f8755ae1671bb0c64e29f" title="Compute inverse matrix using Gauss-Jordan elimination.">inverseGaussJordan</a> (a);
<a name="l00852"></a>00852 <span class="preprocessor">#endif</span>
<a name="l00853"></a>00853 <span class="preprocessor"></span>}
<a name="l00854"></a>00854 
<a name="l00890"></a><a class="code" href="namespacequcs.html#a398c66cb517cc637f7df2bd9085dda93">00890</a> matrix <a class="code" href="namespacequcs.html#a398c66cb517cc637f7df2bd9085dda93" title="S params to S params.">stos</a> (matrix s, qucs::vector zref, qucs::vector z0) {
<a name="l00891"></a>00891   <span class="keywordtype">int</span> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = s.getRows ();
<a name="l00892"></a>00892   matrix <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a>, <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, a;
<a name="l00893"></a>00893 
<a name="l00894"></a>00894   assert (d == s.getCols () &amp;&amp; d == z0.getSize () &amp;&amp; d == zref.getSize ());
<a name="l00895"></a>00895 
<a name="l00896"></a>00896   e = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (d);
<a name="l00897"></a>00897   r = <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> ((z0 - zref) / (z0 + zref));
<a name="l00898"></a>00898   a = <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> (<a class="code" href="namespacequcs.html#adeb767aff95d4dcd7a53f06b39dc1084" title="Compute principal value of square root.">sqrt</a> (z0 / zref) / (z0 + zref));
<a name="l00899"></a>00899   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (a) * (s - <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>) * <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (e - r * s) * a;
<a name="l00900"></a>00900 }
<a name="l00901"></a>00901 
<a name="l00910"></a><a class="code" href="namespacequcs.html#a85793b281642ca2f7a0886a30b0d48af">00910</a> matrix <a class="code" href="namespacequcs.html#a398c66cb517cc637f7df2bd9085dda93" title="S params to S params.">stos</a> (matrix s, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> zref, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z0) {
<a name="l00911"></a>00911   <span class="keywordtype">int</span> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = s.getRows ();
<a name="l00912"></a>00912   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a398c66cb517cc637f7df2bd9085dda93" title="S params to S params.">stos</a> (s, qucs::vector (d, zref), qucs::vector (d, z0));
<a name="l00913"></a>00913 }
<a name="l00914"></a>00914 
<a name="l00923"></a><a class="code" href="namespacequcs.html#a7c44b4ae2f933dab5fe2cf28282668cf">00923</a> matrix <a class="code" href="namespacequcs.html#a398c66cb517cc637f7df2bd9085dda93" title="S params to S params.">stos</a> (matrix s, <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> zref, <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> z0) {
<a name="l00924"></a>00924   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a398c66cb517cc637f7df2bd9085dda93" title="S params to S params.">stos</a> (s, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> (zref, 0), <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> (z0, 0));
<a name="l00925"></a>00925 }
<a name="l00926"></a>00926 
<a name="l00935"></a><a class="code" href="namespacequcs.html#a5e8f9282161bceddc584775a171993e2">00935</a> matrix <a class="code" href="namespacequcs.html#a398c66cb517cc637f7df2bd9085dda93" title="S params to S params.">stos</a> (matrix s, qucs::vector zref, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z0) {
<a name="l00936"></a>00936   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a398c66cb517cc637f7df2bd9085dda93" title="S params to S params.">stos</a> (s, zref, qucs::vector (zref.getSize (), z0));
<a name="l00937"></a>00937 }
<a name="l00938"></a>00938 
<a name="l00947"></a><a class="code" href="namespacequcs.html#afa00e348eb400e96466a7164e0cc82c4">00947</a> matrix <a class="code" href="namespacequcs.html#a398c66cb517cc637f7df2bd9085dda93" title="S params to S params.">stos</a> (matrix s, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> zref, qucs::vector z0) {
<a name="l00948"></a>00948   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a398c66cb517cc637f7df2bd9085dda93" title="S params to S params.">stos</a> (s, qucs::vector (z0.getSize (), zref), z0);
<a name="l00949"></a>00949 }
<a name="l00950"></a>00950 
<a name="l00973"></a><a class="code" href="namespacequcs.html#acceca0d948b8be0729b28c2abc076a8b">00973</a> matrix <a class="code" href="namespacequcs.html#acceca0d948b8be0729b28c2abc076a8b" title="Scattering parameters to impedance matrix.">stoz</a> (matrix s, qucs::vector z0) {
<a name="l00974"></a>00974   <span class="keywordtype">int</span> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = s.getRows ();
<a name="l00975"></a>00975   matrix <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a>, zref, gref;
<a name="l00976"></a>00976 
<a name="l00977"></a>00977   assert (d == s.getCols () &amp;&amp; d == z0.getSize ());
<a name="l00978"></a>00978 
<a name="l00979"></a>00979   e = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (d);
<a name="l00980"></a>00980   zref = <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> (z0);
<a name="l00981"></a>00981   gref = <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> (<a class="code" href="namespacequcs.html#adeb767aff95d4dcd7a53f06b39dc1084" title="Compute principal value of square root.">sqrt</a> (<a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (1 / z0)));
<a name="l00982"></a>00982   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (gref) * <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (e - s) * (s * zref + zref) * gref;
<a name="l00983"></a>00983 }
<a name="l00984"></a>00984 
<a name="l00992"></a><a class="code" href="namespacequcs.html#a9173d804b57bfe17ca4fb248fed1098c">00992</a> matrix <a class="code" href="namespacequcs.html#acceca0d948b8be0729b28c2abc076a8b" title="Scattering parameters to impedance matrix.">stoz</a> (matrix s, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z0) {
<a name="l00993"></a>00993   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#acceca0d948b8be0729b28c2abc076a8b" title="Scattering parameters to impedance matrix.">stoz</a> (s, qucs::vector (s.getRows (), z0));
<a name="l00994"></a>00994 }
<a name="l00995"></a>00995 
<a name="l01018"></a><a class="code" href="namespacequcs.html#aa2e75c716a38f814295f4fece837d449">01018</a> matrix <a class="code" href="namespacequcs.html#aa2e75c716a38f814295f4fece837d449" title="Convert impedance matrix scattering parameters.">ztos</a> (matrix z, qucs::vector z0) {
<a name="l01019"></a>01019   <span class="keywordtype">int</span> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = z.getRows ();
<a name="l01020"></a>01020   matrix <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a>, zref, gref;
<a name="l01021"></a>01021 
<a name="l01022"></a>01022   assert (d == z.getCols () &amp;&amp; d == z0.getSize ());
<a name="l01023"></a>01023 
<a name="l01024"></a>01024   e = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (d);
<a name="l01025"></a>01025   zref = <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> (z0);
<a name="l01026"></a>01026   gref = <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> (<a class="code" href="namespacequcs.html#adeb767aff95d4dcd7a53f06b39dc1084" title="Compute principal value of square root.">sqrt</a> (<a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (1 / z0)));
<a name="l01027"></a>01027   <span class="keywordflow">return</span> gref * (z - zref) * <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (z + zref) * <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (gref);
<a name="l01028"></a>01028 }
<a name="l01029"></a>01029 
<a name="l01037"></a><a class="code" href="namespacequcs.html#a02f4cf09d475fa8673c3e4266675c4ac">01037</a> matrix <a class="code" href="namespacequcs.html#aa2e75c716a38f814295f4fece837d449" title="Convert impedance matrix scattering parameters.">ztos</a> (matrix z, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z0) {
<a name="l01038"></a>01038   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#aa2e75c716a38f814295f4fece837d449" title="Convert impedance matrix scattering parameters.">ztos</a> (z, qucs::vector (z.getRows (), z0));
<a name="l01039"></a>01039 }
<a name="l01040"></a>01040 
<a name="l01050"></a><a class="code" href="namespacequcs.html#a8c4e2e005a049f0c319b681bac0b9c4c">01050</a> matrix <a class="code" href="namespacequcs.html#a8c4e2e005a049f0c319b681bac0b9c4c" title="impedance matrix to admittance matrix.">ztoy</a> (matrix z) {
<a name="l01051"></a>01051   assert (z.getRows () == z.getCols ());
<a name="l01052"></a>01052   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (z);
<a name="l01053"></a>01053 }
<a name="l01054"></a>01054 
<a name="l01082"></a><a class="code" href="namespacequcs.html#a5b7bd0407b0ecb416ebfe63b33c1a866">01082</a> matrix <a class="code" href="namespacequcs.html#a5b7bd0407b0ecb416ebfe63b33c1a866" title="Scattering parameters to admittance matrix.">stoy</a> (matrix s, qucs::vector z0) {
<a name="l01083"></a>01083   <span class="keywordtype">int</span> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = s.getRows ();
<a name="l01084"></a>01084   matrix <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a>, zref, gref;
<a name="l01085"></a>01085 
<a name="l01086"></a>01086   assert (d == s.getCols () &amp;&amp; d == z0.getSize ());
<a name="l01087"></a>01087 
<a name="l01088"></a>01088   e = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (d);
<a name="l01089"></a>01089   zref = <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> (z0);
<a name="l01090"></a>01090   gref = <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> (<a class="code" href="namespacequcs.html#adeb767aff95d4dcd7a53f06b39dc1084" title="Compute principal value of square root.">sqrt</a> (<a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (1 / z0)));
<a name="l01091"></a>01091   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (gref) * <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (s * zref + zref) * (e - s) * gref;
<a name="l01092"></a>01092 }
<a name="l01093"></a>01093 
<a name="l01101"></a><a class="code" href="namespacequcs.html#a26d912aafb6c3320f716234624ce9ff5">01101</a> matrix <a class="code" href="namespacequcs.html#a5b7bd0407b0ecb416ebfe63b33c1a866" title="Scattering parameters to admittance matrix.">stoy</a> (matrix s, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z0) {
<a name="l01102"></a>01102   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a5b7bd0407b0ecb416ebfe63b33c1a866" title="Scattering parameters to admittance matrix.">stoy</a> (s, qucs::vector (s.getRows (), z0));
<a name="l01103"></a>01103 }
<a name="l01104"></a>01104 
<a name="l01133"></a><a class="code" href="namespacequcs.html#abb46aa8bad5c12097d1336fd30e046a5">01133</a> matrix <a class="code" href="namespacequcs.html#abb46aa8bad5c12097d1336fd30e046a5" title="Admittance matrix to scattering parameters.">ytos</a> (matrix <a class="code" href="parse__mdl_8y.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, qucs::vector z0) {
<a name="l01134"></a>01134   <span class="keywordtype">int</span> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = y.getRows ();
<a name="l01135"></a>01135   matrix <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a>, zref, gref;
<a name="l01136"></a>01136 
<a name="l01137"></a>01137   assert (d == y.getCols () &amp;&amp; d == z0.getSize ());
<a name="l01138"></a>01138 
<a name="l01139"></a>01139   e = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (d);
<a name="l01140"></a>01140   zref = <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> (z0);
<a name="l01141"></a>01141   gref = <a class="code" href="namespacequcs.html#a4410f81d19b1573895bacee1cd9af29c" title="Create a diagonal matrix from a vector.">diagonal</a> (<a class="code" href="namespacequcs.html#adeb767aff95d4dcd7a53f06b39dc1084" title="Compute principal value of square root.">sqrt</a> (<a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (1 / z0)));
<a name="l01142"></a>01142   <span class="keywordflow">return</span> gref * (e - zref * <a class="code" href="parse__mdl_8y.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>) * <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (e + zref * y) * <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (gref);
<a name="l01143"></a>01143 }
<a name="l01151"></a><a class="code" href="namespacequcs.html#af11dd01399bbbb12167becbb3e0d2293">01151</a> matrix <a class="code" href="namespacequcs.html#abb46aa8bad5c12097d1336fd30e046a5" title="Admittance matrix to scattering parameters.">ytos</a> (matrix <a class="code" href="parse__mdl_8y.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z0) {
<a name="l01152"></a>01152   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#abb46aa8bad5c12097d1336fd30e046a5" title="Admittance matrix to scattering parameters.">ytos</a> (y, qucs::vector (y.getRows (), z0));
<a name="l01153"></a>01153 }
<a name="l01181"></a><a class="code" href="namespacequcs.html#ab3589c1fa751d161262f9254f22f4cb0">01181</a> matrix <a class="code" href="namespacequcs.html#ab3589c1fa751d161262f9254f22f4cb0" title="Converts chain matrix to scattering parameters.">stoa</a> (matrix s, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z1, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z2) {
<a name="l01182"></a>01182   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = s (0, 0) * s (1, 1) - s (0, 1) * s (1, 0);
<a name="l01183"></a>01183   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a> = 2.0 * s (1, 0) * <a class="code" href="namespacequcs.html#adeb767aff95d4dcd7a53f06b39dc1084" title="Compute principal value of square root.">sqrt</a> (fabs (<a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (z1) * <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (z2)));
<a name="l01184"></a>01184   matrix a (2);
<a name="l01185"></a>01185 
<a name="l01186"></a>01186   assert (s.getRows () &gt;= 2 &amp;&amp; s.getCols () &gt;= 2);
<a name="l01187"></a>01187 
<a name="l01188"></a>01188   a.set (0, 0, (<a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z1) + z1 * s (0, 0) -
<a name="l01189"></a>01189                 <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z1) * s (1, 1) - z1 * d) / n);
<a name="l01190"></a>01190   a.set (0, 1, (<a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z1) * <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z2) + z1 * <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z2) * s (0, 0) +
<a name="l01191"></a>01191                 <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z1) * z2 * s (1, 1) + z1 * z2 * d) / n);
<a name="l01192"></a>01192   a.set (1, 0, (1.0 - s (0, 0) - s (1, 1) + d) / n);
<a name="l01193"></a>01193   a.set (1, 1, (<a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z2) - <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z2) * s (0, 0) +
<a name="l01194"></a>01194                 z2 * s (1, 1) - z2 * d) / n);
<a name="l01195"></a>01195   <span class="keywordflow">return</span> a;
<a name="l01196"></a>01196 }
<a name="l01197"></a>01197 
<a name="l01198"></a>01198 
<a name="l01222"></a><a class="code" href="namespacequcs.html#ac3d84922b768d7e7ac77257e7ea5bc4e">01222</a> matrix <a class="code" href="namespacequcs.html#ac3d84922b768d7e7ac77257e7ea5bc4e" title="Converts chain matrix to scattering parameters.">atos</a> (matrix a, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z1, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z2) {
<a name="l01223"></a>01223   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = 2.0 * <a class="code" href="namespacequcs.html#adeb767aff95d4dcd7a53f06b39dc1084" title="Compute principal value of square root.">sqrt</a> (fabs (<a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (z1) * <a class="code" href="namespacequcs.html#a0cc73c27d7d13b2200f2fddbb064dce6" title="Real part matrix.">real</a> (z2)));
<a name="l01224"></a>01224   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a> = a (0, 0) * z2 + a (0, 1) +
<a name="l01225"></a>01225     a (1, 0) * z1 * z2 + a (1, 1) * z1;
<a name="l01226"></a>01226   matrix s (2);
<a name="l01227"></a>01227 
<a name="l01228"></a>01228   assert (a.getRows () &gt;= 2 &amp;&amp; a.getCols () &gt;= 2);
<a name="l01229"></a>01229 
<a name="l01230"></a>01230   s.set (0, 0, (a (0, 0) * z2 + a (0, 1)
<a name="l01231"></a>01231                 - a (1, 0) * <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z1) * z2 - a (1, 1) * <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z1)) / n);
<a name="l01232"></a>01232   s.set (0, 1, (a (0, 0) * a (1, 1) -
<a name="l01233"></a>01233                 a (0, 1) * a (1, 0)) * d / n);
<a name="l01234"></a>01234   s.set (1, 0, d / n);
<a name="l01235"></a>01235   s.set (1, 1, (a (1, 1) * z1 - a (0, 0) * <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z2) +
<a name="l01236"></a>01236                 a (0, 1) - a (1, 0) * z1 * <a class="code" href="namespacequcs.html#a691eba7985bd59b01aa1d5d5b845027b" title="Conjugate complex matrix.">conj</a> (z2)) / n);
<a name="l01237"></a>01237   <span class="keywordflow">return</span> s;
<a name="l01238"></a>01238 }
<a name="l01239"></a>01239 
<a name="l01269"></a><a class="code" href="namespacequcs.html#a2ecbdb04f17707d2b3043f2b66012f70">01269</a> matrix <a class="code" href="namespacequcs.html#a2ecbdb04f17707d2b3043f2b66012f70" title="Converts scattering parameters to hybrid matrix.">stoh</a> (matrix s, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z1, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z2) {
<a name="l01270"></a>01270   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a> = s (0, 1) * s (1, 0);
<a name="l01271"></a>01271   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = (1.0 - s (0, 0)) * (1.0 + s (1, 1)) + n;
<a name="l01272"></a>01272   matrix <a class="code" href="parse__zvr_8y.html#aa73e7584909035a5eb4cb4fa48e14b11">h</a> (2);
<a name="l01273"></a>01273 
<a name="l01274"></a>01274   assert (s.getRows () &gt;= 2 &amp;&amp; s.getCols () &gt;= 2);
<a name="l01275"></a>01275 
<a name="l01276"></a>01276   h.set (0, 0, ((1.0 + s (0, 0)) * (1.0 + s (1, 1)) - n) * z1 / d);
<a name="l01277"></a>01277   h.set (0, 1, +2.0 * s (0, 1) / d);
<a name="l01278"></a>01278   h.set (1, 0, -2.0 * s (1, 0) / d);
<a name="l01279"></a>01279   h.set (1, 1, ((1.0 - s (0, 0)) * (1.0 - s (1, 1)) - n) / z2 / d);
<a name="l01280"></a>01280   <span class="keywordflow">return</span> <a class="code" href="parse__zvr_8y.html#aa73e7584909035a5eb4cb4fa48e14b11">h</a>;
<a name="l01281"></a>01281 }
<a name="l01282"></a>01282 
<a name="l01307"></a><a class="code" href="namespacequcs.html#a5219f66ed1b8b2d16e360aa87934576c">01307</a> matrix <a class="code" href="namespacequcs.html#a5219f66ed1b8b2d16e360aa87934576c" title="Converts hybrid matrix to scattering parameters.">htos</a> (matrix <a class="code" href="parse__zvr_8y.html#aa73e7584909035a5eb4cb4fa48e14b11">h</a>, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z1, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z2) {
<a name="l01308"></a>01308   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a> = <a class="code" href="parse__zvr_8y.html#aa73e7584909035a5eb4cb4fa48e14b11">h</a> (0, 1) * <a class="code" href="parse__zvr_8y.html#aa73e7584909035a5eb4cb4fa48e14b11">h</a> (1, 0);
<a name="l01309"></a>01309   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = (1.0 + <a class="code" href="parse__zvr_8y.html#aa73e7584909035a5eb4cb4fa48e14b11">h</a> (0, 0) / z1) * (1.0 + z2 * h (1, 1)) - n;
<a name="l01310"></a>01310   matrix s (2);
<a name="l01311"></a>01311 
<a name="l01312"></a>01312   assert (h.getRows () &gt;= 2 &amp;&amp; h.getCols () &gt;= 2);
<a name="l01313"></a>01313 
<a name="l01314"></a>01314   s.set (0, 0, ((h (0, 0) / z1 - 1.0) * (1.0 + z2 * h (1, 1)) - n) / d);
<a name="l01315"></a>01315   s.set (0, 1, +2.0 * h (0, 1) / d);
<a name="l01316"></a>01316   s.set (1, 0, -2.0 * h (1, 0) / d);
<a name="l01317"></a>01317   s.set (1, 1, ((1.0 + h (0, 0) / z1) * (1.0 - z2 * h (1, 1)) + n) / d);
<a name="l01318"></a>01318   <span class="keywordflow">return</span> s;
<a name="l01319"></a>01319 }
<a name="l01320"></a>01320 
<a name="l01321"></a>01321 <span class="comment">/*\brief Converts scattering parameters to second hybrid matrix.</span>
<a name="l01322"></a>01322 <span class="comment">  \bug{Programmed formulae are valid only for Z real}</span>
<a name="l01323"></a>01323 <span class="comment">  \bug{Not documented and references}</span>
<a name="l01324"></a>01324 <span class="comment">  \param[in] s Scattering matrix</span>
<a name="l01325"></a>01325 <span class="comment">  \param[in] z1 impedance at input 1</span>
<a name="l01326"></a>01326 <span class="comment">  \param[in] z2 impedance at input 2</span>
<a name="l01327"></a>01327 <span class="comment">  \return second hybrid matrix</span>
<a name="l01328"></a>01328 <span class="comment">  \note Assert 2 by 2 matrix</span>
<a name="l01329"></a>01329 <span class="comment">  \todo Why not s,z1,z2 const</span>
<a name="l01330"></a>01330 <span class="comment">*/</span>
<a name="l01331"></a><a class="code" href="namespacequcs.html#a60f64c4e71cf6e2056aaf82fd221c318">01331</a> matrix <a class="code" href="namespacequcs.html#a60f64c4e71cf6e2056aaf82fd221c318">stog</a> (matrix s, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z1, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z2) {
<a name="l01332"></a>01332   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a> = s (0, 1) * s (1, 0);
<a name="l01333"></a>01333   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = (1.0 + s (0, 0)) * (1.0 - s (1, 1)) + n;
<a name="l01334"></a>01334   matrix g (2);
<a name="l01335"></a>01335 
<a name="l01336"></a>01336   assert (s.getRows () &gt;= 2 &amp;&amp; s.getCols () &gt;= 2);
<a name="l01337"></a>01337 
<a name="l01338"></a>01338   g.set (0, 0, ((1.0 - s (0, 0)) * (1.0 - s (1, 1)) - n) / z1 / d);
<a name="l01339"></a>01339   g.set (0, 1, -2.0 * s (0, 1) / d);
<a name="l01340"></a>01340   g.set (1, 0, +2.0 * s (1, 0) / d);
<a name="l01341"></a>01341   g.set (1, 1, ((1.0 + s (0, 0)) * (1.0 + s (1, 1)) - n) * z2 / d);
<a name="l01342"></a>01342   <span class="keywordflow">return</span> g;
<a name="l01343"></a>01343 }
<a name="l01344"></a>01344 
<a name="l01345"></a>01345 <span class="comment">/*\brief Converts second hybrid matrix to scattering parameters.</span>
<a name="l01346"></a>01346 <span class="comment">  \bug{Programmed formulae are valid only for Z real}</span>
<a name="l01347"></a>01347 <span class="comment">  \bug{Not documented and references}</span>
<a name="l01348"></a>01348 <span class="comment">  \param[in] g second hybrid matrix</span>
<a name="l01349"></a>01349 <span class="comment">  \param[in] z1 impedance at input 1</span>
<a name="l01350"></a>01350 <span class="comment">  \param[in] z2 impedance at input 2</span>
<a name="l01351"></a>01351 <span class="comment">  \return scattering matrix</span>
<a name="l01352"></a>01352 <span class="comment">  \note Assert 2 by 2 matrix</span>
<a name="l01353"></a>01353 <span class="comment">  \todo Why not g,z1,z2 const</span>
<a name="l01354"></a>01354 <span class="comment">*/</span>
<a name="l01355"></a><a class="code" href="namespacequcs.html#a881786a02e79c919600dc7b59c4d5cea">01355</a> matrix <a class="code" href="namespacequcs.html#a881786a02e79c919600dc7b59c4d5cea">gtos</a> (matrix g, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z1, <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> z2) {
<a name="l01356"></a>01356   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__mdl_8y.html#aecba4cab5e52994730d1e21424997b33">n</a> = g (0, 1) * g (1, 0);
<a name="l01357"></a>01357   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = (1.0 + g (0, 0) * z1) * (1.0 + g (1, 1) / z2) - n;
<a name="l01358"></a>01358   matrix s (2);
<a name="l01359"></a>01359 
<a name="l01360"></a>01360   assert (g.getRows () &gt;= 2 &amp;&amp; g.getCols () &gt;= 2);
<a name="l01361"></a>01361 
<a name="l01362"></a>01362   s.set (0, 0, ((1.0 - g (0, 0) * z1) * (1.0 + g (1, 1) / z2) + n) / d);
<a name="l01363"></a>01363   s.set (0, 1, -2.0 * g (0, 1) / d);
<a name="l01364"></a>01364   s.set (1, 0, +2.0 * g (1, 0) / d);
<a name="l01365"></a>01365   s.set (1, 1, ((g (0, 0) * z1 + 1.0) * (g (1, 1) / z2 - 1.0) - n) / d);
<a name="l01366"></a>01366   <span class="keywordflow">return</span> s;
<a name="l01367"></a>01367 }
<a name="l01368"></a>01368 
<a name="l01380"></a><a class="code" href="namespacequcs.html#a3595d3e36e90f6b0db402b06c1bceeb0">01380</a> matrix <a class="code" href="namespacequcs.html#a3595d3e36e90f6b0db402b06c1bceeb0" title="Convert admittance matrix to impedance matrix.">ytoz</a> (matrix <a class="code" href="parse__mdl_8y.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>) {
<a name="l01381"></a>01381   assert (y.getRows () == y.getCols ());
<a name="l01382"></a>01382   <span class="keywordflow">return</span> <a class="code" href="namespacequcs.html#a0b2ec8c75901cb83fadf429e8ed36004" title="Compute inverse matrix.">inverse</a> (y);
<a name="l01383"></a>01383 }
<a name="l01384"></a>01384 
<a name="l01404"></a><a class="code" href="namespacequcs.html#ad37adcd761d5ad33d77fded0da99e09e">01404</a> matrix <a class="code" href="namespacequcs.html#ad37adcd761d5ad33d77fded0da99e09e" title="Admittance noise correlation matrix to S-parameter noise correlation matrix.">cytocs</a> (matrix cy, matrix s) {
<a name="l01405"></a>01405   matrix <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a> = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (s.getRows ());
<a name="l01406"></a>01406 
<a name="l01407"></a>01407   assert (cy.getRows () == cy.getCols () &amp;&amp; s.getRows () == s.getCols () &amp;&amp;
<a name="l01408"></a>01408           cy.getRows () == s.getRows ());
<a name="l01409"></a>01409 
<a name="l01410"></a>01410   <span class="keywordflow">return</span> (e + s) * cy * <a class="code" href="namespacequcs.html#a1739249597320aa5ebcef8ad13273ef1" title="adjoint matrix">adjoint</a> (e + s) / 4;
<a name="l01411"></a>01411 }
<a name="l01412"></a>01412 
<a name="l01430"></a><a class="code" href="namespacequcs.html#a418e936b9b8ea7f630a57eedf81bfa25">01430</a> matrix <a class="code" href="namespacequcs.html#a418e936b9b8ea7f630a57eedf81bfa25" title="Converts S-parameter noise correlation matrix to admittance noise correlation matrix.">cstocy</a> (matrix cs, matrix <a class="code" href="parse__mdl_8y.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>) {
<a name="l01431"></a>01431   matrix <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a> = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (y.getRows ());
<a name="l01432"></a>01432 
<a name="l01433"></a>01433   assert (cs.getRows () == cs.getCols () &amp;&amp; y.getRows () == y.getCols () &amp;&amp;
<a name="l01434"></a>01434           cs.getRows () == y.getRows ());
<a name="l01435"></a>01435 
<a name="l01436"></a>01436   <span class="keywordflow">return</span> (e + y) * cs * <a class="code" href="namespacequcs.html#a1739249597320aa5ebcef8ad13273ef1" title="adjoint matrix">adjoint</a> (e + y);
<a name="l01437"></a>01437 }
<a name="l01438"></a>01438 
<a name="l01457"></a><a class="code" href="namespacequcs.html#abb60e55b6786e3e6d30f1be61cb6d63b">01457</a> matrix <a class="code" href="namespacequcs.html#abb60e55b6786e3e6d30f1be61cb6d63b" title="Converts impedance noise correlation matrix to S-parameter noise correlation matrix.">cztocs</a> (matrix cz, matrix s) {
<a name="l01458"></a>01458   matrix <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a> = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (s.getRows ());
<a name="l01459"></a>01459 
<a name="l01460"></a>01460   assert (cz.getRows () == cz.getCols () &amp;&amp; s.getRows () == s.getCols () &amp;&amp;
<a name="l01461"></a>01461           cz.getRows () == s.getRows ());
<a name="l01462"></a>01462 
<a name="l01463"></a>01463   <span class="keywordflow">return</span> (e - s) * cz * <a class="code" href="namespacequcs.html#a1739249597320aa5ebcef8ad13273ef1" title="adjoint matrix">adjoint</a> (e - s) / 4;
<a name="l01464"></a>01464 }
<a name="l01465"></a>01465 
<a name="l01483"></a><a class="code" href="namespacequcs.html#a5faf40217ce25df20b0f592bdb48ea76">01483</a> matrix <a class="code" href="namespacequcs.html#a5faf40217ce25df20b0f592bdb48ea76" title="Converts S-parameter noise correlation matrix to impedance noise correlation matrix.">cstocz</a> (matrix cs, matrix z) {
<a name="l01484"></a>01484   assert (cs.getRows () == cs.getCols () &amp;&amp; z.getRows () == z.getCols () &amp;&amp;
<a name="l01485"></a>01485           cs.getRows () == z.getRows ());
<a name="l01486"></a>01486   matrix <a class="code" href="group__qucsMathConstants.html#gae162651ba6f0c9b150cf9bd8c41113c8" title="Euler&#39;s constant ( )">e</a> = <a class="code" href="namespacequcs.html#a1e1bd76ee9f68d155193fef7755c848c" title="Create identity matrix with specified number of rows and columns.">eye</a> (z.getRows ());
<a name="l01487"></a>01487   <span class="keywordflow">return</span> (e + z) * cs * <a class="code" href="namespacequcs.html#a1739249597320aa5ebcef8ad13273ef1" title="adjoint matrix">adjoint</a> (e + z);
<a name="l01488"></a>01488 }
<a name="l01489"></a>01489 
<a name="l01507"></a><a class="code" href="namespacequcs.html#a9717e8a8931391d50c448af84c21eb19">01507</a> matrix <a class="code" href="namespacequcs.html#a9717e8a8931391d50c448af84c21eb19" title="Converts impedance noise correlation matrix to admittance noise correlation matrix.">cztocy</a> (matrix cz, matrix <a class="code" href="parse__mdl_8y.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>) {
<a name="l01508"></a>01508   assert (cz.getRows () == cz.getCols () &amp;&amp; y.getRows () == y.getCols () &amp;&amp;
<a name="l01509"></a>01509           cz.getRows () == y.getRows ());
<a name="l01510"></a>01510 
<a name="l01511"></a>01511   <span class="keywordflow">return</span> y * cz * <a class="code" href="namespacequcs.html#a1739249597320aa5ebcef8ad13273ef1" title="adjoint matrix">adjoint</a> (y);
<a name="l01512"></a>01512 }
<a name="l01513"></a>01513 
<a name="l01531"></a><a class="code" href="namespacequcs.html#ab83708963da6f609021593ed07b48a3d">01531</a> matrix <a class="code" href="namespacequcs.html#ab83708963da6f609021593ed07b48a3d" title="Converts admittance noise correlation matrix to impedance noise correlation matrix.">cytocz</a> (matrix cy, matrix z) {
<a name="l01532"></a>01532   assert (cy.getRows () == cy.getCols () &amp;&amp; z.getRows () == z.getCols () &amp;&amp;
<a name="l01533"></a>01533           cy.getRows () == z.getRows ());
<a name="l01534"></a>01534   <span class="keywordflow">return</span> z * cy * <a class="code" href="namespacequcs.html#a1739249597320aa5ebcef8ad13273ef1" title="adjoint matrix">adjoint</a> (z);
<a name="l01535"></a>01535 }
<a name="l01536"></a>01536 
<a name="l01543"></a><a class="code" href="classqucs_1_1matrix.html#a5c8980eb997f4a198c5af230081296e3">01543</a> <span class="keywordtype">void</span> matrix::exchangeRows (<span class="keywordtype">int</span> r1, <span class="keywordtype">int</span> r2) {
<a name="l01544"></a>01544   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> * s = <span class="keyword">new</span> <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a>[cols];
<a name="l01545"></a>01545   <span class="keywordtype">int</span> len = <span class="keyword">sizeof</span> (<a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a>) * cols;
<a name="l01546"></a>01546 
<a name="l01547"></a>01547   assert (r1 &gt;= 0 &amp;&amp; r2 &gt;= 0 &amp;&amp; r1 &lt; rows &amp;&amp; r2 &lt; rows);
<a name="l01548"></a>01548 
<a name="l01549"></a>01549   memcpy (s, &amp;<a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[r1 * cols], len);
<a name="l01550"></a>01550   memcpy (&amp;<a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[r1 * cols], &amp;<a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[r2 * cols], len);
<a name="l01551"></a>01551   memcpy (&amp;<a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[r2 * cols], s, len);
<a name="l01552"></a>01552   <span class="keyword">delete</span>[] s;
<a name="l01553"></a>01553 }
<a name="l01554"></a>01554 
<a name="l01561"></a><a class="code" href="classqucs_1_1matrix.html#a7eb8764fdbffd18f1e38fd2dc078d14f">01561</a> <span class="keywordtype">void</span> matrix::exchangeCols (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a18025c3f3373ede9398dc62da3273017">c1</a>, <span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a2fc157b70ef47e6fa15e1b8e0fed870a">c2</a>) {
<a name="l01562"></a>01562   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> s;
<a name="l01563"></a>01563 
<a name="l01564"></a>01564   assert (c1 &gt;= 0 &amp;&amp; c2 &gt;= 0 &amp;&amp; c1 &lt; cols &amp;&amp; c2 &lt; cols);
<a name="l01565"></a>01565 
<a name="l01566"></a>01566   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; rows * cols; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> += cols) {
<a name="l01567"></a>01567     s = <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> + <a class="code" href="parse__netlist_8y.html#a18025c3f3373ede9398dc62da3273017">c1</a>];
<a name="l01568"></a>01568     <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> + <a class="code" href="parse__netlist_8y.html#a18025c3f3373ede9398dc62da3273017">c1</a>] = <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> + <a class="code" href="parse__netlist_8y.html#a2fc157b70ef47e6fa15e1b8e0fed870a">c2</a>];
<a name="l01569"></a>01569     <a class="code" href="parse__citi_8y.html#a511ae0b1c13f95e5f08f1a0dd3da3d93">data</a>[<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> + <a class="code" href="parse__netlist_8y.html#a2fc157b70ef47e6fa15e1b8e0fed870a">c2</a>] = s;
<a name="l01570"></a>01570   }
<a name="l01571"></a>01571 }
<a name="l01572"></a>01572 
<a name="l01594"></a><a class="code" href="namespacequcs.html#ad32af82fcac9b04a87db13b3d8066a13">01594</a> matrix <a class="code" href="namespacequcs.html#ad32af82fcac9b04a87db13b3d8066a13" title="Generic conversion matrix.">twoport</a> (matrix m, <span class="keywordtype">char</span> in, <span class="keywordtype">char</span> out) {
<a name="l01595"></a>01595   assert (m.getRows () &gt;= 2 &amp;&amp; m.getCols () &gt;= 2);
<a name="l01596"></a>01596   <a class="code" href="complex_8h.html#a7ad1a12245ad87a9d81d6bcc18afacae">nr_complex_t</a> <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>;
<a name="l01597"></a>01597   matrix res (2);
<a name="l01598"></a>01598 
<a name="l01599"></a>01599   <span class="keywordflow">switch</span> (in) {
<a name="l01600"></a>01600   <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>:
<a name="l01601"></a>01601     <span class="keywordflow">switch</span> (out) {
<a name="l01602"></a>01602     <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>: <span class="comment">// Y to Y</span>
<a name="l01603"></a>01603       res = m;
<a name="l01604"></a>01604       <span class="keywordflow">break</span>;
<a name="l01605"></a>01605     <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>: <span class="comment">// Y to Z</span>
<a name="l01606"></a>01606       d = m (0, 0) * m (1, 1) - m (0, 1) * m (1, 0);
<a name="l01607"></a>01607       res.set (0, 0, m (1, 1) / d);
<a name="l01608"></a>01608       res.set (0, 1, -m (0, 1) / d);
<a name="l01609"></a>01609       res.set (1, 0, -m (1, 0) / d);
<a name="l01610"></a>01610       res.set (1, 1, m (0, 0) / d);
<a name="l01611"></a>01611       <span class="keywordflow">break</span>;
<a name="l01612"></a>01612     <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: <span class="comment">// Y to H</span>
<a name="l01613"></a>01613       d = m (0, 0);
<a name="l01614"></a>01614       res.set (0, 0, 1.0 / d);
<a name="l01615"></a>01615       res.set (0, 1, -m (0, 1) / d);
<a name="l01616"></a>01616       res.set (1, 0, m (1, 0) / d);
<a name="l01617"></a>01617       res.set (1, 1, m (1, 1) - m (0, 1) * m (1, 0) / d);
<a name="l01618"></a>01618       <span class="keywordflow">break</span>;
<a name="l01619"></a>01619     <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>: <span class="comment">// Y to G</span>
<a name="l01620"></a>01620       d = m (1, 1);
<a name="l01621"></a>01621       res.set (0, 0, m (0, 0) - m (0, 1) * m (1, 0) / d);
<a name="l01622"></a>01622       res.set (0, 1, m (0, 1) / d);
<a name="l01623"></a>01623       res.set (1, 0, -m (1, 0) / d);
<a name="l01624"></a>01624       res.set (1, 1, 1.0 / d);
<a name="l01625"></a>01625       <span class="keywordflow">break</span>;
<a name="l01626"></a>01626     <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: <span class="comment">// Y to A</span>
<a name="l01627"></a>01627       d = m (1, 0);
<a name="l01628"></a>01628       res.set (0, 0, -m (1, 1) / d);
<a name="l01629"></a>01629       res.set (0, 1, -1.0 / d);
<a name="l01630"></a>01630       res.set (1, 0, m (0, 1) - m (1, 1) * m (0, 0) / d);
<a name="l01631"></a>01631       res.set (1, 1, -m (0, 0) / d);
<a name="l01632"></a>01632       <span class="keywordflow">break</span>;
<a name="l01633"></a>01633     <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: <span class="comment">// Y to S</span>
<a name="l01634"></a>01634       res = <a class="code" href="namespacequcs.html#abb46aa8bad5c12097d1336fd30e046a5" title="Admittance matrix to scattering parameters.">ytos</a> (m);
<a name="l01635"></a>01635       <span class="keywordflow">break</span>;
<a name="l01636"></a>01636     }
<a name="l01637"></a>01637     <span class="keywordflow">break</span>;
<a name="l01638"></a>01638   <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>:
<a name="l01639"></a>01639     <span class="keywordflow">switch</span> (out) {
<a name="l01640"></a>01640     <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>: <span class="comment">// Z to Y</span>
<a name="l01641"></a>01641       d = m (0, 0) * m (1, 1) - m (0, 1) * m (1, 0);
<a name="l01642"></a>01642       res.set (0, 0, m (1, 1) / d);
<a name="l01643"></a>01643       res.set (0, 1, -m (0, 1) / d);
<a name="l01644"></a>01644       res.set (1, 0, -m (1, 0) / d);
<a name="l01645"></a>01645       res.set (1, 1, m (0, 0) / d);
<a name="l01646"></a>01646       <span class="keywordflow">break</span>;
<a name="l01647"></a>01647     <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>: <span class="comment">// Z to Z</span>
<a name="l01648"></a>01648       res = m;
<a name="l01649"></a>01649       <span class="keywordflow">break</span>;
<a name="l01650"></a>01650     <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: <span class="comment">// Z to H</span>
<a name="l01651"></a>01651       d = m (1, 1);
<a name="l01652"></a>01652       res.set (0, 0, m (0, 0) - m (0, 1) * m (1, 0) / d);
<a name="l01653"></a>01653       res.set (0, 1, m (0, 1) / d);
<a name="l01654"></a>01654       res.set (1, 0, -m (1, 0) / d);
<a name="l01655"></a>01655       res.set (1, 1, 1.0 / d);
<a name="l01656"></a>01656       <span class="keywordflow">break</span>;
<a name="l01657"></a>01657     <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>: <span class="comment">// Z to G</span>
<a name="l01658"></a>01658       d = m (0, 0);
<a name="l01659"></a>01659       res.set (0, 0, 1.0 / d);
<a name="l01660"></a>01660       res.set (0, 1, -m (0, 1) / d);
<a name="l01661"></a>01661       res.set (1, 0, m (1, 0) / d);
<a name="l01662"></a>01662       res.set (1, 1, m (1, 1) - m (0, 1) * m (1, 0) / d);
<a name="l01663"></a>01663       <span class="keywordflow">break</span>;
<a name="l01664"></a>01664     <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: <span class="comment">// Z to A</span>
<a name="l01665"></a>01665       d = m (1, 0);
<a name="l01666"></a>01666       res.set (0, 0, m (0, 0) / d);
<a name="l01667"></a>01667       res.set (0, 1, m (0, 0) * m (1, 1) / d - m (0, 1));
<a name="l01668"></a>01668       res.set (1, 0, 1.0 / d);
<a name="l01669"></a>01669       res.set (1, 1, m (1, 1) / d);
<a name="l01670"></a>01670       <span class="keywordflow">break</span>;
<a name="l01671"></a>01671     <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: <span class="comment">// Z to S</span>
<a name="l01672"></a>01672       res = <a class="code" href="namespacequcs.html#aa2e75c716a38f814295f4fece837d449" title="Convert impedance matrix scattering parameters.">ztos</a> (m);
<a name="l01673"></a>01673       <span class="keywordflow">break</span>;
<a name="l01674"></a>01674     }
<a name="l01675"></a>01675     <span class="keywordflow">break</span>;
<a name="l01676"></a>01676   <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>:
<a name="l01677"></a>01677     <span class="keywordflow">switch</span> (out) {
<a name="l01678"></a>01678     <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>: <span class="comment">// H to Y</span>
<a name="l01679"></a>01679       d = m (0, 0);
<a name="l01680"></a>01680       res.set (0, 0, 1.0 / d);
<a name="l01681"></a>01681       res.set (0, 1, -m (0, 1) / d);
<a name="l01682"></a>01682       res.set (1, 0, m (1, 0) / d);
<a name="l01683"></a>01683       res.set (1, 1, m (1, 1) - m (0, 1) * m.get(2, 1) / <a class="code" href="parse__spice_8y.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>);
<a name="l01684"></a>01684       <span class="keywordflow">break</span>;
<a name="l01685"></a>01685     <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>: <span class="comment">// H to Z</span>
<a name="l01686"></a>01686       d = m (1, 1);
<a name="l01687"></a>01687       res.set (0, 0, m (0, 0) - m (0, 1) * m (1, 0) / d);
<a name="l01688"></a>01688       res.set (0, 1, m (0, 1) / d);
<a name="l01689"></a>01689       res.set (1, 0, -m (1, 0) / d);
<a name="l01690"></a>01690       res.set (1, 1, 1.0 / d);
<a name="l01691"></a>01691       <span class="keywordflow">break</span>;
<a name="l01692"></a>01692     <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: <span class="comment">// H to H</span>
<a name="l01693"></a>01693       res = m;
<a name="l01694"></a>01694       <span class="keywordflow">break</span>;
<a name="l01695"></a>01695     <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>: <span class="comment">// H to G</span>
<a name="l01696"></a>01696       d = m (0, 0) * m (1, 1) - m (0, 1) * m (1, 0);
<a name="l01697"></a>01697       res.set (0, 0, m (1, 1) / d);
<a name="l01698"></a>01698       res.set (0, 1, -m (0, 1) / d);
<a name="l01699"></a>01699       res.set (1, 0, -m (1, 0) / d);
<a name="l01700"></a>01700       res.set (1, 1, m (0, 0) / d);
<a name="l01701"></a>01701       <span class="keywordflow">break</span>;
<a name="l01702"></a>01702     <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: <span class="comment">// H to A</span>
<a name="l01703"></a>01703       d = m (1, 0);
<a name="l01704"></a>01704       res.set (0, 0, m (0, 1) - m (0, 0) * m (1, 1) / d);
<a name="l01705"></a>01705       res.set (0, 1, -m (0, 0) / d);
<a name="l01706"></a>01706       res.set (1, 0, -m (1, 1) / d);
<a name="l01707"></a>01707       res.set (1, 1, -1.0 / d);
<a name="l01708"></a>01708       <span class="keywordflow">break</span>;
<a name="l01709"></a>01709     <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: <span class="comment">// H to S</span>
<a name="l01710"></a>01710       res = <a class="code" href="namespacequcs.html#a5219f66ed1b8b2d16e360aa87934576c" title="Converts hybrid matrix to scattering parameters.">htos</a> (m);
<a name="l01711"></a>01711       <span class="keywordflow">break</span>;
<a name="l01712"></a>01712     }
<a name="l01713"></a>01713     <span class="keywordflow">break</span>;
<a name="l01714"></a>01714   <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>:
<a name="l01715"></a>01715     <span class="keywordflow">switch</span> (out) {
<a name="l01716"></a>01716     <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>: <span class="comment">// G to Y</span>
<a name="l01717"></a>01717       d = m (1, 1);
<a name="l01718"></a>01718       res.set (0, 0, m (0, 0) - m (0, 1) * m (1, 0) / d);
<a name="l01719"></a>01719       res.set (0, 1, m (0, 1) / d);
<a name="l01720"></a>01720       res.set (1, 0, -m (1, 0) / d);
<a name="l01721"></a>01721       res.set (1, 1, 1.0 / d);
<a name="l01722"></a>01722       <span class="keywordflow">break</span>;
<a name="l01723"></a>01723     <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>: <span class="comment">// G to Z</span>
<a name="l01724"></a>01724       d = m (0, 0);
<a name="l01725"></a>01725       res.set (0, 0, 1.0 / d);
<a name="l01726"></a>01726       res.set (0, 1, -m (0, 1) / d);
<a name="l01727"></a>01727       res.set (1, 0, m (1, 0) / d);
<a name="l01728"></a>01728       res.set (1, 1, m (1, 1) - m (0, 1) * m (1, 0) / d);
<a name="l01729"></a>01729       <span class="keywordflow">break</span>;
<a name="l01730"></a>01730     <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: <span class="comment">// G to H</span>
<a name="l01731"></a>01731       d = m (0, 0) * m (1, 1) - m (0, 1) * m (1, 0);
<a name="l01732"></a>01732       res.set (0, 0, m (1, 1) / d);
<a name="l01733"></a>01733       res.set (0, 1, -m (0, 1) / d);
<a name="l01734"></a>01734       res.set (1, 0, -m (1, 0) / d);
<a name="l01735"></a>01735       res.set (1, 1, m (0, 0) / d);
<a name="l01736"></a>01736       <span class="keywordflow">break</span>;
<a name="l01737"></a>01737     <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>: <span class="comment">// G to G</span>
<a name="l01738"></a>01738       res = m;
<a name="l01739"></a>01739       <span class="keywordflow">break</span>;
<a name="l01740"></a>01740     <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: <span class="comment">// G to A</span>
<a name="l01741"></a>01741       d = m (1, 0);
<a name="l01742"></a>01742       res.set (0, 0, 1.0 / d);
<a name="l01743"></a>01743       res.set (0, 1, m (1, 1) / d);
<a name="l01744"></a>01744       res.set (1, 0, m (0, 0) / d);
<a name="l01745"></a>01745       res.set (1, 1, m (0, 0) * m (1, 1) / d - m (0, 1));
<a name="l01746"></a>01746       <span class="keywordflow">break</span>;
<a name="l01747"></a>01747     <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: <span class="comment">// G to S</span>
<a name="l01748"></a>01748       res = <a class="code" href="namespacequcs.html#a881786a02e79c919600dc7b59c4d5cea">gtos</a> (m);
<a name="l01749"></a>01749       <span class="keywordflow">break</span>;
<a name="l01750"></a>01750     }
<a name="l01751"></a>01751     <span class="keywordflow">break</span>;
<a name="l01752"></a>01752   <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:
<a name="l01753"></a>01753     <span class="keywordflow">switch</span> (out) {
<a name="l01754"></a>01754     <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>: <span class="comment">// A to Y</span>
<a name="l01755"></a>01755       d = m (0, 1);
<a name="l01756"></a>01756       res.set (0, 0, m (1, 1) / d);
<a name="l01757"></a>01757       res.set (0, 1, m (1, 0) - m (0, 0) * m (1, 1) / d);
<a name="l01758"></a>01758       res.set (1, 0, -1.0 / d);
<a name="l01759"></a>01759       res.set (1, 1, m (0, 0) / d);
<a name="l01760"></a>01760       <span class="keywordflow">break</span>;
<a name="l01761"></a>01761     <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>: <span class="comment">// A to Z</span>
<a name="l01762"></a>01762       d = m (1, 0);
<a name="l01763"></a>01763       res.set (0, 0, m (0, 0) / d);
<a name="l01764"></a>01764       res.set (0, 1, m (0, 0) * m (1, 1) / d - m (0, 1));
<a name="l01765"></a>01765       res.set (1, 0, 1.0 / d);
<a name="l01766"></a>01766       res.set (1, 1, m (1, 1) / d);
<a name="l01767"></a>01767       <span class="keywordflow">break</span>;
<a name="l01768"></a>01768     <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: <span class="comment">// A to H</span>
<a name="l01769"></a>01769       d = m (1, 1);
<a name="l01770"></a>01770       res.set (0, 0, m (0, 1) / d);
<a name="l01771"></a>01771       res.set (0, 1, m (0, 0) - m (0, 1) * m (1, 0) / d);
<a name="l01772"></a>01772       res.set (1, 0, -1.0 / d);
<a name="l01773"></a>01773       res.set (1, 1, m (1, 0) / d);
<a name="l01774"></a>01774       <span class="keywordflow">break</span>;
<a name="l01775"></a>01775     <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>: <span class="comment">// A to G</span>
<a name="l01776"></a>01776       d = m (0, 0);
<a name="l01777"></a>01777       res.set (0, 0, m (1, 0) / d);
<a name="l01778"></a>01778       res.set (0, 1, m (1, 0) * m (0, 1) / d - m (1, 1));
<a name="l01779"></a>01779       res.set (1, 0, 1.0 / d);
<a name="l01780"></a>01780       res.set (1, 1, m (0, 1) / d);
<a name="l01781"></a>01781       <span class="keywordflow">break</span>;
<a name="l01782"></a>01782     <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: <span class="comment">// A to A</span>
<a name="l01783"></a>01783       res = m;
<a name="l01784"></a>01784       <span class="keywordflow">break</span>;
<a name="l01785"></a>01785     <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: <span class="comment">// A to S</span>
<a name="l01786"></a>01786       res = <a class="code" href="namespacequcs.html#ac3d84922b768d7e7ac77257e7ea5bc4e" title="Converts chain matrix to scattering parameters.">atos</a> (m);
<a name="l01787"></a>01787       <span class="keywordflow">break</span>;
<a name="l01788"></a>01788     }
<a name="l01789"></a>01789     <span class="keywordflow">break</span>;
<a name="l01790"></a>01790   <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:
<a name="l01791"></a>01791     <span class="keywordflow">switch</span> (out) {
<a name="l01792"></a>01792     <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: <span class="comment">// S to S</span>
<a name="l01793"></a>01793       res = m;
<a name="l01794"></a>01794       <span class="keywordflow">break</span>;
<a name="l01795"></a>01795     <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: <span class="comment">// S to T</span>
<a name="l01796"></a>01796       d = m (1, 0);
<a name="l01797"></a>01797       res.set (0, 0, m (0, 1) - m (0, 0) * m (1, 1) / d);
<a name="l01798"></a>01798       res.set (0, 1, m (0, 0) / d);
<a name="l01799"></a>01799       res.set (1, 0, -m (1, 1) / d);
<a name="l01800"></a>01800       res.set (0, 1, 1.0 / d);
<a name="l01801"></a>01801       <span class="keywordflow">break</span>;
<a name="l01802"></a>01802     <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: <span class="comment">// S to A</span>
<a name="l01803"></a>01803       res = <a class="code" href="namespacequcs.html#ab3589c1fa751d161262f9254f22f4cb0" title="Converts chain matrix to scattering parameters.">stoa</a> (m);
<a name="l01804"></a>01804       <span class="keywordflow">break</span>;
<a name="l01805"></a>01805     <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: <span class="comment">// S to H</span>
<a name="l01806"></a>01806       res = <a class="code" href="namespacequcs.html#a2ecbdb04f17707d2b3043f2b66012f70" title="Converts scattering parameters to hybrid matrix.">stoh</a> (m);
<a name="l01807"></a>01807       <span class="keywordflow">break</span>;
<a name="l01808"></a>01808     <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>: <span class="comment">// S to G</span>
<a name="l01809"></a>01809       res = <a class="code" href="namespacequcs.html#a60f64c4e71cf6e2056aaf82fd221c318">stog</a> (m);
<a name="l01810"></a>01810       <span class="keywordflow">break</span>;
<a name="l01811"></a>01811     <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>: <span class="comment">// S to Y</span>
<a name="l01812"></a>01812       res = <a class="code" href="namespacequcs.html#a5b7bd0407b0ecb416ebfe63b33c1a866" title="Scattering parameters to admittance matrix.">stoy</a> (m);
<a name="l01813"></a>01813       <span class="keywordflow">break</span>;
<a name="l01814"></a>01814     <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>: <span class="comment">// S to Z</span>
<a name="l01815"></a>01815       res = <a class="code" href="namespacequcs.html#acceca0d948b8be0729b28c2abc076a8b" title="Scattering parameters to impedance matrix.">stoz</a> (m);
<a name="l01816"></a>01816       <span class="keywordflow">break</span>;
<a name="l01817"></a>01817     }
<a name="l01818"></a>01818     <span class="keywordflow">break</span>;
<a name="l01819"></a>01819   <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:
<a name="l01820"></a>01820     <span class="keywordflow">switch</span> (out) {
<a name="l01821"></a>01821     <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: <span class="comment">// T to S</span>
<a name="l01822"></a>01822       d = m (1, 1);
<a name="l01823"></a>01823       res.set (0, 0, m (0, 1) / d);
<a name="l01824"></a>01824       res.set (0, 1, m (0, 0) - m (0, 1) * m (1, 0) / d);
<a name="l01825"></a>01825       res.set (1, 0, 1.0 / d);
<a name="l01826"></a>01826       res.set (0, 1, -m (1, 0) / d);
<a name="l01827"></a>01827       <span class="keywordflow">break</span>;
<a name="l01828"></a>01828     <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: <span class="comment">// T to T</span>
<a name="l01829"></a>01829       res = m;
<a name="l01830"></a>01830       <span class="keywordflow">break</span>;
<a name="l01831"></a>01831     }
<a name="l01832"></a>01832     <span class="keywordflow">break</span>;
<a name="l01833"></a>01833   }
<a name="l01834"></a>01834   <span class="keywordflow">return</span> res;
<a name="l01835"></a>01835 }
<a name="l01836"></a>01836 
<a name="l01854"></a>01854 <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="namespacequcs.html#a95f258414f74f1eb8168ab7fa78410c6">rollet</a> (matrix m) {
<a name="l01855"></a>01855   assert (m.getRows () &gt;= 2 &amp;&amp; m.getCols () &gt;= 2);
<a name="l01856"></a>01856   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> res;
<a name="l01857"></a>01857   res = (1 - <a class="code" href="namespacequcs.html#a306364d94afda927aad792e0c1ff4e69" title="Compute euclidian norm of complex number.">norm</a> (m (0, 0)) - <a class="code" href="namespacequcs.html#a306364d94afda927aad792e0c1ff4e69" title="Compute euclidian norm of complex number.">norm</a> (m (1, 1)) + <a class="code" href="namespacequcs.html#a306364d94afda927aad792e0c1ff4e69" title="Compute euclidian norm of complex number.">norm</a> (<a class="code" href="namespacequcs.html#ac836531bef461a7a57242303ef9a9ab5" title="Compute determinant of the given matrix.">det</a> (m))) /
<a name="l01858"></a>01858     2 / <a class="code" href="namespacequcs.html#ae19977dcd124dcf020fd21b46cf92e2f" title="Computes magnitude of each matrix element.">abs</a> (m (0, 1) * m (1, 0));
<a name="l01859"></a>01859   <span class="keywordflow">return</span> res;
<a name="l01860"></a>01860 }
<a name="l01861"></a>01861 
<a name="l01862"></a>01862 <span class="comment">/* Computes stability measure B1 of the given S-parameter matrix. */</span>
<a name="l01863"></a>01863 <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> <a class="code" href="namespacequcs.html#a7b33ffd20d454d34d39924212972a622">b1</a> (matrix m) {
<a name="l01864"></a>01864   assert (m.getRows () &gt;= 2 &amp;&amp; m.getCols () &gt;= 2);
<a name="l01865"></a>01865   <a class="code" href="config_8h.html#a014aadc409afb297b8247c13f8ca89be">nr_double_t</a> res;
<a name="l01866"></a>01866   res = 1 + <a class="code" href="namespacequcs.html#a306364d94afda927aad792e0c1ff4e69" title="Compute euclidian norm of complex number.">norm</a> (m (0, 0)) - <a class="code" href="namespacequcs.html#a306364d94afda927aad792e0c1ff4e69" title="Compute euclidian norm of complex number.">norm</a> (m (1, 1)) - <a class="code" href="namespacequcs.html#a306364d94afda927aad792e0c1ff4e69" title="Compute euclidian norm of complex number.">norm</a> (<a class="code" href="namespacequcs.html#ac836531bef461a7a57242303ef9a9ab5" title="Compute determinant of the given matrix.">det</a> (m));
<a name="l01867"></a>01867   <span class="keywordflow">return</span> res;
<a name="l01868"></a>01868 }
<a name="l01869"></a>01869 
<a name="l01870"></a>01870 
<a name="l01871"></a>01871 matrix <a class="code" href="namespacequcs.html#ab7f3543c886838b0fc2a3b43eaad66de" title="rad2deg Convert radian to degree">rad2deg</a> (matrix a) {
<a name="l01872"></a>01872   matrix res (a.getRows (), a.getCols ());
<a name="l01873"></a>01873   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l01874"></a>01874     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l01875"></a>01875       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="namespacequcs.html#ab7f3543c886838b0fc2a3b43eaad66de" title="rad2deg Convert radian to degree">rad2deg</a> (a.get (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)));
<a name="l01876"></a>01876   <span class="keywordflow">return</span> res;
<a name="l01877"></a>01877 }
<a name="l01878"></a>01878 
<a name="l01879"></a>01879 matrix <a class="code" href="namespacequcs.html#aad60b983c1899f497c1564a1e5d03fd7" title="rad2deg Convert radian to degree">deg2rad</a> (matrix a) {
<a name="l01880"></a>01880   matrix res (a.getRows (), a.getCols ());
<a name="l01881"></a>01881   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> = 0; <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a> &lt; a.getRows (); <a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>++)
<a name="l01882"></a>01882     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> = 0; <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a> &lt; a.getCols (); <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>++)
<a name="l01883"></a>01883       res.set (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>, <a class="code" href="namespacequcs.html#aad60b983c1899f497c1564a1e5d03fd7" title="rad2deg Convert radian to degree">deg2rad</a> (a.get (<a class="code" href="parse__mdl_8y.html#a514f1b439f404f86f77090fa9edc96ce">r</a>, <a class="code" href="parse__netlist_8y.html#a519cf159c27abd2374c9f649b9e9946d">c</a>)));
<a name="l01884"></a>01884   <span class="keywordflow">return</span> res;
<a name="l01885"></a>01885 }
<a name="l01886"></a>01886 
<a name="l01887"></a>01887 } <span class="comment">// namespace qucs</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 20 2015 18:22:13 for Qucs-core by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
